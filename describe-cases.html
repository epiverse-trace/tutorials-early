<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en" data-bs-theme="auto"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Read and clean case data, and make linelist for outbreak analytics with R: Aggregate and visualize</title><meta name="viewport" content="width=device-width, initial-scale=1"><script src="assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="assets/styles.css"><script src="assets/scripts.js" type="text/javascript"></script><!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-XZ471458FQ"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-XZ471458FQ');
    </script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png"><link rel="manifest" href="site.webmanifest"><link rel="mask-icon" href="safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="black"></head><body>
    <header id="top" class="navbar navbar-expand-md top-nav incubator"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img alt="Epiverse-TRACE" src="assets/images/epiverse-logo.svg"><span class="badge text-bg-danger" style="background-color: #FF4955; border-radius: 5px">
          <abbr title="This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.">
            <a href="https://cdh.carpentries.org/the-lesson-life-cycle.html#early-development-pre-alpha-through-alpha" class="external-link alert-link">
              <i aria-hidden="true" class="icon" data-feather="alert-octagon" style="border-radius: 5px"></i>
              Pre-Alpha
            </a>
            <span class="visually-hidden">This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.</span>
          </abbr>
        </span>

      </div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text"><li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul></li>
      </div>

      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Learner View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li><button class="dropdown-item" type="button" onclick="window.location.href='instructor/describe-cases.html';">Instructor View</button></li>
        </ul></div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav incubator" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Epiverse-TRACE" src="assets/images/epiverse-logo.svg"></div>
    <div class="lesson-title-md">
      Read and clean case data, and make linelist for outbreak analytics with R
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item">
          <span class="lesson-title">
            Read and clean case data, and make linelist for outbreak analytics with R
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="reference.html#glossary">Glossary</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="profiles.html">Learner Profiles</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"><li><a class="dropdown-item" href="reference.html">Glossary of Terms: Epiverse-TRACE</a></li>
          </ul></li>
      </ul></div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div><!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Read and clean case data, and make linelist for outbreak analytics with R
</div>

<aside class="col-md-12 lesson-progress"><div style="width: 67%" class="percentage">
    67%
  </div>
  <div class="progress incubator">
    <div class="progress-bar incubator" role="progressbar" style="width: 67%" aria-valuenow="67" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text"><li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul></li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Learner View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="instructor/describe-cases.html">Instructor View</a>
                      </div>
                    </div>
                  </div><!--/div.accordion-item-->
                </div><!--/div.accordion-flush-->
              </div><!--div.sidenav-view-selector -->
            </div><!--/div.col -->

            <hr></div><!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Setup</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="read-cases.html">1. Read case data</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="clean-data.html">2. Clean and validate</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlushcurrent">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-headingcurrent">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapsecurrent" aria-expanded="true" aria-controls="flush-collapsecurrent">
        <span class="visually-hidden">Current Chapter</span>
        <span class="current-chapter">
        3. Aggregate and visualize
        </span>
      </button>
    </div><!--/div.accordion-header-->

    <div id="flush-collapsecurrent" class="accordion-collapse collapse show" aria-labelledby="flush-headingcurrent" data-bs-parent="#accordionFlushcurrent">
      <div class="accordion-body">
        <ul><li><a href="#introduction">Introduction</a></li>
<li><a href="#synthetic-outbreak-data">Synthetic outbreak data</a></li>
<li><a href="#aggregating">Aggregating</a></li>
<li><a href="#visualization">Visualization</a></li>
<li><a href="#curve-of-cumulative-cases">Curve of cumulative cases</a></li>
<li><a href="#peak-estimation">Peak estimation</a></li>
<li><a href="#visulaziantion-with-ggplot2">Visulaziantion with ggplot2</a></li>
        </ul></div><!--/div.accordion-body-->
    </div><!--/div.accordion-collapse-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width"><div class="accordion accordion-flush lesson-resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="lesson-resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul><li>
                        <a href="key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="reference.html#glossary">Glossary</a>
                      </li>
                      <li>
                        <a href="profiles.html">Learner Profiles</a>
                      </li>
                      <li><a href="reference.html">Glossary of Terms: Epiverse-TRACE</a></li>
                    </ul></div>
                </div>
              </div>
            </div>
            <hr class="half-width lesson-resources"><a href="aio.html">See all in one page</a>


            <hr class="d-none d-sm-block d-md-none"><div class="d-grid gap-1">

            </div>
          </div><!-- /div.accordion -->
        </div><!-- /div.sidebar-inner -->
      </nav></div><!-- /div.sidebar -->
  </div><!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-instructor.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <nav class="lesson-content mx-md-4" aria-label="Previous and Next Chapter"><!-- content for small screens --><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="clean-data.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="index.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="clean-data.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Clean and validate
        </a>
        <a class="chapter-link float-end" href="index.html" rel="next">
          Home
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
      <hr></nav><main id="main-content" class="main-content"><div class="container lesson-content">
        <h1>Aggregate and visualize</h1>
        <p>Last updated on 2024-09-24 |

        <a href="https://github.com/epiverse-trace/tutorials-early/edit/main/episodes/describe-cases.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>



        <div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>

        

<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul><li>How to aggregate case data?</li>
<li>How to visualize aggregated data?</li>
<li>What is distribution of cases in time, place, gender, age?</li>
</ul></div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul><li>Simulate synthetic outbreak data</li>
<li>Convert linelist data to incidence</li>
<li>Create epidemic curves from incidence data</li>
</ul></div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a></h2>
<hr class="half-width"><p>In an analytic pipeline, exploratory data analysis (EDA) is an
important step before formal modelling. EDA helps determine
relationships between variables and summarize their main characteristics
often by means of data visualization.</p>
<p>This episode focuses on EDA of outbreaks and epidemic data, and how
to achieved that using a couples of handy <code>R</code> packages. A key
observation in EDA of epidemic analysis is capturing the relationship
between time and the number of reported cases, spanning various
categories (confirmed, hospitalized, deaths, and recoveries), locations,
and other demographic factors such as gender, age, etc.</p>
<p>Let’s start by loading the package <a href="https://www.reconverse.org/incidence2/" class="external-link">incidence2</a> to
aggregate linelist data by groups and visualize epicurves. We’ll use
<code>{simulist}</code> to simulate outbreak data,
<code>{epiparameter}</code> to access delays for this simulation, and
<code>{tracetheme}</code> for complementary figure formatting. We’ll use
the pipe <code>%&gt;%</code> to connect some of their functions,
including others from the packages <a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a> and
<a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a>, so let’s also call to the tidyverse package:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load packages</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">incidence2</span><span class="op">)</span> <span class="co"># to aggregate and visualise</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">simulist</span><span class="op">)</span> <span class="co"># to simulate linelist data</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">epiparameter</span><span class="op">)</span> <span class="co"># to access delays</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">tracetheme</span><span class="op">)</span> <span class="co"># for figure formatting</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span> <span class="co"># for {dplyr} and {ggplot2} functions and the pipe %&gt;%</span></span></code></pre>
</div>
<div id="the-double-colon" class="callout checklist">
<div class="callout-square">
<i class="callout-icon" data-feather="check-square"></i>
</div>
<div id="the-double-colon" class="callout-inner">
<h3 class="callout-title">The double-colon</h3>
<div class="callout-content">
<p>The double-colon <code>::</code> in R let you call a specific
function from a package without loading the entire package into the
current environment.</p>
<p>For example, <code>dplyr::filter(data, condition)</code> uses
<code>filter()</code> from the <a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a> package.</p>
<p>This help us remember package functions and avoid namespace
conflicts.</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="synthetic-outbreak-data">Synthetic outbreak data<a class="anchor" aria-label="anchor" href="#synthetic-outbreak-data"></a></h2>
<hr class="half-width"><p>To illustrate the process of conducting EDA on outbreak data, we will
generate a line list for a hypothetical Ebola outbreak utilizing the
<code>{simulist}</code> package. This line list dataset offers
individual-level information about the outbreak. For our simulation, we
will assume that the dynamics of this outbreak are influenced by several
factors: the contact distribution (average number of contacts for an
infected case), distribution of contact intervals (time period between
contacts), and the delay distributions of onset to hospitalization and
onset to death. These latter distributions can be sourced from
literature and are conveniently available in the
<code>{epiparameter}</code> package, see the below code chunk.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define contact distribution</span></span>
<span><span class="va">contact_dist</span> <span class="op">&lt;-</span> <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">epidist</span><span class="op">(</span></span>
<span>  disease <span class="op">=</span> <span class="st">"Ebola"</span>,</span>
<span>  epi_dist <span class="op">=</span> <span class="st">"contact distribution"</span>,</span>
<span>  prob_distribution <span class="op">=</span> <span class="st">"pois"</span>,</span>
<span>  prob_distribution_params <span class="op">=</span> <span class="fu">c</span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define  distribution for interval between contact</span></span>
<span><span class="va">cont_interval</span> <span class="op">&lt;-</span> <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">epidist</span><span class="op">(</span></span>
<span>  disease <span class="op">=</span> <span class="st">"Ebola"</span>,</span>
<span>  epi_dist <span class="op">=</span> <span class="st">"contact interval"</span>,</span>
<span>  prob_distribution <span class="op">=</span> <span class="st">"gamma"</span>,</span>
<span>  prob_distribution_params <span class="op">=</span> <span class="fu">c</span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">1</span>, scale <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define onset to hospitalized distribution</span></span>
<span><span class="va">onset_to_hosp</span> <span class="op">&lt;-</span> <span class="va">contact_dist</span> <span class="op">&lt;-</span> <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">epidist</span><span class="op">(</span></span>
<span>  disease <span class="op">=</span> <span class="st">"Ebola"</span>,</span>
<span>  epi_dist <span class="op">=</span> <span class="st">"onset to hospitalisatio"</span>,</span>
<span>  prob_distribution <span class="op">=</span> <span class="st">"pois"</span>,</span>
<span>  prob_distribution_params <span class="op">=</span> <span class="fu">c</span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">7</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># get onset to death from {epiparameter} database</span></span>
<span><span class="va">onset_to_death</span> <span class="op">&lt;-</span> <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">epidist_db</span><span class="op">(</span></span>
<span>  disease <span class="op">=</span> <span class="st">"Ebola"</span>,</span>
<span>  epi_dist <span class="op">=</span> <span class="st">"onset to death"</span>,</span>
<span>  single_epidist <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define distribution for infectious period</span></span>
<span><span class="va">infect_period</span> <span class="op">&lt;-</span> <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">epidist</span><span class="op">(</span></span>
<span>  disease <span class="op">=</span> <span class="st">"Ebola"</span>,</span>
<span>  epi_dist <span class="op">=</span> <span class="st">"Infectious period"</span>,</span>
<span>  prob_distribution <span class="op">=</span> <span class="st">"gamma"</span>,</span>
<span>  prob_distribution_params <span class="op">=</span> <span class="fu">c</span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">1</span>, scale <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<p>Additionally, we assume that the outbreak started at the beginning of
2023, is highly contagious with a probability of infection of <span class="math inline">\(80\%\)</span>, and its minimum and maximum sizes
are 1000 and 10,000, respectively. Combining these assumptions with the
mentioned distributions, the code chunk below generates a simulated line
list:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set seed to 1 to  have the same results</span></span>
<span><span class="fu">base</span><span class="fu">::</span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate simulation data using the defined distribution.</span></span>
<span><span class="va">linelist</span> <span class="op">&lt;-</span> <span class="fu">simulist</span><span class="fu">::</span><span class="fu">sim_linelist</span><span class="op">(</span></span>
<span>  <span class="va">contact_dist</span>,</span>
<span>  <span class="va">infect_period</span>,</span>
<span>  prob_infect <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span>  <span class="va">onset_to_hosp</span>,</span>
<span>  <span class="va">onset_to_death</span>,</span>
<span>  hosp_risk <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  hosp_death_risk <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  non_hosp_death_risk <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  outbreak_start_date <span class="op">=</span> <span class="fu">as.Date</span><span class="op">(</span><span class="st">"2023-01-01"</span><span class="op">)</span>,</span>
<span>  outbreak_size <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">10000</span><span class="op">)</span>,</span>
<span>  population_age <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">90</span><span class="op">)</span>,</span>
<span>  case_type_probs <span class="op">=</span> <span class="fu">c</span><span class="op">(</span>suspected <span class="op">=</span> <span class="fl">0.2</span>, probable <span class="op">=</span> <span class="fl">0.1</span>, confirmed <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span>,</span>
<span>  config <span class="op">=</span> <span class="fu">simulist</span><span class="fu">::</span><span class="fu">create_config</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span> <span class="co"># for a simple data frame output</span></span>
<span></span>
<span><span class="co"># View first few rows of the generated data</span></span>
<span><span class="va">linelist</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 22,563 × 12
      id case_name       case_type sex     age date_onset date_admission outcome
   &lt;int&gt; &lt;chr&gt;           &lt;chr&gt;     &lt;chr&gt; &lt;int&gt; &lt;date&gt;     &lt;date&gt;         &lt;chr&gt;
 1     1 Yassir Hutchis… confirmed m         3 2023-01-01 NA             recove…
 2     6 Lubaaba el-Ham… confirmed f        13 2023-01-01 NA             recove…
 3     7 Brandon Rivera  confirmed m        74 2023-01-01 2023-01-08     recove…
 4     9 Sierra Quint    confirmed f        65 2023-01-01 2023-01-10     died
 5    10 Levi Lee        confirmed m         8 2023-01-02 NA             recove…
 6    11 Nelson Tran     suspected m        27 2023-01-01 NA             recove…
 7    12 Aries Hines     suspected m        11 2023-01-02 NA             recove…
 8    13 Orville Miller  probable  m        49 2023-01-01 NA             recove…
 9    15 M'Leesa Pico    confirmed f        84 2023-01-01 NA             recove…
10    16 Jeremy Enriquez confirmed m        55 2023-01-01 NA             recove…
# ℹ 22,553 more rows
# ℹ 4 more variables: date_outcome &lt;date&gt;, date_first_contact &lt;date&gt;,
#   date_last_contact &lt;date&gt;, ct_value &lt;dbl&gt;</code></pre>
</div>
</section><section><h2 class="section-heading" id="aggregating">Aggregating<a class="anchor" aria-label="anchor" href="#aggregating"></a></h2>
<hr class="half-width"><p>Downstream analysis involves working with aggregated data rather than
individual cases. This requires grouping linelist data in the form of
incidence data. The <a href="(https://www.reconverse.org/incidence2/articles/incidence2.html)%7B.external%20target=%22_blank%22%7D" class="external-link">incidence2</a>
package offers an essential function, called <code>incidence</code>, for
grouping case data, usually centered around dated events and/or other
factors. The code chunk provided below demonstrates the creation of an
<code>incidence2</code> object from the simulated Ebola
<code>linelist</code> data based on the date of onset.</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create incidence object by aggregating case data  based on the date of onset</span></span>
<span><span class="va">dialy_incidence_data</span> <span class="op">&lt;-</span> <span class="fu">incidence2</span><span class="fu">::</span><span class="fu">incidence</span><span class="op">(</span></span>
<span>  <span class="va">linelist</span>,</span>
<span>  date_index <span class="op">=</span> <span class="st">"date_onset"</span>,</span>
<span>  interval <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View the first incidence data for the first 5 days</span></span>
<span><span class="va">dialy_incidence_data</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># incidence:  12 x 3
# count vars: date_onset
   date_index count_variable count
   &lt;period&gt;   &lt;chr&gt;          &lt;int&gt;
 1 2023-01-01 date_onset       475
 2 2023-01-02 date_onset      4904
 3 2023-01-03 date_onset      5478
 4 2023-01-04 date_onset      5319
 5 2023-01-05 date_onset      3520
 6 2023-01-06 date_onset      1721
 7 2023-01-07 date_onset       705
 8 2023-01-08 date_onset       330
 9 2023-01-09 date_onset        86
10 2023-01-10 date_onset        16
11 2023-01-11 date_onset         6
12 2023-01-12 date_onset         3</code></pre>
</div>
<p>Furthermore, with the <a href="https://www.reconverse.org/incidence2/" class="external-link">incidence2</a> package, you can
specify the desired interval and categorize cases by one or more
factors. Below is a code snippet demonstrating weekly cases grouped by
the date of onset and gender.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Grouping data by week</span></span>
<span><span class="va">weekly_incidence_data</span> <span class="op">&lt;-</span> <span class="fu">incidence2</span><span class="fu">::</span><span class="fu">incidence</span><span class="op">(</span></span>
<span>  <span class="va">linelist</span>,</span>
<span>  date_index <span class="op">=</span> <span class="st">"date_onset"</span>,</span>
<span>  interval <span class="op">=</span> <span class="fl">7</span>,</span>
<span>  groups <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"sex"</span>, <span class="st">"case_type"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View incidence data for the first 5 weeks</span></span>
<span><span class="va">weekly_incidence_data</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># incidence:  13 x 5
# count vars: date_onset
# groups:     sex, case_type
   date_index               sex   case_type count_variable count
   &lt;period&gt;                 &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt;          &lt;int&gt;
 1 2022-12-29 to 2023-01-04 f     confirmed date_onset      5558
 2 2022-12-29 to 2023-01-04 f     probable  date_onset       771
 3 2022-12-29 to 2023-01-04 f     suspected date_onset      1625
 4 2022-12-29 to 2023-01-04 m     confirmed date_onset      5764
 5 2022-12-29 to 2023-01-04 m     probable  date_onset       800
 6 2022-12-29 to 2023-01-04 m     suspected date_onset      1658
 7 2023-01-05 to 2023-01-11 f     confirmed date_onset      2242
 8 2023-01-05 to 2023-01-11 f     probable  date_onset       329
 9 2023-01-05 to 2023-01-11 f     suspected date_onset       624
10 2023-01-05 to 2023-01-11 m     confirmed date_onset      2235
11 2023-01-05 to 2023-01-11 m     probable  date_onset       339
12 2023-01-05 to 2023-01-11 m     suspected date_onset       615
13 2023-01-12 to 2023-01-18 f     confirmed date_onset         3</code></pre>
</div>
<div id="notes" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="notes" class="callout-inner">
<h3 class="callout-title">Notes</h3>
<div class="callout-content">
<p>When cases are grouped by different factors, it’s possible that these
groups may have different date ranges in the resulting
<code>incidence2</code> object. The <code>incidence2</code> package
provides a function called <code>complete_dates()</code> to ensure that
an incidence object has the same range of dates for each group. By
default, missing counts will be filled with 0.</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create incidence object</span></span>
<span><span class="va">dialy_incidence_data_2</span> <span class="op">&lt;-</span> <span class="fu">incidence2</span><span class="fu">::</span><span class="fu">incidence</span><span class="op">(</span></span>
<span>  <span class="va">linelist</span>,</span>
<span>  date_index <span class="op">=</span> <span class="st">"date_onset"</span>,</span>
<span>  groups <span class="op">=</span> <span class="st">"sex"</span>,</span>
<span>  interval <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Complete missing dates in the incidence object</span></span>
<span><span class="fu">incidence2</span><span class="fu">::</span><span class="fu">complete_dates</span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">dialy_incidence_data_2</span>,</span>
<span>  expand <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  fill <span class="op">=</span> <span class="fl">0L</span>, by <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  allow_POSIXct <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># incidence:  24 x 4
# count vars: date_onset
# groups:     sex
   date_index sex   count_variable count
   &lt;period&gt;   &lt;chr&gt; &lt;chr&gt;          &lt;int&gt;
 1 2023-01-01 f     date_onset       242
 2 2023-01-01 m     date_onset       233
 3 2023-01-02 f     date_onset      2403
 4 2023-01-02 m     date_onset      2501
 5 2023-01-03 f     date_onset      2709
 6 2023-01-03 m     date_onset      2769
 7 2023-01-04 f     date_onset      2600
 8 2023-01-04 m     date_onset      2719
 9 2023-01-05 f     date_onset      1763
10 2023-01-05 m     date_onset      1757
# ℹ 14 more rows</code></pre>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="visualization">Visualization<a class="anchor" aria-label="anchor" href="#visualization"></a></h2>
<hr class="half-width"><p>“The <code>incidence2</code> object can be visualized using the
<code>plot()</code> function from the base R package. The resulting
graph is referred to as an epidemic curve, or epi-curve for short. The
following code snippets generate epi-curves for the
<code>dialy_incidence_data</code> and <code>weekly_incidence_data</code>
incidence objects mentioned above.”</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot daily incidence data</span></span>
<span><span class="fu">base</span><span class="fu">::</span><span class="fu">plot</span><span class="op">(</span><span class="va">dialy_incidence_data</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Time (in days)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Dialy cases"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">tracetheme</span><span class="fu">::</span><span class="fu">theme_trace</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/describe-cases-rendered-unnamed-chunk-7-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot weekly incidence data</span></span>
<span></span>
<span><span class="fu">base</span><span class="fu">::</span><span class="fu">plot</span><span class="op">(</span><span class="va">weekly_incidence_data</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Time (in weeks)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"weekly cases"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">tracetheme</span><span class="fu">::</span><span class="fu">theme_trace</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/describe-cases-rendered-unnamed-chunk-8-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure></section><section><h2 class="section-heading" id="curve-of-cumulative-cases">Curve of cumulative cases<a class="anchor" aria-label="anchor" href="#curve-of-cumulative-cases"></a></h2>
<hr class="half-width"><p>The cumulative number of cases can be calculated using the
<code>cumulate()</code> function from an <code>incidence2</code> object
and visualized, as in the example below.</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cum_df</span> <span class="op">&lt;-</span> <span class="fu">incidence2</span><span class="fu">::</span><span class="fu">cumulate</span><span class="op">(</span><span class="va">dialy_incidence_data</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">base</span><span class="fu">::</span><span class="fu">plot</span><span class="op">(</span><span class="va">cum_df</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Time (in days)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"weekly cases"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">tracetheme</span><span class="fu">::</span><span class="fu">theme_trace</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/describe-cases-rendered-unnamed-chunk-9-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Note that this function preserves grouping, i.e., if the
<code>incidence2</code> object contains groups, it will accumulate the
cases accordingly. Give it a try with the
<code>weekly_incidence_data</code> object!</p>
</section><section><h2 class="section-heading" id="peak-estimation">Peak estimation<a class="anchor" aria-label="anchor" href="#peak-estimation"></a></h2>
<hr class="half-width"><p>One can estimate the peak –the time with the highest number of
recorded cases– using the <code>estimate_peak()</code> function from the
{incidence2} package. This function employs a bootstrapping method to
determine the peak time.</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">peak</span> <span class="op">&lt;-</span> <span class="fu">incidence2</span><span class="fu">::</span><span class="fu">estimate_peak</span><span class="op">(</span></span>
<span>  <span class="va">dialy_incidence_data</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  first_only <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  progress <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">peak</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 1 × 7
  count_variable observed_peak observed_count bootstrap_peaks lower_ci   median
  &lt;chr&gt;          &lt;period&gt;               &lt;int&gt; &lt;list&gt;          &lt;period&gt;   &lt;perio&gt;
1 date_onset     2023-01-03              5478 &lt;df [100 × 1]&gt;  2023-01-03 2023-0…
# ℹ 1 more variable: upper_ci &lt;period&gt;</code></pre>
</div>
<p>This example demonstrates how to estimate the peak time using the
<code>estimate_peak()</code> function at <span class="math inline">\(95%\)</span> confidence interval and using 100
bootstrap samples.</p>
</section><section><h2 class="section-heading" id="visulaziantion-with-ggplot2">Visulaziantion with ggplot2<a class="anchor" aria-label="anchor" href="#visulaziantion-with-ggplot2"></a></h2>
<hr class="half-width"><p><a href="https://www.reconverse.org/incidence2/" class="external-link">incidence2</a> produces basic plots for epicurves, but
additional work is required to create well-annotated graphs. However,
using the <a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a> package, you can generate more
sophisticated and better-annotated epicurves. <a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a> is
a comprehensive package with many functionalities. However, we will
focus on three key elements for producing epicurves: histogram plots,
scaling date axes and their labels, and general plot theme annotation.
The example below demonstrates how to configure these three elements for
a simple <a href="https://www.reconverse.org/incidence2/" class="external-link">incidence2</a> object.</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">breaks</span> <span class="op">&lt;-</span> <span class="fu">seq.Date</span><span class="op">(</span></span>
<span>  from <span class="op">=</span> <span class="fu">min</span><span class="op">(</span><span class="fu">as.Date</span><span class="op">(</span><span class="va">dialy_incidence_data</span><span class="op">$</span><span class="va">date_index</span>,</span>
<span>    na.rm <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span><span class="op">)</span>,</span>
<span>  to <span class="op">=</span> <span class="fu">as.Date</span><span class="op">(</span><span class="fu">max</span><span class="op">(</span><span class="va">dialy_incidence_data</span><span class="op">$</span><span class="va">date_index</span>,</span>
<span>    na.rm <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span><span class="op">)</span>,</span>
<span>  by <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">dialy_incidence_data</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="fu">as.Date</span><span class="op">(</span><span class="va">date_index</span><span class="op">)</span>,</span>
<span>      y <span class="op">=</span> <span class="va">count</span></span>
<span>    <span class="op">)</span>,</span>
<span>    stat <span class="op">=</span> <span class="st">"identity"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"blue"</span>,</span>
<span>    width <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="co"># simple theme</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span></span>
<span>    plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>, hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>    plot.caption <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>face <span class="op">=</span> <span class="st">"italic"</span>, hjust <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>    axis.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>    axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Date"</span>, <span class="co"># x-label</span></span>
<span>    y <span class="op">=</span> <span class="st">"Number of cases"</span>, <span class="co"># y-label,</span></span>
<span>    title <span class="op">=</span> <span class="st">"Daily outbreak cases"</span>, <span class="co"># title</span></span>
<span>    subtitle <span class="op">=</span> <span class="st">"subtitle"</span>, <span class="co"># subtitle</span></span>
<span>    caption <span class="op">=</span> <span class="st">"informative caption"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_date</span><span class="op">(</span></span>
<span>    breaks <span class="op">=</span> <span class="va">breaks</span>,</span>
<span>    label <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu">label_date_short</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/describe-cases-rendered-unnamed-chunk-11-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Use the <code>group</code> option in the mapping function to
visualize an epicurve with different groups. If there is more than one
grouping factor, use the <code>facet_wrap()</code> option, as
demonstrated in the example below:</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">dialy_incidence_data_2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="fu">as.Date</span><span class="op">(</span><span class="va">date_index</span><span class="op">)</span>,</span>
<span>      y <span class="op">=</span> <span class="va">count</span>,</span>
<span>      group <span class="op">=</span> <span class="va">sex</span>,</span>
<span>      fill <span class="op">=</span> <span class="va">sex</span></span>
<span>    <span class="op">)</span>,</span>
<span>    stat <span class="op">=</span> <span class="st">"identity"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="co"># simple theme</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span></span>
<span>    plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>, hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>    plot.caption <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>face <span class="op">=</span> <span class="st">"italic"</span>, hjust <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>    axis.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>    axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Date"</span>, <span class="co"># x-label</span></span>
<span>    y <span class="op">=</span> <span class="st">"Number of cases"</span>, <span class="co"># y-label,</span></span>
<span>    title <span class="op">=</span> <span class="st">"Daily outbreak cases"</span>, <span class="co"># title</span></span>
<span>    subtitle <span class="op">=</span> <span class="st">"subtitle"</span>, <span class="co"># subtitle</span></span>
<span>    caption <span class="op">=</span> <span class="st">"informative caption"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">sex</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_date</span><span class="op">(</span></span>
<span>    breaks <span class="op">=</span> <span class="va">breaks</span>,</span>
<span>    label <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu">label_date_short</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/describe-cases-rendered-unnamed-chunk-12-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="challenge-1-can-you-do-it" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-1-can-you-do-it" class="callout-inner">
<h3 class="callout-title">Challenge 1: Can you do it?</h3>
<div class="callout-content">
<ul><li>Using suitable distributions for contacts, contact interval,
infectious period, onset to hospitalized, and onset to death, generate a
simulated linelist data for Marburg outbreak that has the probability of
<span class="math inline">\(0.5\)</span> infection?</li>
<li>Aggregate the generated linelist and produce some epidemic
curves?</li>
</ul></div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul><li>Use <code>{simulist}</code> package to generate synthetic outbreak
data</li>
<li>Use <a href="https://www.reconverse.org/incidence2/" class="external-link">incidence2</a> package to aggregate case data based
on a date event, and produce epidemic curves.</li>
</ul></div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></div> <!-- / div.lesson-content -->
    </main><!-- / main#main-content.main-content --><nav class="bottom-pagination mx-md-4" aria-label="Previous and Next Chapter"><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="clean-data.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="index.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="clean-data.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Clean and validate
        </a>
        <a class="chapter-link float-end" href="index.html" rel="next">
          Home
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
    </nav></div> <!-- / div.primary-content.col-xs-12 -->
<!-- END:   inst/pkgdown/templates/content-instructor.html-->

      </div><!--/div.row-->
      		<footer class="row footer mx-md-3"><hr><div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>

        <a href="https://github.com/epiverse-trace/tutorials-early/edit/main/episodes/describe-cases.Rmd" class="external-link">Edit on GitHub</a>

	
        | <a href="https://github.com/epiverse-trace/tutorials-early/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/epiverse-trace/tutorials-early/" class="external-link">Source</a></p>
				<p><a href="https://github.com/epiverse-trace/tutorials-early/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:andree.valle-campos@lshtm.ac.uk">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>

        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/epiverse-trace/sandpaper/tree/patch-renv-github-bug" class="external-link">sandpaper (0.16.6)</a>, <a href="https://github.com/carpentries/pegboard/tree/ad2542f7f7b9c3f90cc871b355ff81ec14a09ca9" class="external-link">pegboard (0.7.6)</a>, and <a href="https://github.com/epiverse-trace/varnish/tree/epiversetheme" class="external-link">varnish (1.0.3)</a></p>
			</div>
		</footer></div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://epiverse-trace.github.io/tutorials-early/describe-cases.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software,data,lesson,The Carpentries",
  "name": "Aggregate and visualize",
  "creativeWorkStatus": "active",
  "url": "https://epiverse-trace.github.io/tutorials-early/describe-cases.html",
  "identifier": "https://epiverse-trace.github.io/tutorials-early/describe-cases.html",
  "dateCreated": "2024-09-30",
  "dateModified": "2024-09-24",
  "datePublished": "2024-09-30"
}

  </script><script>
		feather.replace();
	</script></body></html><!-- END:   inst/pkgdown/templates/layout.html-->

