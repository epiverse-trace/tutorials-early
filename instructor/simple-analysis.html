<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Read and clean case data, and make linelist for outbreak analytics with R: Simple analysis</title><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="stylesheet" type="text/css" href="../assets/styles.css"><script src="../assets/scripts.js" type="text/javascript"></script><!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-XZ471458FQ"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-XZ471458FQ');
    </script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="manifest" href="../site.webmanifest"><link rel="mask-icon" href="../safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" content="#ffffff"></head><body>
    <header id="top" class="navbar navbar-expand-md navbar-light bg-white top-nav incubator"><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-6">
      <div class="large-logo">
        <img alt="Epiverse-TRACE" src="../assets/images/epiverse-logo.svg"><abbr class="badge badge-light" title="This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught." style="background-color: #FF4955; border-radius: 5px">
          <a href="https://cdh.carpentries.org/the-lesson-life-cycle.html#early-development-pre-alpha-through-alpha" class="external-link alert-link" style="color: #FFF">
            <i aria-hidden="true" class="icon" data-feather="alert-octagon" style="border-radius: 5px"></i>
            Pre-Alpha
          </a>
          <span class="visually-hidden">This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.</span>
        </abbr>
        
      </div>
    </div>
    <div class="selector-container">
      
      
      <div class="dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li><button class="dropdown-item" type="button" onclick="window.location.href='../simple-analysis.html';">Learner View</button></li>
        </ul></div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl navbar-light bg-white bottom-nav incubator" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Epiverse-TRACE" src="../assets/images/epiverse-logo.svg"></div>
    <div class="lesson-title-md">
      Read and clean case data, and make linelist for outbreak analytics with R
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item">
          <span class="lesson-title">
            Read and clean case data, and make linelist for outbreak analytics with R
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/instructor-notes.html">Instructor Notes</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/images.html">Extract All Images</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"><hr><li><a class="dropdown-item" href="reference.html">Glossary of Terms: Epiverse-TRACE</a></li>
          </ul></li>
      </ul></div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a class="btn btn-primary" href="../instructor/aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div><!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Read and clean case data, and make linelist for outbreak analytics with R
</div>

<aside class="col-md-12 lesson-progress"><div style="width: 75%" class="percentage">
    75%
  </div>
  <div class="progress incubator">
    <div class="progress-bar incubator" role="progressbar" style="width: 75%" aria-valuenow="75" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="../simple-analysis.html">Learner View</a>
                      </div>
                    </div>
                  </div><!--/div.accordion-item-->
                </div><!--/div.accordion-flush-->
              </div><!--div.sidenav-view-selector -->
            </div><!--/div.col -->
      
            <hr></div><!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Schedule</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="read-cases.html">1. Read case data</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="clean-data.html">2. Clean and validate</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="describe-cases.html">3. Aggregate and visualize</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlushcurrent">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-headingcurrent">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapsecurrent" aria-expanded="true" aria-controls="flush-collapsecurrent">
        <span class="visually-hidden">Current Chapter</span>
        <span class="current-chapter">
        4. Simple analysis
        </span>
      </button>
    </div><!--/div.accordion-header-->
        
    <div id="flush-collapsecurrent" class="accordion-collapse collapse show" aria-labelledby="flush-headingcurrent" data-bs-parent="#accordionFlushcurrent">
      <div class="accordion-body">
        <ul><li><a href="#introduction">Introduction</a></li>
<li><a href="#simple-model">Simple model</a></li>
<li><a href="#exponential-growth-or-decay-rate">Exponential growth or decay rate</a></li>
<li><a href="#peak-time">Peak time</a></li>
<li><a href="#moving-average">Moving average</a></li>
        </ul></div><!--/div.accordion-body-->
    </div><!--/div.accordion-collapse-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width"><div class="accordion accordion-flush resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul><li>
                        <a href="../instructor/key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="../instructor/instructor-notes.html">Instructor Notes</a>
                      </li>
                      <li>
                        <a href="../instructor/images.html">Extract All Images</a>
                      </li>
                      <hr><li><a class="dropdown-item" href="reference.html">Glossary of Terms: Epiverse-TRACE</a></li>
                    </ul></div>
                </div>
              </div>
            </div>
            <hr class="half-width resources"><a href="../instructor/aio.html">See all in one page</a>
            

            <hr class="d-none d-sm-block d-md-none"><div class="d-grid gap-1">
            
            </div>
          </div><!-- /div.accordion -->
        </div><!-- /div.sidebar-inner -->
      </nav></div><!-- /div.sidebar -->
  </div><!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-instructor.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <nav class="lesson-content mx-md-4" aria-label="Previous and Next Chapter"><!-- content for small screens --><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="../instructor/describe-cases.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="../instructor/index.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="../instructor/describe-cases.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Aggregate and
        </a>
        <a class="chapter-link float-end" href="../instructor/index.html" rel="next">
          Home
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
      <hr></nav><main id="main-content" class="main-content"><div class="container lesson-content">
        <h1>Simple analysis</h1>
        <p>Last updated on 2024-06-18 |
        
        <a href="https://github.com/epiverse-trace/tutorials-early/edit/main/episodes/simple-analysis.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
        
        
        
        <p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 30 minutes</p>
        
        <div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>

        

<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul><li>What is the growth rate of the epidemic?</li>
<li>How to identify the peak time of an outbreak?</li>
<li>How to compute moving average of cases?</li>
</ul></div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul><li>Perform an early analysis of outbreak data</li>
<li>Identify trends, exponential, doubling, and peak time</li>
</ul></div>
</div>
</div>
</div>
</div>
<section id="introduction"><h2 class="section-heading">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width"><p>Understanding the trend in case data is crucial for various purposes,
such as forecasting future case counts, implementing public health
interventions, and assessing the effectiveness of control measures. By
analyzing the trend, policymakers and public health experts can make
informed decisions to mitigate the spread of diseases and protect public
health. This episode focuses on how to perform a simple early analysis
on incidence data. It uses the same dataset of <strong>Covid-19 case
data from England</strong> that utilized it in <a href="describe-cases.html">Aggregate and visualize</a> episode.</p>
<div id="the-double-colon" class="callout checklist">
<div class="callout-square">
<i class="callout-icon" data-feather="check-square"></i>
</div>
<div id="the-double-colon" class="callout-inner">
<h3 class="callout-title">The double-colon<a class="anchor" aria-label="anchor" href="#the-double-colon"></a>
</h3>
<div class="callout-content">
<p>The double-colon <code>::</code> in R let you call a specific
function from a package without loading the entire package into the
current environment.</p>
<p>For example, <code>dplyr::filter(data, condition)</code> uses
<code>filter()</code> from the <a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a> package.</p>
<p>This help us remember package functions and avoid namespace
conflicts.</p>
</div>
</div>
</div>
</section><section id="simple-model"><h2 class="section-heading">Simple model<a class="anchor" aria-label="anchor" href="#simple-model"></a>
</h2>
<hr class="half-width"><p>Aggregated case data over a specific time unit, or incidence data,
typically represent the number of cases occurring within that time
frame. These data can often be assumed to follow either
<code>Poisson distribution</code> or a
<code>negative binomial (NB) distribution</code>, depending on the
specific characteristics of the data and the underlying processes
generating them. When analyzing such data, one common approach is to
examine the trend over time by computing the rate of change, which can
indicate whether there is exponential growth or decay in the number of
cases. Exponential growth implies that the number of cases is increasing
at an accelerating rate over time, while exponential decay suggests that
the number of cases is decreasing at a decelerating rate.</p>
<p>The <code>i2extras</code> package provides methods for modelling the
trend in case data, calculating moving averages, and exponential growth
or decay rate. The code chunk below computes the Covid-19 trend in UK
within first 3 months using negative binomial distribution.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load packages which provides methods for modeling</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="st">"i2extras"</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="st">"incidence2"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># read data from {outbreaks} package</span></span>
<span><span class="va">covid19_eng_case_data</span> <span class="op">&lt;-</span> <span class="fu">outbreaks</span><span class="fu">::</span><span class="va">covid19_england_nhscalls_2020</span></span>
<span></span>
<span><span class="co"># subset the covid19_eng_case_data to include only the first 3 months of data</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">base</span><span class="fu">::</span><span class="fu">subset</span><span class="op">(</span></span>
<span>  <span class="va">covid19_eng_case_data</span>,</span>
<span>  <span class="va">covid19_eng_case_data</span><span class="op">$</span><span class="va">date</span> <span class="op">&lt;=</span> <span class="fu">min</span><span class="op">(</span><span class="va">covid19_eng_case_data</span><span class="op">$</span><span class="va">date</span><span class="op">)</span> <span class="op">+</span> <span class="fl">90</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># uses the incidence function from the incidence2 package to compute the</span></span>
<span><span class="co"># incidence data</span></span>
<span><span class="va">df_incid</span> <span class="op">&lt;-</span> <span class="fu">incidence2</span><span class="fu">::</span><span class="fu">incidence</span><span class="op">(</span></span>
<span>  <span class="va">df</span>,</span>
<span>  date_index <span class="op">=</span> <span class="st">"date"</span>,</span>
<span>  groups <span class="op">=</span> <span class="st">"sex"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># fit a curve to the incidence data. The model chosen is the negative binomial</span></span>
<span><span class="co"># distribution with a significance level (alpha) of 0.05.</span></span>
<span><span class="va">fitted_curve_nb</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">i2extras</span><span class="fu">::</span><span class="fu">fit_curve</span><span class="op">(</span></span>
<span>    <span class="va">df_incid</span>,</span>
<span>    model <span class="op">=</span> <span class="st">"negbin"</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">0.05</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># plot fitted curve</span></span>
<span><span class="fu">base</span><span class="fu">::</span><span class="fu">plot</span><span class="op">(</span><span class="va">fitted_curve_nb</span>, angle <span class="op">=</span> <span class="fl">45</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Date"</span>, y <span class="op">=</span> <span class="st">"Cases"</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/simple-analysis-rendered-unnamed-chunk-1-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="challenge-1-poission-distribution" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-1-poission-distribution" class="callout-inner">
<h3 class="callout-title">Challenge 1: Poission distribution<a class="anchor" aria-label="anchor" href="#challenge-1-poission-distribution"></a>
</h3>
<div class="callout-content">
<p>Repeat the above analysis using Poisson distribution?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Show me the solution</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fitted_curve_poisson</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">i2extras</span><span class="fu">::</span><span class="fu">fit_curve</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">df_incid</span>,</span>
<span>    model <span class="op">=</span> <span class="st">"poisson"</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">0.05</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu">base</span><span class="fu">::</span><span class="fu">plot</span><span class="op">(</span><span class="va">fitted_curve_poisson</span>, angle <span class="op">=</span> <span class="fl">45</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Date"</span>, y <span class="op">=</span> <span class="st">"Cases"</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/simple-analysis-rendered-unnamed-chunk-2-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure></div>
</div>
</div>
</div>
</section><section id="exponential-growth-or-decay-rate"><h2 class="section-heading">Exponential growth or decay rate<a class="anchor" aria-label="anchor" href="#exponential-growth-or-decay-rate"></a>
</h2>
<hr class="half-width"><p>The exponential growth or decay rate, denoted as <span class="math inline">\(r\)</span>, serves as an indicator for the trend
in cases, indicating whether they are increasing (growth) or decreasing
(decay) on an exponential scale. This rate is computed using the
so-called <strong>renewal equation</strong> <a href="https://royalsocietypublishing.org/doi/10.1098/rspb.2006.3754" class="external-link">(Wallinga
et al. 2006)</a>, which mechanistically links the reproductive number
<span class="math inline">\(R\)</span> of new cases to the generation
interval of the disease. This computational method is implemented in the
<a href="https://www.reconverse.org/i2extras/" class="external-link">i2extras</a> package.</p>
<p>Below is a code snippet demonstrating how to extract the growth/decay
rate from the above <strong>NB</strong>-fitted curve using the
<code>growth_rate()</code> function:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rates_nb</span> <span class="op">&lt;-</span> <span class="fu">i2extras</span><span class="fu">::</span><span class="fu">growth_rate</span><span class="op">(</span><span class="va">fitted_curve_nb</span><span class="op">)</span></span>
<span><span class="va">rates_nb</span> <span class="op">&lt;-</span> <span class="fu">base</span><span class="fu">::</span><span class="fu">as.data.frame</span><span class="op">(</span><span class="va">rates_nb</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">subset</span><span class="op">(</span>select <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="va">sex</span>, <span class="va">r</span>, <span class="va">r_lower</span>, <span class="va">r_upper</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">base</span><span class="fu">::</span><span class="fu">print</span><span class="op">(</span><span class="va">rates_nb</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>      sex            r      r_lower      r_upper
1  female -0.008241228 -0.009182635 -0.007300403
2    male -0.008346783 -0.009316775 -0.007377392
3 unknown -0.023703987 -0.028179436 -0.019299926</code></pre>
</div>
<div id="challenge-2-growth-rates-from-a-poisson-fitted-curve" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-2-growth-rates-from-a-poisson-fitted-curve" class="callout-inner">
<h3 class="callout-title">Challenge 2: Growth rates from a<strong>Poisson</strong>-fitted curve<a class="anchor" aria-label="anchor" href="#challenge-2-growth-rates-from-a-poisson-fitted-curve"></a>
</h3>
<div class="callout-content">
<p>Extract growth rates from the <strong>Poisson</strong>-fitted curve
of <strong>Challenge 1</strong>?</p>
</div>
</div>
</div>
</section><section id="peak-time"><h2 class="section-heading">Peak time<a class="anchor" aria-label="anchor" href="#peak-time"></a>
</h2>
<hr class="half-width"><p>The <strong>Peak time </strong> is the time at which the highest
number of cases is observed in the aggregated data. It can be estimated
using the <code>i2extras::estimate_peak()</code> function as shown in
the below code chunk, which identify peak time from the
<code>incidenc2</code> object <code>df_incid</code>.</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">peaks_nb</span> <span class="op">&lt;-</span> <span class="fu">i2extras</span><span class="fu">::</span><span class="fu">estimate_peak</span><span class="op">(</span><span class="va">df_incid</span>, progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">subset</span><span class="op">(</span>select <span class="op">=</span> <span class="op">-</span><span class="fu">c</span><span class="op">(</span><span class="va">count_variable</span>, <span class="va">bootstrap_peaks</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">base</span><span class="fu">::</span><span class="fu">print</span><span class="op">(</span><span class="va">peaks_nb</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A data frame: 3 × 6
  sex     observed_peak observed_count lower_ci   median     upper_ci  
* &lt;chr&gt;   &lt;date&gt;                 &lt;int&gt; &lt;date&gt;     &lt;date&gt;     &lt;date&gt;    
1 female  2020-03-26              1314 2020-03-19 2020-03-23 2020-03-30
2 male    2020-03-27              1299 2020-03-18 2020-03-26 2020-03-30
3 unknown 2020-04-10                32 2020-03-24 2020-04-10 2020-04-16</code></pre>
</div>
</section><section id="moving-average"><h2 class="section-heading">Moving average<a class="anchor" aria-label="anchor" href="#moving-average"></a>
</h2>
<hr class="half-width"><p>A moving or rolling average calculates the average number of cases
within a specified time period. This can be achieved by utilizing the
<code>add_rolling_average()</code> function from the
<a href="https://www.reconverse.org/i2extras/" class="external-link">i2extras</a> package on an <code>incidence2 object</code>.
The following code chunk demonstrates the computation of the weekly
average number of cases from the <code>incidence2</code> object
<code>df_incid</code>, followed by visualization.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="st">"ggplot2"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">moving_Avg_week</span> <span class="op">&lt;-</span> <span class="fu">i2extras</span><span class="fu">::</span><span class="fu">add_rolling_average</span><span class="op">(</span><span class="va">df_incid</span>, n <span class="op">=</span> <span class="fl">7L</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">base</span><span class="fu">::</span><span class="fu">plot</span><span class="op">(</span><span class="va">moving_Avg_week</span>, border_colour <span class="op">=</span> <span class="st">"white"</span>, angle <span class="op">=</span> <span class="fl">45</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">geom_line</span><span class="op">(</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">aes</span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">date_index</span>,</span>
<span>      y <span class="op">=</span> <span class="va">rolling_average</span>,</span>
<span>      color <span class="op">=</span> <span class="st">"red"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Date"</span>, y <span class="op">=</span> <span class="st">"Cases"</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/simple-analysis-rendered-unnamed-chunk-5-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="challenge-3-monthly-moving-average" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-3-monthly-moving-average" class="callout-inner">
<h3 class="callout-title">Challenge 3: Monthly moving average<a class="anchor" aria-label="anchor" href="#challenge-3-monthly-moving-average"></a>
</h3>
<div class="callout-content">
<p>Compute and visualize the monthly moving average of cases on
<code>df_incid</code>?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">Show me the solution</h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">moving_Avg_mont</span> <span class="op">&lt;-</span> <span class="fu">i2extras</span><span class="fu">::</span><span class="fu">add_rolling_average</span><span class="op">(</span><span class="va">df_incid</span>, n <span class="op">=</span> <span class="fl">30L</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">base</span><span class="fu">::</span><span class="fu">plot</span><span class="op">(</span></span>
<span>  <span class="va">moving_Avg_mont</span>,</span>
<span>  border_colour <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>  angle <span class="op">=</span> <span class="fl">45</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">geom_line</span><span class="op">(</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">aes</span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">date_index</span>,</span>
<span>      y <span class="op">=</span> <span class="va">rolling_average</span>,</span>
<span>      color <span class="op">=</span> <span class="st">"red"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Date"</span>, y <span class="op">=</span> <span class="st">"Cases"</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/simple-analysis-rendered-unnamed-chunk-6-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure></div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul><li>Use <a href="https://www.reconverse.org/i2extras/" class="external-link">i2extras</a> to:
<ul><li>fit epi-curve using either <strong>Poisson</strong> or
<strong>NB</strong> distributions,<br></li>
<li>calculate exponential growth or decline of cases,</li>
<li>find peak time, and</li>
<li>computing moving average of cases in specified time window.</li>
</ul></li>
</ul></div>
</div>
</div>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</section></div> <!-- / div.lesson-content -->
    </main><!-- / main#main-content.main-content --><nav class="bottom-pagination mx-md-4" aria-label="Previous and Next Chapter"><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="../instructor/describe-cases.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="../instructor/index.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="../instructor/describe-cases.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Aggregate and
        </a>
        <a class="chapter-link float-end" href="../instructor/index.html" rel="next">
          Home
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
    </nav></div> <!-- / div.primary-content.col-xs-12 -->
<!-- END:   inst/pkgdown/templates/content-instructor.html-->

      </div><!--/div.row-->
      		<footer class="row footer mx-md-3"><hr><div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>
        
        <a href="https://github.com/epiverse-trace/tutorials-early/edit/main/episodes/simple-analysis.Rmd" class="external-link">Edit on GitHub</a>
        
	
        | <a href="https://github.com/epiverse-trace/tutorials-early/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/epiverse-trace/tutorials-early/" class="external-link">Source</a></p>
				<p><a href="https://github.com/epiverse-trace/tutorials-early/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:andree.valle-campos@lshtm.ac.uk">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">
        
        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>
        
        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/epiverse-trace/sandpaper/tree/patch-renv-github-bug" class="external-link">sandpaper (0.16.4)</a>, <a href="https://github.com/carpentries/pegboard/tree/a32a7836d4455f407c3cafe8ab95edc636e5e919" class="external-link">pegboard (0.7.5)</a>, and <a href="https://github.com/epiverse-trace/varnish/tree/epiversetheme" class="external-link">varnish (1.0.2)</a></p>
			</div>
		</footer></div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://epiverse-trace.github.io/tutorials-early/instructor/simple-analysis.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software,data,lesson,The Carpentries",
  "name": "Simple analysis",
  "creativeWorkStatus": "active",
  "url": "https://epiverse-trace.github.io/tutorials-early/instructor/simple-analysis.html",
  "identifier": "https://epiverse-trace.github.io/tutorials-early/instructor/simple-analysis.html",
  "dateCreated": "2024-06-19",
  "dateModified": "2024-06-18",
  "datePublished": "2024-06-19"
}

  </script><script>
		feather.replace();
	</script><!-- Matomo
    2022-11-07: we have gotten a notification that we have an overage for our
    tracking and I'm pretty sure this has to do with Workbench usage.
    Considering that I am not _currently_ using this tracking because I do not
    yet know how to access the data, I am turning this off for now.
  <script>
    var _paq = window._paq = window._paq || [];
    /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
    _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
    _paq.push(["setDomains", ["*.preview.carpentries.org","*.datacarpentry.github.io","*.datacarpentry.org","*.librarycarpentry.github.io","*.librarycarpentry.org","*.swcarpentry.github.io", "*.carpentries.github.io"]]);
    _paq.push(["setDoNotTrack", true]);
    _paq.push(["disableCookies"]);
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
          var u="https://carpentries.matomo.cloud/";
          _paq.push(['setTrackerUrl', u+'matomo.php']);
          _paq.push(['setSiteId', '1']);
          var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
          g.async=true; g.src='https://cdn.matomo.cloud/carpentries.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
        })();
  </script>
  End Matomo Code --></body></html><!-- END:   inst/pkgdown/templates/layout.html-->

