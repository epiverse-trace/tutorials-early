<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>Read and clean case data, and make linelist for outbreak analytics with R: All in One View</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="../assets/styles.css">
<script src="../assets/scripts.js" type="text/javascript"></script><!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-XZ471458FQ"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-XZ471458FQ');
    </script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="manifest" href="../site.webmanifest">
<link rel="mask-icon" href="../safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
</head>
<body>
    <header id="top" class="navbar navbar-expand-md navbar-light bg-white top-nav incubator"><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-6">
      <div class="large-logo">
        <img alt="Epiverse-TRACE" src="../assets/images/epiverse-logo.svg"><abbr class="badge badge-light" title="This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught." style="background-color: #FF4955; border-radius: 5px">
          <a href="https://cdh.carpentries.org/the-lesson-life-cycle.html#early-development-pre-alpha-through-alpha" class="external-link alert-link" style="color: #FFF">
            <i aria-hidden="true" class="icon" data-feather="alert-octagon" style="border-radius: 5px"></i>
            Pre-Alpha
          </a>
          <span class="visually-hidden">This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.</span>
        </abbr>
        
      </div>
    </div>
    <div class="selector-container">
      
      
      <div class="dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
<li><button class="dropdown-item" type="button" onclick="window.location.href='../aio.html';">Learner View</button></li>
        </ul>
</div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl navbar-light bg-white bottom-nav incubator" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Epiverse-TRACE" src="../assets/images/epiverse-logo.svg">
</div>
    <div class="lesson-title-md">
      Read and clean case data, and make linelist for outbreak analytics with R
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
<li class="nav-item">
          <span class="lesson-title">
            Read and clean case data, and make linelist for outbreak analytics with R
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/instructor-notes.html">Instructor Notes</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/images.html">Extract All Images</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
<hr>
<li><a class="dropdown-item" href="reference.html">Glossary of Terms: Epiverse-TRACE</a></li>
          </ul>
</li>
      </ul>
</div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a class="btn btn-primary" href="../instructor/aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div>
<!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Read and clean case data, and make linelist for outbreak analytics with R
</div>

<aside class="col-md-12 lesson-progress"><div style="width: %" class="percentage">
    %
  </div>
  <div class="progress incubator">
    <div class="progress-bar incubator" role="progressbar" style="width: %" aria-valuenow="" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="../aio.html">Learner View</a>
                      </div>
                    </div>
                  </div>
<!--/div.accordion-item-->
                </div>
<!--/div.accordion-flush-->
              </div>
<!--div.sidenav-view-selector -->
            </div>
<!--/div.col -->
      
            <hr>
</div>
<!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Schedule</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="read-cases.html">1. Read case data</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="clean-data.html">2. Clean and validate</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="describe-cases.html">3. Aggregate and visualize</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="simple-analysis.html">4. Simple analysis</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="delays-reuse.html">5. Access epidemiological delay distributions</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="quantify-transmissibility.html">6. Quantifying transmission</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="delays-functions.html">7. Use delay distributions in analysis</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width">
<div class="accordion accordion-flush resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul>
<li>
                        <a href="../instructor/key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="../instructor/instructor-notes.html">Instructor Notes</a>
                      </li>
                      <li>
                        <a href="../instructor/images.html">Extract All Images</a>
                      </li>
                      <hr>
<li><a class="dropdown-item" href="reference.html">Glossary of Terms: Epiverse-TRACE</a></li>
                    </ul>
</div>
                </div>
              </div>
            </div>
            <hr class="half-width resources">
<a href="../instructor/aio.html">See all in one page</a>
            

            <hr class="d-none d-sm-block d-md-none">
<div class="d-grid gap-1">
            
            </div>
          </div>
<!-- /div.accordion -->
        </div>
<!-- /div.sidebar-inner -->
      </nav>
</div>
<!-- /div.sidebar -->
  </div>
<!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-extra.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <main id="main-content" class="main-content"><div class="container lesson-content">
        
        
<section id="aio-read-cases"><p>Content from <a href="read-cases.html">Read case data</a></p>
<hr>
<p>Last updated on 2024-06-17 |
        
        <a href="https://github.com/epiverse-trace/tutorials-early/edit/main/episodes/read-cases.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 30 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>Where do you usually store your outbreak data?</li>
<li>How many different data formats can I read?</li>
<li>Is it possible to import data from databases and health APIs?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain how to import outbreak data from different sources into
<code>R</code> environment.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div id="prerequisites" class="callout prereq">
<div class="callout-square">
<i class="callout-icon" data-feather="check"></i>
</div>
<div id="prerequisites" class="callout-inner">
<h3 class="callout-title">Prerequisites<a class="anchor" aria-label="anchor" href="#prerequisites"></a>
</h3>
<div class="callout-content">
<p>This episode requires you to be familiar with:</p>
<p><strong>Data science</strong> : Basic programming with R.</p>
</div>
</div>
</div>
<section id="introduction"><h2 class="section-heading">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>The initial step in outbreak analysis involves importing the target
dataset into the <code>R</code> environment from various sources.
Outbreak data is typically stored in files of diverse formats,
relational database management systems (RDBMS), or health information
system (HIS) application program interfaces (APIs) such as <a href="https://www.project-redcap.org/" class="external-link">REDCap</a>, <a href="https://dhis2.org/" class="external-link">DHIS2</a>, etc. The latter option is
particularly well-suited for storing institutional health data. This
episode will elucidate the process of reading cases from these
sources.</p>
<div id="the-double-colon" class="callout checklist">
<div class="callout-square">
<i class="callout-icon" data-feather="check-square"></i>
</div>
<div id="the-double-colon" class="callout-inner">
<h3 class="callout-title">The double-colon<a class="anchor" aria-label="anchor" href="#the-double-colon"></a>
</h3>
<div class="callout-content">
<p>The double-colon <code>::</code> in R let you call a specific
function from a package without loading the entire package into the
current environment.</p>
<p>For example, <code>dplyr::filter(data, condition)</code> uses
<code>filter()</code> from the <a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a> package.</p>
<p>This help us remember package functions and avoid namespace
conflicts.</p>
</div>
</div>
</div>
<div id="setup-a-project-and-folder" class="callout prereq">
<div class="callout-square">
<i class="callout-icon" data-feather="check"></i>
</div>
<div id="setup-a-project-and-folder" class="callout-inner">
<h3 class="callout-title">Setup a project and folder<a class="anchor" aria-label="anchor" href="#setup-a-project-and-folder"></a>
</h3>
<div class="callout-content">
<ul>
<li>Create an RStudio project. If needed, follow this <a href="https://docs.posit.co/ide/user/ide/get-started/#hello-rstudio-projects" class="external-link">how-to
guide on “Hello RStudio Projects”</a> to create one.</li>
<li>Inside the RStudio project, create the <code>data/</code>
folder.</li>
<li>Inside the <code>data/</code> folder, save the <a href="https://epiverse-trace.github.io/tutorials-early/data/ebola_cases.csv" class="external-link">ebola_cases.csv</a>
and <a href="https://epiverse-trace.github.io/tutorials-early/data/Marburg.zip" class="external-link">marburg.zip</a>
files.</li>
</ul>
</div>
</div>
</div>
</section><section id="reading-from-files"><h2 class="section-heading">Reading from files<a class="anchor" aria-label="anchor" href="#reading-from-files"></a>
</h2>
<hr class="half-width">
<p>Several packages are available for importing outbreak data stored in
individual files into <code>R</code>. These include <a href="http://gesistsa.github.io/rio/" class="external-link">rio</a>, <a href="https://readr.tidyverse.org/" class="external-link">readr</a> from the
<code>tidyverse</code>, <a href="https://bitbucket.org/djhshih/io/src/master/" class="external-link">io</a>, <a href="https://cran.r-project.org/web/packages/ImportExport/index.html" class="external-link">ImportExport</a>,
and <a href="https://rdatatable.gitlab.io/data.table/" class="external-link">data.table</a>.
Together, these packages offer methods to read single or multiple files
in a wide range of formats.</p>
<p>The below example shows how to import a <code>csv</code> file into
<code>R</code> environment using <a href="https://gesistsa.github.io/rio/" class="external-link">rio</a> package.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="st">"rio"</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="st">"here"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># read data</span></span>
<span><span class="co"># e.g., the path to our file is data/raw-data/ebola_cases.csv then:</span></span>
<span><span class="va">ebola_confirmed</span> <span class="op">&lt;-</span> <span class="fu">rio</span><span class="fu">::</span><span class="fu">import</span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu">here</span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"ebola_cases.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># preview data</span></span>
<span><span class="fu">head</span><span class="op">(</span><span class="va">ebola_confirmed</span>, <span class="fl">5</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>        date confirm
1 2014-05-18       1
2 2014-05-20       2
3 2014-05-21       4
4 2014-05-22       6
5 2014-05-23       1</code></pre>
</div>
<p>Similarly, you can import files of other formats such as
<code>tsv</code>, <code>xlsx</code>, … etc.</p>
<div id="reading-compressed-data" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="reading-compressed-data" class="callout-inner">
<h3 class="callout-title">Reading compressed data<a class="anchor" aria-label="anchor" href="#reading-compressed-data"></a>
</h3>
<div class="callout-content">
<p>Take 1 minute: Can you read data from a compressed file in
<code>R</code>? Download this <a href="https://epiverse-trace.github.io/tutorials-early/data/Marburg.zip" class="external-link">zip
file</a> containing data for Marburg outbreak and then import it to your
working environment.</p>
</div>
</div>
</div>
<div id="accordionHint1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button hint-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHint1" aria-expanded="false" aria-controls="collapseHint1">
  <h4 class="accordion-header" id="headingHint1">Give me a hint</h4>
</button>
<div id="collapseHint1" class="accordion-collapse collapse" aria-labelledby="headingHint1" data-bs-parent="#accordionHint1">
<div class="accordion-body">
<p>You can check the <a href="http://gesistsa.github.io/rio/#supported-file-formats" class="external-link">full list
of supported file formats</a> in the <a href="https://gesistsa.github.io/rio/" class="external-link">rio</a> package on the
package website. To expand {rio} to the full range of support for import
and export formats run:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">rio</span><span class="fu">::</span><span class="fu">install_formats</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<p>You can use this template to read the file:</p>
<p><code>rio::import(here::here("some", "where", "downto", "path", "file_name.zip"))</code></p>
</div>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Show me the solution</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">rio</span><span class="fu">::</span><span class="fu">import</span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu">here</span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"Marburg.zip"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section id="reading-from-databases"><h2 class="section-heading">Reading from databases<a class="anchor" aria-label="anchor" href="#reading-from-databases"></a>
</h2>
<hr class="half-width">
<p>The <a href="https://dbi.r-dbi.org/" class="external-link">DBI</a> package serves as a
versatile interface for interacting with database management systems
(DBMS) across different back-ends or servers. It offers a uniform method
for accessing and retrieving data from various database systems.</p>
<p>The following code chunk demonstrates how to create a temporary
SQLite database in memory, store the <code>ebola_confirmed</code> as a
table on it, and subsequently read it:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="st">"DBI"</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="st">"RSQLite"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a temporary SQLite database in memory</span></span>
<span><span class="va">db_con</span> <span class="op">&lt;-</span> <span class="fu">DBI</span><span class="fu">::</span><span class="fu">dbConnect</span><span class="op">(</span></span>
<span>  drv <span class="op">=</span> <span class="fu">RSQLite</span><span class="fu">::</span><span class="fu">SQLite</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  dbname <span class="op">=</span> <span class="st">":memory:"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Store the 'ebola_confirmed' dataframe as a table named 'cases'</span></span>
<span><span class="co"># in the SQLite database</span></span>
<span><span class="fu">DBI</span><span class="fu">::</span><span class="fu">dbWriteTable</span><span class="op">(</span></span>
<span>  conn <span class="op">=</span> <span class="va">db_con</span>,</span>
<span>  name <span class="op">=</span> <span class="st">"cases"</span>,</span>
<span>  value <span class="op">=</span> <span class="va">ebola_confirmed</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in h(simpleError(msg, call)): error in evaluating the argument 'value' in selecting a method for function 'dbWriteTable': object 'ebola_confirmed' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Read data from the 'cases' table</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">DBI</span><span class="fu">::</span><span class="fu">dbReadTable</span><span class="op">(</span></span>
<span>  conn <span class="op">=</span> <span class="va">db_con</span>,</span>
<span>  name <span class="op">=</span> <span class="st">"cases"</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: no such table: cases</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Close the database connection</span></span>
<span><span class="fu">DBI</span><span class="fu">::</span><span class="fu">dbDisconnect</span><span class="op">(</span>conn <span class="op">=</span> <span class="va">db_con</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View the result</span></span>
<span><span class="fu">base</span><span class="fu">::</span><span class="fu">print</span><span class="op">(</span><span class="fu">utils</span><span class="fu">::</span><span class="fu">head</span><span class="op">(</span><span class="va">result</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'result' not found</code></pre>
</div>
<p>This code first establishes a connection to an SQLite database
created in memory using <code>dbConnect()</code>. Then, it writes the
<code>ebola_confirmed</code> into a table named ‘cases’ within the
database using the <code>dbWriteTable()</code> function. Subsequently,
it reads the data from the ‘cases’ table using
<code>dbReadTable()</code>. Finally, it closes the database connection
with <code>dbDisconnect()</code>.</p>
<div id="run-sql-queries-in-r-using-dbplyr" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="run-sql-queries-in-r-using-dbplyr" class="callout-inner">
<h3 class="callout-title">Run SQL queries in R using dbplyr<a class="anchor" aria-label="anchor" href="#run-sql-queries-in-r-using-dbplyr"></a>
</h3>
<div class="callout-content">
<p>We can use database interface packages to optimize memory usage. If
we process the database with “queries” (e.g., select, filter, summarise)
before extraction, we can reduce the memory load in our RStudio session.
Conversely, conducting all data manipulation outside the database
management system can lead to occupying more disk space than desired
running out of memory.</p>
<p>Read this <a href="https://datacarpentry.org/R-ecology-lesson/05-r-and-databases.html#complex-database-queries" class="external-link">tutorial
episode on SQL databases and R</a> to practice how to make relational
database SQL queries using multiple {dplyr} verbs like
<code>left_join()</code> among tables before pulling down data to your
local session with <code>collect()</code>!</p>
</div>
</div>
</div>
</section><section id="reading-from-his-apis"><h2 class="section-heading">Reading from HIS APIs<a class="anchor" aria-label="anchor" href="#reading-from-his-apis"></a>
</h2>
<hr class="half-width">
<p>Health related data are also increasingly stored in specialized HIS
APIs like <strong>Fingertips</strong>, <strong>GoData</strong>,
<strong>REDCap</strong>, and <strong>DHIS2</strong>. In such case one
can resort to <a href="https://epiverse-trace.github.io/readepi/" class="external-link">readepi</a> package,
which enables reading data from HIS-APIs.<br>
-[TBC]</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Use <code>{rio}, {io}, {readr}</code> and
<code>{ImportExport}</code> to read data from individual files.</li>
<li>Use <code>{readepi}</code> to read data form HIS APIs and
RDBMS.</li>
</ul>
</div>
</div>
</div>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</section></section><section id="aio-clean-data"><p>Content from <a href="clean-data.html">Clean and validate</a></p>
<hr>
<p>Last updated on 2024-06-17 |
        
        <a href="https://github.com/epiverse-trace/tutorials-early/edit/main/episodes/clean-data.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 30 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How to clean and standardize case data?</li>
<li>How to convert raw dataset into a <code>linelist</code> object?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain how to clean, curate, and standardize case data using
<a href="https://epiverse-trace.github.io/cleanepi/" class="external-link">cleanepi</a> package</li>
<li>Demonstrate how to covert case data to <code>linelist</code>
data</li>
<li>Perform essential data-cleaning operations to be performed in a raw
case dataset.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div id="prereq1" class="callout prereq">
<div class="callout-square">
<i class="callout-icon" data-feather="check"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Prerequisite<a class="anchor" aria-label="anchor" href="#prereq1"></a>
</h3>
<div class="callout-content">
<p>This episode requires you to:</p>
<ul>
<li>Download the <a href="https://epiverse-trace.github.io/tutorials-early/data/simulated_ebola_2.csv" class="external-link">simulated_ebola_2.csv</a>
</li>
<li>Save it in the <code>data/</code> folder.</li>
</ul>
</div>
</div>
</div>
<section id="introduction"><h2 class="section-heading">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>In the process of analyzing outbreak data, it’s essential to ensure
that the dataset is clean, curated, standardized, and valid to
facilitate accurate and reproducible analysis. This episode focuses on
cleaning epidemics and outbreaks data using the <a href="https://epiverse-trace.github.io/cleanepi/" class="external-link">cleanepi</a> package,
and validate it using the <a href="https://epiverse-trace.github.io/linelist/" class="external-link">linelist</a> package.
For demonstration purposes, we’ll work with a simulated dataset of Ebola
cases.</p>
<div id="the-double-colon" class="callout checklist">
<div class="callout-square">
<i class="callout-icon" data-feather="check-square"></i>
</div>
<div id="the-double-colon" class="callout-inner">
<h3 class="callout-title">The double-colon<a class="anchor" aria-label="anchor" href="#the-double-colon"></a>
</h3>
<div class="callout-content">
<p>The double-colon <code>::</code> in R let you call a specific
function from a package without loading the entire package into the
current environment.</p>
<p>For example, <code>dplyr::filter(data, condition)</code> uses
<code>filter()</code> from the <a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a> package.</p>
<p>This help us remember package functions and avoid namespace
conflicts.</p>
</div>
</div>
</div>
<p>The first step is to import the dataset following the guidelines
outlined in the <a href="read-cases.html">Read case data</a> episode.
This involves loading the dataset into our environment and view its
structure and content.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load packages</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="st">"rio"</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="st">"here"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Read data</span></span>
<span><span class="co"># e.g.: if path to file is data/simulated_ebola_2.csv then:</span></span>
<span><span class="va">raw_ebola_data</span> <span class="op">&lt;-</span> <span class="fu">rio</span><span class="fu">::</span><span class="fu">import</span><span class="op">(</span></span>
<span>  <span class="fu">here</span><span class="fu">::</span><span class="fu">here</span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"simulated_ebola_2.csv"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Return first five rows</span></span>
<span><span class="fu">utils</span><span class="fu">::</span><span class="fu">head</span><span class="op">(</span><span class="va">raw_ebola_data</span>, <span class="fl">5</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  V1 case id         age gender    status date onset date sample
1  1   14905          90      1 confirmed 03/15/2015  06/04/2015
2  2   13043 twenty-five      2            Sep /11/Y  03/01/2014
3  3   14364          54      f      &lt;NA&gt; 09/02/2014  03/03/2015
4  4   14675      ninety   &lt;NA&gt;           10/19/2014  31/ 12 /14
5  5   12648          74      F           08/06/2014  10/10/2016</code></pre>
</div>
</section><section id="a-quick-inspection"><h2 class="section-heading">A quick inspection<a class="anchor" aria-label="anchor" href="#a-quick-inspection"></a>
</h2>
<hr class="half-width">
<p>Quick exploration and inspection of the dataset are crucial before
diving into any analysis tasks. The <a href="https://epiverse-trace.github.io/cleanepi/" class="external-link">cleanepi</a> package
simplifies this process with the <code>scan_data()</code> function.
Let’s take a look at how you can use it:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="st">"cleanepi"</span><span class="op">)</span></span>
<span><span class="fu">cleanepi</span><span class="fu">::</span><span class="fu">scan_data</span><span class="op">(</span><span class="va">raw_ebola_data</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  Field_names  missing numeric     date character logical
1          V1 0.000000  1.0000 0.000000  0.000000       0
2     case id 0.000000  1.0000 0.000000  0.000000       0
3         age 0.064600  0.8348 0.000000  0.100600       0
4      gender 0.157867  0.0472 0.000000  0.794933       0
5      status 0.053533  0.0000 0.000000  0.946467       0
6  date onset 0.000067  0.0000 0.915733  0.084200       0
7 date sample 0.000133  0.0000 0.999867  0.000000       0</code></pre>
</div>
<p>The results provides an overview of the content of every column,
including column names, and the percent of some data types per column.
You can see that the column names in the dataset are descriptive but
lack consistency, as some they are composed of multiple words separated
by white spaces. Additionally, some columns contain more than one data
type, and there are missing values in others.</p>
</section><section id="common-operations"><h2 class="section-heading">Common operations<a class="anchor" aria-label="anchor" href="#common-operations"></a>
</h2>
<hr class="half-width">
<p>This section demonstrate how to perform some common data cleaning
operations using the <a href="https://epiverse-trace.github.io/cleanepi/" class="external-link">cleanepi</a> package.</p>
<div class="section level3">
<h3 id="standardizing-column-names">Standardizing column names<a class="anchor" aria-label="anchor" href="#standardizing-column-names"></a>
</h3>
<p>For this example dataset, standardizing column names typically
involves removing spaces and connecting different words with “_”. This
practice helps maintain consistency and readability in the dataset.
However, the function used for standardizing column names offers more
options. Type <code>?cleanepi::standardize_column_names</code> for more
details.</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim_ebola_data</span> <span class="op">&lt;-</span> <span class="fu">cleanepi</span><span class="fu">::</span><span class="fu">standardize_column_names</span><span class="op">(</span><span class="va">raw_ebola_data</span><span class="op">)</span></span>
<span><span class="fu">names</span><span class="op">(</span><span class="va">sim_ebola_data</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "v_1"         "case_id"     "age"         "gender"      "status"     
[6] "date_onset"  "date_sample"</code></pre>
</div>
<div id="discussion1" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge<a class="anchor" aria-label="anchor" href="#discussion1"></a>
</h3>
<div class="callout-content">
<ul>
<li>What differences you can observe in the column names?</li>
</ul>
</div>
</div>
</div>
<p>If you want to maintain certain column names without subjecting them
to the standardization process, you can utilize the <code>keep</code>
parameter of the <code>standardize_column_names()</code> function. This
parameter accepts a vector of column names that are intended to be kept
unchanged.</p>
<div id="discussion2" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge<a class="anchor" aria-label="anchor" href="#discussion2"></a>
</h3>
<div class="callout-content">
<p>Standardize the column names of the input dataset, but keep the “V1”
column as it is.</p>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="removing-irregularities">Removing irregularities<a class="anchor" aria-label="anchor" href="#removing-irregularities"></a>
</h3>
<p>Raw data may contain irregularities such as duplicated and empty rows
and columns, as well as constant columns. <code>remove_duplicates</code>
and <code>remove_constants</code> functions from <a href="https://epiverse-trace.github.io/cleanepi/" class="external-link">cleanepi</a>
remove such irregularities as demonstrated in the below code chunk.</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim_ebola_data</span> <span class="op">&lt;-</span> <span class="fu">cleanepi</span><span class="fu">::</span><span class="fu">remove_constants</span><span class="op">(</span><span class="va">sim_ebola_data</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: 'remove_constants' is not an exported object from 'namespace:cleanepi'</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim_ebola_data</span> <span class="op">&lt;-</span> <span class="fu">cleanepi</span><span class="fu">::</span><span class="fu">remove_duplicates</span><span class="op">(</span><span class="va">sim_ebola_data</span><span class="op">)</span></span></code></pre>
</div>
<p>Note that, our simulated Ebola does not contain duplicated nor
constant rows or columns.</p>
</div>
<div class="section level3">
<h3 id="replacing-missing-values">Replacing missing values<a class="anchor" aria-label="anchor" href="#replacing-missing-values"></a>
</h3>
<p>In addition to the regularities, raw data can contain missing values
that may be encoded by different strings, including the empty. To ensure
robust analysis, it is a good practice to replace all missing values by
<code>NA</code> in the entire dataset. Below is a code snippet
demonstrating how you can achieve this in <a href="https://epiverse-trace.github.io/cleanepi/" class="external-link">cleanepi</a>:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim_ebola_data</span> <span class="op">&lt;-</span> <span class="fu">cleanepi</span><span class="fu">::</span><span class="fu">replace_missing_values</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">sim_ebola_data</span>,</span>
<span>  na_strings <span class="op">=</span> <span class="st">""</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="validating-subject-ids">Validating subject IDs<a class="anchor" aria-label="anchor" href="#validating-subject-ids"></a>
</h3>
<p>Each entry in the dataset represents a subject and should be
distinguishable by a specific column formatted in a particular way, such
as falling within a specified range, containing certain prefixes and/or
suffixes, containing a specific number of characters. The
<a href="https://epiverse-trace.github.io/cleanepi/" class="external-link">cleanepi</a> package offers the
<code>check_subject_ids</code> function designed precisely for this task
as shown in the below code chunk. This function validates whether they
are unique and meet the required criteria.</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim_ebola_data</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">cleanepi</span><span class="fu">::</span><span class="fu">check_subject_ids</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">sim_ebola_data</span>,</span>
<span>    target_columns <span class="op">=</span> <span class="st">"case_id"</span>,</span>
<span>    range <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">15000</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Found 1957 duplicated rows. Please consult the report for more details.</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in parse_vector(x, col_number(), na = na, locale = locale, trim_ws = trim_ws): is.character(x) is not TRUE</code></pre>
</div>
<p>Note that our simulated dataset does contain duplicated subject
IDS.</p>
</div>
<div class="section level3">
<h3 id="standardizing-dates">Standardizing dates<a class="anchor" aria-label="anchor" href="#standardizing-dates"></a>
</h3>
<p>Certainly an epidemic dataset contains date columns for different
events, such as the date of infection, date of symptoms onset, ..etc,
and these dates can come in different date forms, and it good practice
to unify them. The <a href="https://epiverse-trace.github.io/cleanepi/" class="external-link">cleanepi</a> package provides
functionality for converting date columns in epidemic datasets into ISO
format, ensuring consistency across the different date columns. Here’s
how you can use it on our simulated dataset:</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim_ebola_data</span> <span class="op">&lt;-</span> <span class="fu">cleanepi</span><span class="fu">::</span><span class="fu">standardize_dates</span><span class="op">(</span></span>
<span>  <span class="va">sim_ebola_data</span>,</span>
<span>  target_columns <span class="op">=</span> <span class="fu">c</span><span class="op">(</span></span>
<span>    <span class="st">"date_onset"</span>,</span>
<span>    <span class="st">"date_sample"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">utils</span><span class="fu">::</span><span class="fu">head</span><span class="op">(</span><span class="va">sim_ebola_data</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  v_1 case_id         age gender    status date_onset date_sample
1   1   14905          90      1 confirmed 2015-03-15  2015-04-06
2   2   13043 twenty-five      2      &lt;NA&gt;       &lt;NA&gt;  2014-01-03
3   3   14364          54      f      &lt;NA&gt; 2014-02-09  2015-03-03
4   4   14675      ninety   &lt;NA&gt;      &lt;NA&gt; 2014-10-19  2014-12-31
5   5   12648          74      F      &lt;NA&gt; 2014-06-08  2016-10-10
6   6   14274 seventy-six female      &lt;NA&gt;       &lt;NA&gt;  2016-01-23</code></pre>
</div>
<p>This function coverts the values in the target columns, or will
automatically figure out the date columns within the dataset (if
<code>target_columns = NULL</code>) and convert them into the
<strong>Ymd</strong> format.</p>
</div>
<div class="section level3">
<h3 id="converting-to-numeric-values">Converting to numeric values<a class="anchor" aria-label="anchor" href="#converting-to-numeric-values"></a>
</h3>
<p>In the raw dataset, some column can come with mixture of character
and numerical values, and you want to covert the character values
explicitly into numeric. For example, in our simulated data set, in the
age column some entries are written in words. The
<code>convert_to_numeric()</code> function in <a href="https://epiverse-trace.github.io/cleanepi/" class="external-link">cleanepi</a>
does such conversion as illustrated in the below code chunk.</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim_ebola_data</span> <span class="op">&lt;-</span> <span class="fu">cleanepi</span><span class="fu">::</span><span class="fu">convert_to_numeric</span><span class="op">(</span><span class="va">sim_ebola_data</span>,</span>
<span>  target_columns <span class="op">=</span> <span class="st">"age"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu">utils</span><span class="fu">::</span><span class="fu">head</span><span class="op">(</span><span class="va">sim_ebola_data</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  v_1 case_id age gender    status date_onset date_sample
1   1   14905  90      1 confirmed 2015-03-15  2015-04-06
2   2   13043  25      2      &lt;NA&gt;       &lt;NA&gt;  2014-01-03
3   3   14364  54      f      &lt;NA&gt; 2014-02-09  2015-03-03
4   4   14675  90   &lt;NA&gt;      &lt;NA&gt; 2014-10-19  2014-12-31
5   5   12648  74      F      &lt;NA&gt; 2014-06-08  2016-10-10
6   6   14274  76 female      &lt;NA&gt;       &lt;NA&gt;  2016-01-23</code></pre>
</div>
</div>
</section><section id="epidemiology-related-operations"><h2 class="section-heading">Epidemiology related operations<a class="anchor" aria-label="anchor" href="#epidemiology-related-operations"></a>
</h2>
<hr class="half-width">
<p>In addition to common data cleansing tasks, such as those discussed
in the above section, the <a href="https://epiverse-trace.github.io/cleanepi/" class="external-link">cleanepi</a> package offers
additional functionalities tailored specifically for processing and
analyzing outbreak and epidemic data. This section covers some of these
specialized tasks.</p>
<div class="section level3">
<h3 id="checking-sequence-of-dated-events">Checking sequence of dated-events<a class="anchor" aria-label="anchor" href="#checking-sequence-of-dated-events"></a>
</h3>
<p>Ensuring the correct order and sequence of dated events is crucial in
epidemiological data analysis, especially when analyzing infectious
diseases where the timing of events like symptom onset and sample
collection is essential. The <a href="https://epiverse-trace.github.io/cleanepi/" class="external-link">cleanepi</a> package provides a
helpful function called <code>check_date_sequence()</code> precisely for
this purpose.</p>
<p>Here’s an example code chunk demonstrating the usage of
<code>check_date_sequence()</code> function in our simulated Ebola
dataset</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim_ebola_data</span> <span class="op">&lt;-</span> <span class="fu">cleanepi</span><span class="fu">::</span><span class="fu">check_date_sequence</span><span class="op">(</span></span>
<span> data <span class="op">=</span> <span class="va">sim_ebola_data</span>,</span>
<span> target_columns <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"date_onset"</span>, <span class="st">"date_sample"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<p>This functionality is crucial for ensuring data integrity and
accuracy in epidemiological analyses, as it helps identify any
inconsistencies or errors in the chronological order of events, allowing
yor to address them appropriately.</p>
</div>
<div class="section level3">
<h3 id="dictionary-based-substitution">Dictionary-based substitution<a class="anchor" aria-label="anchor" href="#dictionary-based-substitution"></a>
</h3>
<p>In the realm of data pre-processing, it’s common to encounter
scenarios where certain columns in a dataset, such as the “gender”
column in our simulated Ebola dataset, are expected to have specific
values or factors. However, it’s also common for unexpected or erroneous
values to appear in these columns, which need to be replaced with
appropriate values. The <a href="https://epiverse-trace.github.io/cleanepi/" class="external-link">cleanepi</a> package offers support
for dictionary-based substitution, a method that allows you to replace
values in specific columns based on mappings defined in a dictionary.
This approach ensures consistency and accuracy in data cleaning.</p>
<p>Moreover, <a href="https://epiverse-trace.github.io/cleanepi/" class="external-link">cleanepi</a> provides a built-in dictionary
specifically tailored for epidemiological data. The example dictionary
below includes mappings for the “gender” column.</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test_dict</span> <span class="op">&lt;-</span> <span class="fu">base</span><span class="fu">::</span><span class="fu">readRDS</span><span class="op">(</span></span>
<span>  <span class="fu">system.file</span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"test_dict.RDS"</span>, package <span class="op">=</span> <span class="st">"cleanepi"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu">base</span><span class="fu">::</span><span class="fu">print</span><span class="op">(</span><span class="va">test_dict</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  options values    grp orders
1       1   male gender      1
2       2 female gender      2
3       M   male gender      3
4       F female gender      4
5       m   male gender      5
6       f female gender      6</code></pre>
</div>
<p>Now, we can use this dictionary to standardize values of the the
“gender” column according to predefined categories. Below is an example
code chunk demonstrating how to utilize this functionality:</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim_ebola_data</span> <span class="op">&lt;-</span> <span class="fu">cleanepi</span><span class="fu">::</span><span class="fu">clean_using_dictionary</span><span class="op">(</span></span>
<span>  <span class="va">sim_ebola_data</span>,</span>
<span>  dictionary <span class="op">=</span> <span class="va">test_dict</span></span>
<span><span class="op">)</span></span>
<span><span class="fu">utils</span><span class="fu">::</span><span class="fu">head</span><span class="op">(</span><span class="va">sim_ebola_data</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  v_1 case_id age gender    status date_onset date_sample
1   1   14905  90   male confirmed 2015-03-15  2015-04-06
2   2   13043  25 female      &lt;NA&gt;       &lt;NA&gt;  2014-01-03
3   3   14364  54 female      &lt;NA&gt; 2014-02-09  2015-03-03
4   4   14675  90   &lt;NA&gt;      &lt;NA&gt; 2014-10-19  2014-12-31
5   5   12648  74 female      &lt;NA&gt; 2014-06-08  2016-10-10
6   6   14274  76 female      &lt;NA&gt;       &lt;NA&gt;  2016-01-23</code></pre>
</div>
<p>This approach simplifies the data cleaning process, ensuring that
categorical data in epidemiological datasets is accurately categorized
and ready for further analysis.</p>
<blockquote>
<p>Note that, when the column in the dataset contains values that are
not in the dictionary, the clean_using_dictionary() will raise an error.
Users can use the cleanepi::add_to_dictionary() function to include the
missing value into the dictionary. See the corresponding section in the
package <a href="https://epiverse-trace.github.io/cleanepi/articles/cleanepi.html" class="external-link">vignette</a>
for more details.</p>
</blockquote>
</div>
<div class="section level3">
<h3 id="calculating-time-span-between-different-date-events">Calculating time span between different date events<a class="anchor" aria-label="anchor" href="#calculating-time-span-between-different-date-events"></a>
</h3>
<p>In epidemiological data analysis it is also useful to track and
analyze time-dependent events, such as the progression of a disease
outbreak or the duration between sample collection and analysis. The
<a href="https://epiverse-trace.github.io/cleanepi/" class="external-link">cleanepi</a> package offers a convenient function for
calculating the time elapsed between two dated events at different time
scales. For example, the below code snippet utilizes the
<code>span()</code> function to compute the time elapsed since the date
of sample for the case identified until the date this document was
generated (2024-06-17).</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim_ebola_data</span> <span class="op">&lt;-</span> <span class="fu">cleanepi</span><span class="fu">::</span><span class="fu">timespan</span><span class="op">(</span></span>
<span>  <span class="va">sim_ebola_data</span>,</span>
<span>  target_column <span class="op">=</span> <span class="st">"date_sample"</span>,</span>
<span>  end_date <span class="op">=</span> <span class="fu">Sys.Date</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  span_unit <span class="op">=</span> <span class="st">"years"</span>,</span>
<span>  span_column_name <span class="op">=</span> <span class="st">"time_since_sampling_date"</span>,</span>
<span>  span_remainder_unit <span class="op">=</span> <span class="st">"months"</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: 'timespan' is not an exported object from 'namespace:cleanepi'</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">utils</span><span class="fu">::</span><span class="fu">head</span><span class="op">(</span><span class="va">sim_ebola_data</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  v_1 case_id age gender    status date_onset date_sample
1   1   14905  90   male confirmed 2015-03-15  2015-04-06
2   2   13043  25 female      &lt;NA&gt;       &lt;NA&gt;  2014-01-03
3   3   14364  54 female      &lt;NA&gt; 2014-02-09  2015-03-03
4   4   14675  90   &lt;NA&gt;      &lt;NA&gt; 2014-10-19  2014-12-31
5   5   12648  74 female      &lt;NA&gt; 2014-06-08  2016-10-10
6   6   14274  76 female      &lt;NA&gt;       &lt;NA&gt;  2016-01-23</code></pre>
</div>
<p>After executing the <code>span()</code> function, two new columns
named <code>time_since_sampling_date</code> and
<code>remainder_months</code> are added to the
<strong>sim_ebola_data</strong> dataset, containing the calculated time
elapsed since the date of sampling for each case, measured in years, and
the remaining time measured in months.</p>
</div>
</section><section id="multiple-operations-at-once"><h2 class="section-heading">Multiple operations at once<a class="anchor" aria-label="anchor" href="#multiple-operations-at-once"></a>
</h2>
<hr class="half-width">
<p>Performing data cleaning operations individually can be
time-consuming and error-prone. The <a href="https://epiverse-trace.github.io/cleanepi/" class="external-link">cleanepi</a> package
simplifies this process by offering a convenient wrapper function called
<code>clean_data()</code>, which allows you to perform multiple
operations at once.</p>
<p>The <code>clean_data()</code> function applies a series of predefined
data cleaning operations to the input dataset. Here’s an example code
chunk illustrating how to use <code>clean_data()</code> on a raw
simulated Ebola dataset:</p>
<p>Further more, you can combine multiple data cleaning tasks via the
pipe operator in “|&gt;”, as shown in the below code snippet.</p>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># PERFORM THE OPERATIONS USING THE pipe SYNTAX</span></span>
<span><span class="va">cleaned_data</span> <span class="op">&lt;-</span> <span class="va">raw_ebola_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">cleanepi</span><span class="fu">::</span><span class="fu">standardize_column_names</span><span class="op">(</span>keep <span class="op">=</span> <span class="st">"V1"</span>, rename <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">cleanepi</span><span class="fu">::</span><span class="fu">replace_missing_values</span><span class="op">(</span>na_strings <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">cleanepi</span><span class="fu">::</span><span class="fu">remove_constants</span><span class="op">(</span>cutoff <span class="op">=</span> <span class="fl">1.0</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">cleanepi</span><span class="fu">::</span><span class="fu">remove_duplicates</span><span class="op">(</span>target_columns <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">cleanepi</span><span class="fu">::</span><span class="fu">standardize_dates</span><span class="op">(</span></span>
<span>    target_columns <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"date_onset"</span>, <span class="st">"date_sample"</span><span class="op">)</span>,</span>
<span>    error_tolerance <span class="op">=</span> <span class="fl">0.4</span>,</span>
<span>    format <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    timeframe <span class="op">=</span> <span class="cn">NULL</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">cleanepi</span><span class="fu">::</span><span class="fu">check_subject_ids</span><span class="op">(</span></span>
<span>    target_columns <span class="op">=</span> <span class="st">"case_id"</span>,</span>
<span>    range <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">15000</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">cleanepi</span><span class="fu">::</span><span class="fu">convert_to_numeric</span><span class="op">(</span>target_columns <span class="op">=</span> <span class="st">"age"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">cleanepi</span><span class="fu">::</span><span class="fu">clean_using_dictionary</span><span class="op">(</span>dictionary <span class="op">=</span> <span class="va">test_dict</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: 'remove_constants' is not an exported object from 'namespace:cleanepi'</code></pre>
</div>
</section><section id="printing-the-clean-report"><h2 class="section-heading">Printing the clean report<a class="anchor" aria-label="anchor" href="#printing-the-clean-report"></a>
</h2>
<hr class="half-width">
<p>The <a href="https://epiverse-trace.github.io/cleanepi/" class="external-link">cleanepi</a> package generates a comprehensive report
detailing the findings and actions of all data cleansing operations
conducted during the analysis. This report is presented as a webpage
with multiple sections. Each section corresponds to a specific data
cleansing operation, and clicking on each section allows you to access
the results of that particular operation. This interactive approach
enables users to efficiently review and analyze the outcomes of
individual cleansing steps within the broader data cleansing
process.</p>
<p>You can view the report using <code>cleanepi::print_report()</code>
function.</p>
<figure><img src="../fig/report_demo.png" alt="Example of data cleaning report generated by {cleanepi}" class="figure mx-auto d-block"><div class="figcaption">Example of data cleaning report generated by
<a href="https://epiverse-trace.github.io/cleanepi/" class="external-link">cleanepi</a>
</div>
</figure></section><section id="validating-and-tagging-case-data"><h2 class="section-heading">Validating and tagging case data<a class="anchor" aria-label="anchor" href="#validating-and-tagging-case-data"></a>
</h2>
<hr class="half-width">
<p>In outbreak analysis, once you have completed the initial steps of
reading and cleaning the case data, it’s essential to establish an
additional foundational layer to ensure the integrity and reliability of
subsequent analyses. Specifically, this involves verifying the presence
and correct data type of certain input columns within your dataset, a
process commonly referred to as “tagging.” Additionally, it’s crucial to
implement measures to validate that these tagged columns are not
inadvertently deleted during further data processing steps.</p>
<p>This is achieved by converting the cleaned case data into a
<code>linelist</code> object using <a href="https://epiverse-trace.github.io/linelist/" class="external-link">linelist</a> package, see
the below code chunk.</p>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="st">"linelist"</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">linelist</span><span class="fu">::</span><span class="fu">make_linelist</span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">cleaned_data</span>,</span>
<span>  id <span class="op">=</span> <span class="st">"case_id"</span>,</span>
<span>  age <span class="op">=</span> <span class="st">"age"</span>,</span>
<span>  date_onset <span class="op">=</span> <span class="st">"date_onset"</span>,</span>
<span>  date_reporting <span class="op">=</span> <span class="st">"date_sample"</span>,</span>
<span>  gender <span class="op">=</span> <span class="st">"gender"</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'cleaned_data' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">utils</span><span class="fu">::</span><span class="fu">head</span><span class="op">(</span><span class="va">data</span>, <span class="fl">7</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>                                                                            
1 function (..., list = character(), package = NULL, lib.loc = NULL,        
2     verbose = getOption("verbose"), envir = .GlobalEnv, overwrite = TRUE) 
3 {                                                                         
4     fileExt &lt;- function(x) {                                              
5         db &lt;- grepl("\\\\.[^.]+\\\\.(gz|bz2|xz)$", x)                     
6         ans &lt;- sub(".*\\\\.", "", x)                                      
7         ans[db] &lt;- sub(".*\\\\.([^.]+\\\\.)(gz|bz2|xz)$", "\\\\1\\\\2",   </code></pre>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Use <a href="https://epiverse-trace.github.io/cleanepi/" class="external-link">cleanepi</a> package to clean and standardize
epidemic and outbreak data</li>
<li>Use <a href="https://epiverse-trace.github.io/linelist/" class="external-link">linelist</a> to tagg, validate, and prepare case data
for downstream analysis.</li>
</ul>
</div>
</div>
</div>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</section></section><section id="aio-describe-cases"><p>Content from <a href="describe-cases.html">Aggregate and visualize</a></p>
<hr>
<p>Last updated on 2024-06-17 |
        
        <a href="https://github.com/epiverse-trace/tutorials-early/edit/main/episodes/describe-cases.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 30 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How to aggregate case data?</li>
<li>How to visualize aggregated data?</li>
<li>What is distribution of cases in time, place, gender, age?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Simulate synthetic outbreak data</li>
<li>Convert linelist data to incidence</li>
<li>Create epidemic curves from incidence data</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="introduction"><h2 class="section-heading">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>In an analytic pipeline, exploratory data analysis (EDA) is an
important step before formal modelling. EDA helps determine
relationships between variables and summarize their main characteristics
often by means of data visualization.</p>
<p>This episode focuses on EDA of outbreaks and epidemic data, and how
to achieved that using a couples of handy <code>R</code> packages. A key
observation in EDA of epidemic analysis is capturing the relationship
between time and the number of reported cases, spanning various
categories (confirmed, hospitalized, deaths, and recoveries), locations,
and other demographic factors such as gender, age, etc.</p>
<p>::::::::::::::::::: checklist</p>
<div class="section level3">
<h3 id="the-double-colon">The double-colon<a class="anchor" aria-label="anchor" href="#the-double-colon"></a>
</h3>
<p>The double-colon <code>::</code> in R let you call a specific
function from a package without loading the entire package into the
current environment.</p>
<p>For example, <code>dplyr::filter(data, condition)</code> uses
<code>filter()</code> from the <a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a> package.</p>
<p>This help us remember package functions and avoid namespace
conflicts.</p>
<p>:::::::::::::::::::</p>
</div>
</section><section id="synthetic-outbreak-data"><h2 class="section-heading">Synthetic outbreak data<a class="anchor" aria-label="anchor" href="#synthetic-outbreak-data"></a>
</h2>
<hr class="half-width">
<p>To illustrate the process of conducting EDA on outbreak data, we will
generate a line list for a hypothetical Ebola outbreak utilizing the
<code>{simulist}</code> package. This line list dataset offers
individual-level information about the outbreak. For our simulation, we
will assume that the dynamics of this outbreak are influenced by several
factors: the contact distribution (average number of contacts for an
infected case), distribution of contact intervals (time period between
contacts), and the delay distributions of onset to hospitalization and
onset to death. These latter distributions can be sourced from
literature and are conveniently available in the
<code>{epiparameter}</code> package, see the below code chunk.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load simulist and epiparameter packages</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="st">"simulist"</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="st">"epiparameter"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define contact distribution</span></span>
<span><span class="va">contact_dist</span> <span class="op">&lt;-</span> <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">epidist</span><span class="op">(</span></span>
<span>  disease <span class="op">=</span> <span class="st">"Ebola"</span>,</span>
<span>  epi_dist <span class="op">=</span> <span class="st">"contact distribution"</span>,</span>
<span>  prob_distribution <span class="op">=</span> <span class="st">"pois"</span>,</span>
<span>  prob_distribution_params <span class="op">=</span> <span class="fu">c</span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define  distribution for interval between contact</span></span>
<span><span class="va">cont_interval</span> <span class="op">&lt;-</span> <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">epidist</span><span class="op">(</span></span>
<span>  disease <span class="op">=</span> <span class="st">"Ebola"</span>,</span>
<span>  epi_dist <span class="op">=</span> <span class="st">"contact interval"</span>,</span>
<span>  prob_distribution <span class="op">=</span> <span class="st">"gamma"</span>,</span>
<span>  prob_distribution_params <span class="op">=</span> <span class="fu">c</span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">1</span>, scale <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define onset to hospitalized distribution</span></span>
<span><span class="va">onset_to_hosp</span> <span class="op">&lt;-</span> <span class="va">contact_dist</span> <span class="op">&lt;-</span> <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">epidist</span><span class="op">(</span></span>
<span>  disease <span class="op">=</span> <span class="st">"Ebola"</span>,</span>
<span>  epi_dist <span class="op">=</span> <span class="st">"onset to hospitalisatio"</span>,</span>
<span>  prob_distribution <span class="op">=</span> <span class="st">"pois"</span>,</span>
<span>  prob_distribution_params <span class="op">=</span> <span class="fu">c</span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">7</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># get onset to death from {epiparameter} database</span></span>
<span><span class="va">onset_to_death</span> <span class="op">&lt;-</span> <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">epidist_db</span><span class="op">(</span></span>
<span>  disease <span class="op">=</span> <span class="st">"Ebola"</span>,</span>
<span>  epi_dist <span class="op">=</span> <span class="st">"onset to death"</span>,</span>
<span>  single_epidist <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define distribution for infectious period</span></span>
<span><span class="va">infect_period</span> <span class="op">&lt;-</span> <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">epidist</span><span class="op">(</span></span>
<span>  disease <span class="op">=</span> <span class="st">"Ebola"</span>,</span>
<span>  epi_dist <span class="op">=</span> <span class="st">"Infectious period"</span>,</span>
<span>  prob_distribution <span class="op">=</span> <span class="st">"gamma"</span>,</span>
<span>  prob_distribution_params <span class="op">=</span> <span class="fu">c</span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">1</span>, scale <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<p>Additionally, we assume that the outbreak started at the beginning of
2023, is highly contagious with a probability of infection of <span class="math inline">\(80\%\)</span>, and its minimum and maximum sizes
are 1000 and 10,000, respectively. Combining these assumptions with the
mentioned distributions, the code chunk below generates a simulated line
list:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set seed to 1 to  have the same results</span></span>
<span><span class="fu">base</span><span class="fu">::</span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate simulation data using the defined distribution.</span></span>
<span><span class="va">linelist</span> <span class="op">&lt;-</span> <span class="fu">simulist</span><span class="fu">::</span><span class="fu">sim_linelist</span><span class="op">(</span></span>
<span>  <span class="va">contact_dist</span>,</span>
<span>  <span class="va">infect_period</span>,</span>
<span>  prob_infect <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span>  <span class="va">onset_to_hosp</span>,</span>
<span>  <span class="va">onset_to_death</span>,</span>
<span>  hosp_risk <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  hosp_death_risk <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  non_hosp_death_risk <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  outbreak_start_date <span class="op">=</span> <span class="fu">as.Date</span><span class="op">(</span><span class="st">"2023-01-01"</span><span class="op">)</span>,</span>
<span>  outbreak_size <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">10000</span><span class="op">)</span>,</span>
<span>  population_age <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">90</span><span class="op">)</span>,</span>
<span>  case_type_probs <span class="op">=</span> <span class="fu">c</span><span class="op">(</span>suspected <span class="op">=</span> <span class="fl">0.2</span>, probable <span class="op">=</span> <span class="fl">0.1</span>, confirmed <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span>,</span>
<span>  config <span class="op">=</span> <span class="fu">simulist</span><span class="fu">::</span><span class="fu">create_config</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View first few rows of the generated data</span></span>
<span><span class="fu">utils</span><span class="fu">::</span><span class="fu">head</span><span class="op">(</span><span class="va">linelist</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  id                  case_name case_type sex age date_onset date_admission
1  1           Keegan Hardy-Roy confirmed   m   3 2023-01-01           &lt;NA&gt;
2  6    Alexandria Torres-Perez  probable   f  13 2023-01-01           &lt;NA&gt;
3  7          Mitchell Reinhart confirmed   m  74 2023-01-01     2023-01-08
4  9 Stephanie Loadman-Copeland confirmed   f  65 2023-01-01     2023-01-10
5 10           Sufyaan al-Irani confirmed   m   8 2023-01-02           &lt;NA&gt;
6 11               Rohan Nguyen confirmed   m  27 2023-01-01           &lt;NA&gt;
  date_death date_first_contact date_last_contact ct_value
1       &lt;NA&gt;               &lt;NA&gt;              &lt;NA&gt;     24.9
2       &lt;NA&gt;         2022-12-30        2023-01-02       NA
3       &lt;NA&gt;         2022-12-31        2023-01-04     24.9
4       &lt;NA&gt;         2023-01-03        2023-01-04     24.9
5       &lt;NA&gt;         2022-12-31        2023-01-02     24.9
6       &lt;NA&gt;         2023-01-01        2023-01-05     24.9</code></pre>
</div>
</section><section id="aggregating"><h2 class="section-heading">Aggregating<a class="anchor" aria-label="anchor" href="#aggregating"></a>
</h2>
<hr class="half-width">
<p>Downstream analysis involves working with aggregated data rather than
individual cases. This requires grouping linelist data in the form of
incidence data. The <a href="(https://www.reconverse.org/incidence2/articles/incidence2.html)%7B.external%20target=%22_blank%22%7D" class="external-link">incidence2</a>
package offers an essential function, called <code>incidence</code>, for
grouping case data, usually centered around dated events and/or other
factors. The code chunk provided below demonstrates the creation of an
<code>incidence2</code> object from the simulated Ebola
<code>linelist</code> data based on the date of onset.</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load incidence2 package</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="st">"incidence2"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create incidence object by aggregating case data  based on the date of onset</span></span>
<span><span class="va">dialy_incidence_data</span> <span class="op">&lt;-</span> <span class="fu">incidence2</span><span class="fu">::</span><span class="fu">incidence</span><span class="op">(</span></span>
<span>  <span class="va">linelist</span>,</span>
<span>  date_index <span class="op">=</span> <span class="st">"date_onset"</span>,</span>
<span>  interval <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View the first incidence data for the first 5 days</span></span>
<span><span class="fu">utils</span><span class="fu">::</span><span class="fu">head</span><span class="op">(</span><span class="va">dialy_incidence_data</span>, <span class="fl">5</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># incidence:  5 x 3
# count vars: date_onset
  date_index count_variable count
* &lt;period&gt;   &lt;chr&gt;          &lt;int&gt;
1 2023-01-01 date_onset       475
2 2023-01-02 date_onset      4904
3 2023-01-03 date_onset      5478
4 2023-01-04 date_onset      5319
5 2023-01-05 date_onset      3520</code></pre>
</div>
<p>Furthermore, with the <a href="https://www.reconverse.org/incidence2/" class="external-link">incidence2</a> package, you can
specify the desired interval and categorize cases by one or more
factors. Below is a code snippet demonstrating weekly cases grouped by
the date of onset and gender.</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Grouping data by week</span></span>
<span><span class="va">weekly_incidence_data</span> <span class="op">&lt;-</span> <span class="fu">incidence2</span><span class="fu">::</span><span class="fu">incidence</span><span class="op">(</span></span>
<span>  <span class="va">linelist</span>,</span>
<span>  date_index <span class="op">=</span> <span class="st">"date_onset"</span>,</span>
<span>  interval <span class="op">=</span> <span class="fl">7</span>,</span>
<span>  groups <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"sex"</span>, <span class="st">"case_type"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View incidence data for the first 5 weeks</span></span>
<span><span class="fu">utils</span><span class="fu">::</span><span class="fu">head</span><span class="op">(</span><span class="va">weekly_incidence_data</span>, <span class="fl">5</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># incidence:  5 x 5
# count vars: date_onset
# groups:     sex, case_type
  date_index               sex   case_type count_variable count
* &lt;period&gt;                 &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt;          &lt;int&gt;
1 2022-12-29 to 2023-01-04 f     confirmed date_onset      5576
2 2022-12-29 to 2023-01-04 f     probable  date_onset       766
3 2022-12-29 to 2023-01-04 f     suspected date_onset      1612
4 2022-12-29 to 2023-01-04 m     confirmed date_onset      5760
5 2022-12-29 to 2023-01-04 m     probable  date_onset       787</code></pre>
</div>
<div id="notes" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="notes" class="callout-inner">
<h3 class="callout-title">Notes<a class="anchor" aria-label="anchor" href="#notes"></a>
</h3>
<div class="callout-content">
<p>When cases are grouped by different factors, it’s possible that these
groups may have different date ranges in the resulting
<code>incidence2</code> object. The <code>incidence2</code> package
provides a function called <code>complete_dates()</code> to ensure that
an incidence object has the same range of dates for each group. By
default, missing counts will be filled with 0.</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create incidence object</span></span>
<span><span class="va">dialy_incidence_data_2</span> <span class="op">&lt;-</span> <span class="fu">incidence2</span><span class="fu">::</span><span class="fu">incidence</span><span class="op">(</span></span>
<span>  <span class="va">linelist</span>,</span>
<span>  date_index <span class="op">=</span> <span class="st">"date_onset"</span>,</span>
<span>  groups <span class="op">=</span> <span class="st">"sex"</span>,</span>
<span>  interval <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Complete missing dates in the incidence object</span></span>
<span><span class="fu">incidence2</span><span class="fu">::</span><span class="fu">complete_dates</span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">dialy_incidence_data_2</span>,</span>
<span>  expand <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  fill <span class="op">=</span> <span class="fl">0L</span>, by <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  allow_POSIXct <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># incidence:  24 x 4
# count vars: date_onset
# groups:     sex
   date_index sex   count_variable count
   &lt;period&gt;   &lt;chr&gt; &lt;chr&gt;          &lt;int&gt;
 1 2023-01-01 f     date_onset       242
 2 2023-01-01 m     date_onset       233
 3 2023-01-02 f     date_onset      2403
 4 2023-01-02 m     date_onset      2501
 5 2023-01-03 f     date_onset      2709
 6 2023-01-03 m     date_onset      2769
 7 2023-01-04 f     date_onset      2600
 8 2023-01-04 m     date_onset      2719
 9 2023-01-05 f     date_onset      1763
10 2023-01-05 m     date_onset      1757
# ℹ 14 more rows</code></pre>
</div>
</div>
</div>
</div>
</section><section id="visualization"><h2 class="section-heading">Visualization<a class="anchor" aria-label="anchor" href="#visualization"></a>
</h2>
<hr class="half-width">
<p>“The <code>incidence2</code> object can be visualized using the
<code>plot()</code> function from the base R package. The resulting
graph is referred to as an epidemic curve, or epi-curve for short. The
following code snippets generate epi-curves for the
<code>dialy_incidence_data</code> and <code>weekly_incidence_data</code>
incidence objects mentioned above.”</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load ggplot2 and tracetheme packages</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="st">"ggplot2"</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="st">"tracetheme"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot daily incidence data</span></span>
<span><span class="fu">base</span><span class="fu">::</span><span class="fu">plot</span><span class="op">(</span><span class="va">dialy_incidence_data</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Time (in days)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Dialy cases"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">tracetheme</span><span class="fu">::</span><span class="fu">theme_trace</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/describe-cases-rendered-unnamed-chunk-6-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot weekly incidence data</span></span>
<span></span>
<span><span class="fu">base</span><span class="fu">::</span><span class="fu">plot</span><span class="op">(</span><span class="va">weekly_incidence_data</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Time (in days)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"weekly cases"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">tracetheme</span><span class="fu">::</span><span class="fu">theme_trace</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/describe-cases-rendered-unnamed-chunk-7-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="challenge-1-can-you-do-it" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-1-can-you-do-it" class="callout-inner">
<h3 class="callout-title">Challenge 1: Can you do it?<a class="anchor" aria-label="anchor" href="#challenge-1-can-you-do-it"></a>
</h3>
<div class="callout-content">
<ul>
<li>Using suitable distributions for contacts, contact interval,
infectious period, onset to hospitalized, and onset to death, generate a
simulated linelist data for Marburg outbreak that has the probability of
<span class="math inline">\(0.5\)</span> infection?</li>
<li>Aggregate the generated linelist and produce some epidemic
curves?</li>
</ul>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Use <code>{simulist}</code> package to generate synthetic outbreak
data</li>
<li>Use <a href="https://www.reconverse.org/incidence2/" class="external-link">incidence2</a> package to aggregate case data based
on a date event, and produce epidemic curves.</li>
</ul>
</div>
</div>
</div>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</section></section><section id="aio-simple-analysis"><p>Content from <a href="simple-analysis.html">Simple analysis</a></p>
<hr>
<p>Last updated on 2024-06-17 |
        
        <a href="https://github.com/epiverse-trace/tutorials-early/edit/main/episodes/simple-analysis.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 30 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What is the growth rate of the epidemic?</li>
<li>How to identify the peak time of an outbreak?</li>
<li>How to compute moving average of cases?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Perform an early analysis of outbreak data</li>
<li>Identify trends, exponential, doubling, and peak time</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="introduction"><h2 class="section-heading">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>Understanding the trend in case data is crucial for various purposes,
such as forecasting future case counts, implementing public health
interventions, and assessing the effectiveness of control measures. By
analyzing the trend, policymakers and public health experts can make
informed decisions to mitigate the spread of diseases and protect public
health. This episode focuses on how to perform a simple early analysis
on incidence data. It uses the same dataset of <strong>Covid-19 case
data from England</strong> that utilized it in <a href="describe-cases.html">Aggregate and visualize</a> episode.</p>
<div id="the-double-colon" class="callout checklist">
<div class="callout-square">
<i class="callout-icon" data-feather="check-square"></i>
</div>
<div id="the-double-colon" class="callout-inner">
<h3 class="callout-title">The double-colon<a class="anchor" aria-label="anchor" href="#the-double-colon"></a>
</h3>
<div class="callout-content">
<p>The double-colon <code>::</code> in R let you call a specific
function from a package without loading the entire package into the
current environment.</p>
<p>For example, <code>dplyr::filter(data, condition)</code> uses
<code>filter()</code> from the <a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a> package.</p>
<p>This help us remember package functions and avoid namespace
conflicts.</p>
</div>
</div>
</div>
</section><section id="simple-model"><h2 class="section-heading">Simple model<a class="anchor" aria-label="anchor" href="#simple-model"></a>
</h2>
<hr class="half-width">
<p>Aggregated case data over a specific time unit, or incidence data,
typically represent the number of cases occurring within that time
frame. These data can often be assumed to follow either
<code>Poisson distribution</code> or a
<code>negative binomial (NB) distribution</code>, depending on the
specific characteristics of the data and the underlying processes
generating them. When analyzing such data, one common approach is to
examine the trend over time by computing the rate of change, which can
indicate whether there is exponential growth or decay in the number of
cases. Exponential growth implies that the number of cases is increasing
at an accelerating rate over time, while exponential decay suggests that
the number of cases is decreasing at a decelerating rate.</p>
<p>The <code>i2extras</code> package provides methods for modelling the
trend in case data, calculating moving averages, and exponential growth
or decay rate. The code chunk below computes the Covid-19 trend in UK
within first 3 months using negative binomial distribution.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load packages which provides methods for modeling</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="st">"i2extras"</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="st">"incidence2"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># read data from {outbreaks} package</span></span>
<span><span class="va">covid19_eng_case_data</span> <span class="op">&lt;-</span> <span class="fu">outbreaks</span><span class="fu">::</span><span class="va">covid19_england_nhscalls_2020</span></span>
<span></span>
<span><span class="co"># subset the covid19_eng_case_data to include only the first 3 months of data</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">base</span><span class="fu">::</span><span class="fu">subset</span><span class="op">(</span></span>
<span>  <span class="va">covid19_eng_case_data</span>,</span>
<span>  <span class="va">covid19_eng_case_data</span><span class="op">$</span><span class="va">date</span> <span class="op">&lt;=</span> <span class="fu">min</span><span class="op">(</span><span class="va">covid19_eng_case_data</span><span class="op">$</span><span class="va">date</span><span class="op">)</span> <span class="op">+</span> <span class="fl">90</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># uses the incidence function from the incidence2 package to compute the</span></span>
<span><span class="co"># incidence data</span></span>
<span><span class="va">df_incid</span> <span class="op">&lt;-</span> <span class="fu">incidence2</span><span class="fu">::</span><span class="fu">incidence</span><span class="op">(</span></span>
<span>  <span class="va">df</span>,</span>
<span>  date_index <span class="op">=</span> <span class="st">"date"</span>,</span>
<span>  groups <span class="op">=</span> <span class="st">"sex"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># fit a curve to the incidence data. The model chosen is the negative binomial</span></span>
<span><span class="co"># distribution with a significance level (alpha) of 0.05.</span></span>
<span><span class="va">fitted_curve_nb</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">i2extras</span><span class="fu">::</span><span class="fu">fit_curve</span><span class="op">(</span></span>
<span>    <span class="va">df_incid</span>,</span>
<span>    model <span class="op">=</span> <span class="st">"negbin"</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">0.05</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># plot fitted curve</span></span>
<span><span class="fu">base</span><span class="fu">::</span><span class="fu">plot</span><span class="op">(</span><span class="va">fitted_curve_nb</span>, angle <span class="op">=</span> <span class="fl">45</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Date"</span>, y <span class="op">=</span> <span class="st">"Cases"</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/simple-analysis-rendered-unnamed-chunk-1-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="challenge-1-poission-distribution" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-1-poission-distribution" class="callout-inner">
<h3 class="callout-title">Challenge 1: Poission distribution<a class="anchor" aria-label="anchor" href="#challenge-1-poission-distribution"></a>
</h3>
<div class="callout-content">
<p>Repeat the above analysis using Poisson distribution?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Show me the solution</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fitted_curve_poisson</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">i2extras</span><span class="fu">::</span><span class="fu">fit_curve</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">df_incid</span>,</span>
<span>    model <span class="op">=</span> <span class="st">"poisson"</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">0.05</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu">base</span><span class="fu">::</span><span class="fu">plot</span><span class="op">(</span><span class="va">fitted_curve_poisson</span>, angle <span class="op">=</span> <span class="fl">45</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Date"</span>, y <span class="op">=</span> <span class="st">"Cases"</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/simple-analysis-rendered-unnamed-chunk-2-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
</section><section id="exponential-growth-or-decay-rate"><h2 class="section-heading">Exponential growth or decay rate<a class="anchor" aria-label="anchor" href="#exponential-growth-or-decay-rate"></a>
</h2>
<hr class="half-width">
<p>The exponential growth or decay rate, denoted as <span class="math inline">\(r\)</span>, serves as an indicator for the trend
in cases, indicating whether they are increasing (growth) or decreasing
(decay) on an exponential scale. This rate is computed using the
so-called <strong>renewal equation</strong> <a href="https://royalsocietypublishing.org/doi/10.1098/rspb.2006.3754" class="external-link">(Wallinga
et al. 2006)</a>, which mechanistically links the reproductive number
<span class="math inline">\(R\)</span> of new cases to the generation
interval of the disease. This computational method is implemented in the
<a href="https://www.reconverse.org/i2extras/" class="external-link">i2extras</a> package.</p>
<p>Below is a code snippet demonstrating how to extract the growth/decay
rate from the above <strong>NB</strong>-fitted curve using the
<code>growth_rate()</code> function:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rates_nb</span> <span class="op">&lt;-</span> <span class="fu">i2extras</span><span class="fu">::</span><span class="fu">growth_rate</span><span class="op">(</span><span class="va">fitted_curve_nb</span><span class="op">)</span></span>
<span><span class="va">rates_nb</span> <span class="op">&lt;-</span> <span class="fu">base</span><span class="fu">::</span><span class="fu">as.data.frame</span><span class="op">(</span><span class="va">rates_nb</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">subset</span><span class="op">(</span>select <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="va">sex</span>, <span class="va">r</span>, <span class="va">r_lower</span>, <span class="va">r_upper</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">base</span><span class="fu">::</span><span class="fu">print</span><span class="op">(</span><span class="va">rates_nb</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>      sex            r      r_lower      r_upper
1  female -0.008241228 -0.009182635 -0.007300403
2    male -0.008346783 -0.009316775 -0.007377392
3 unknown -0.023703987 -0.028179436 -0.019299926</code></pre>
</div>
<div id="challenge-2-growth-rates-from-a-poisson-fitted-curve" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-2-growth-rates-from-a-poisson-fitted-curve" class="callout-inner">
<h3 class="callout-title">Challenge 2: Growth rates from a<strong>Poisson</strong>-fitted curve<a class="anchor" aria-label="anchor" href="#challenge-2-growth-rates-from-a-poisson-fitted-curve"></a>
</h3>
<div class="callout-content">
<p>Extract growth rates from the <strong>Poisson</strong>-fitted curve
of <strong>Challenge 1</strong>?</p>
</div>
</div>
</div>
</section><section id="peak-time"><h2 class="section-heading">Peak time<a class="anchor" aria-label="anchor" href="#peak-time"></a>
</h2>
<hr class="half-width">
<p>The <strong>Peak time </strong> is the time at which the highest
number of cases is observed in the aggregated data. It can be estimated
using the <code>i2extras::estimate_peak()</code> function as shown in
the below code chunk, which identify peak time from the
<code>incidenc2</code> object <code>df_incid</code>.</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">peaks_nb</span> <span class="op">&lt;-</span> <span class="fu">i2extras</span><span class="fu">::</span><span class="fu">estimate_peak</span><span class="op">(</span><span class="va">df_incid</span>, progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">subset</span><span class="op">(</span>select <span class="op">=</span> <span class="op">-</span><span class="fu">c</span><span class="op">(</span><span class="va">count_variable</span>, <span class="va">bootstrap_peaks</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">base</span><span class="fu">::</span><span class="fu">print</span><span class="op">(</span><span class="va">peaks_nb</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A data frame: 3 × 6
  sex     observed_peak observed_count lower_ci   median     upper_ci  
* &lt;chr&gt;   &lt;date&gt;                 &lt;int&gt; &lt;date&gt;     &lt;date&gt;     &lt;date&gt;    
1 female  2020-03-26              1314 2020-03-18 2020-03-23 2020-03-31
2 male    2020-03-27              1299 2020-03-19 2020-03-26 2020-03-30
3 unknown 2020-04-10                32 2020-03-24 2020-04-07 2020-04-20</code></pre>
</div>
</section><section id="moving-average"><h2 class="section-heading">Moving average<a class="anchor" aria-label="anchor" href="#moving-average"></a>
</h2>
<hr class="half-width">
<p>A moving or rolling average calculates the average number of cases
within a specified time period. This can be achieved by utilizing the
<code>add_rolling_average()</code> function from the
<a href="https://www.reconverse.org/i2extras/" class="external-link">i2extras</a> package on an <code>incidence2 object</code>.
The following code chunk demonstrates the computation of the weekly
average number of cases from the <code>incidence2</code> object
<code>df_incid</code>, followed by visualization.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="st">"ggplot2"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">moving_Avg_week</span> <span class="op">&lt;-</span> <span class="fu">i2extras</span><span class="fu">::</span><span class="fu">add_rolling_average</span><span class="op">(</span><span class="va">df_incid</span>, n <span class="op">=</span> <span class="fl">7L</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">base</span><span class="fu">::</span><span class="fu">plot</span><span class="op">(</span><span class="va">moving_Avg_week</span>, border_colour <span class="op">=</span> <span class="st">"white"</span>, angle <span class="op">=</span> <span class="fl">45</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">geom_line</span><span class="op">(</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">aes</span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">date_index</span>,</span>
<span>      y <span class="op">=</span> <span class="va">rolling_average</span>,</span>
<span>      color <span class="op">=</span> <span class="st">"red"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Date"</span>, y <span class="op">=</span> <span class="st">"Cases"</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/simple-analysis-rendered-unnamed-chunk-5-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="challenge-3-monthly-moving-average" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-3-monthly-moving-average" class="callout-inner">
<h3 class="callout-title">Challenge 3: Monthly moving average<a class="anchor" aria-label="anchor" href="#challenge-3-monthly-moving-average"></a>
</h3>
<div class="callout-content">
<p>Compute and visualize the monthly moving average of cases on
<code>df_incid</code>?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">Show me the solution</h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">moving_Avg_mont</span> <span class="op">&lt;-</span> <span class="fu">i2extras</span><span class="fu">::</span><span class="fu">add_rolling_average</span><span class="op">(</span><span class="va">df_incid</span>, n <span class="op">=</span> <span class="fl">30L</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">base</span><span class="fu">::</span><span class="fu">plot</span><span class="op">(</span></span>
<span>  <span class="va">moving_Avg_mont</span>,</span>
<span>  border_colour <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>  angle <span class="op">=</span> <span class="fl">45</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">geom_line</span><span class="op">(</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">aes</span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">date_index</span>,</span>
<span>      y <span class="op">=</span> <span class="va">rolling_average</span>,</span>
<span>      color <span class="op">=</span> <span class="st">"red"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Date"</span>, y <span class="op">=</span> <span class="st">"Cases"</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/simple-analysis-rendered-unnamed-chunk-6-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Use <a href="https://www.reconverse.org/i2extras/" class="external-link">i2extras</a> to:
<ul>
<li>fit epi-curve using either <strong>Poisson</strong> or
<strong>NB</strong> distributions,<br>
</li>
<li>calculate exponential growth or decline of cases,</li>
<li>find peak time, and</li>
<li>computing moving average of cases in specified time window.</li>
</ul>
</li>
</ul>
</div>
</div>
</div>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</section></section><section id="aio-delays-reuse"><p>Content from <a href="delays-reuse.html">Access epidemiological delay distributions</a></p>
<hr>
<p>Last updated on 2024-06-17 |
        
        <a href="https://github.com/epiverse-trace/tutorials-early/edit/main/episodes/delays-reuse.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 30 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How to get access to disease delay distributions from a
pre-established database for use in analysis?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Get delays from a literature search database with
<code>{epiparameter}</code>.</li>
<li>Get distribution parameters and summary statistics of delay
distributions.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div id="prerequisites" class="callout prereq">
<div class="callout-square">
<i class="callout-icon" data-feather="check"></i>
</div>
<div id="prerequisites" class="callout-inner">
<h3 class="callout-title">Prerequisites<a class="anchor" aria-label="anchor" href="#prerequisites"></a>
</h3>
<div class="callout-content">
<p>This episode requires you to be familiar with:</p>
<p><strong>Data science</strong> : Basic programming with R.</p>
<p><strong>Epidemic theory</strong> : epidemiological parameters,
disease time periods, such as the incubation period, generation time,
and serial interval.</p>
</div>
</div>
</div>
<section id="introduction"><h2 class="section-heading">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>Infectious diseases follow an infection cycle, which usually includes
the following phases: presymptomatic period, symptomatic period and
recovery period, as described by their <a href="reference.html#naturalhistory">natural history</a>. These time
periods can be used to understand transmission dynamics and inform
disease prevention and control interventions.</p>
<figure><img src="../fig/time-periods.jpg" alt="Definition of key time periods. From Xiang et al, 2021" class="figure mx-auto d-block"><div class="figcaption">Definition of key time periods. From <a href="https://www.sciencedirect.com/science/article/pii/S2468042721000038" class="external-link">Xiang
et al, 2021</a>
</div>
</figure><div id="definitions" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="definitions" class="callout-inner">
<h3 class="callout-title">Definitions<a class="anchor" aria-label="anchor" href="#definitions"></a>
</h3>
<div class="callout-content">
<p>Look at the <a href="reference.html">glossary</a> for the definitions
of all the time periods of the figure above!</p>
</div>
</div>
</div>
<p>However, early in an epidemic, modelling efforts can be delayed by
the lack of a centralised resource that summarises input parameters for
the disease of interest (<a href="https://mrc-ide.github.io/epireview/" class="external-link">Nash et al., 2023</a>).
Projects like <code>{epiparameter}</code> and <code>{epireview}</code>
are building online catalogues following literature synthesis protocols
that can help parametrise models by easily accessing a comprenhensive
library of previously estimated epidemiological parameters from past
outbreaks.</p>
<!-- Early models for COVID-19 used parameters from other coronaviruses. https://www.thelancet.com/article/S1473-3099(20)30144-4/fulltext -->
<p>To exemplify how to use the <code>{epiparameter}</code> R package in
your analysis pipeline, our goal in this episode will be to choose one
specific set of epidemiological parameters from the literature, instead
of copying-and-pasting them by hand, to plug them into an
<a href="https://epiforecasts.io/EpiNow2/" class="external-link">EpiNow2</a> analysis workflow.</p>
<!-- In this episode, we'll learn how to choose one specific set of epidemiological parameters from the literature and then get their **summary statistics** using `{epiparameter}`.  -->
<p>Let’s start loading the <code>{epiparameter}</code> package. We’ll
use the pipe <code>%&gt;%</code> to connect some of their functions,
some <a href="https://tibble.tidyverse.org/" class="external-link">tibble</a> and <a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a> functions, so let’s
also call to the <a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a> package:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">epiparameter</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span></code></pre>
</div>
<div id="the-double-colon" class="callout checklist">
<div class="callout-square">
<i class="callout-icon" data-feather="check-square"></i>
</div>
<div id="the-double-colon" class="callout-inner">
<h3 class="callout-title">The double-colon<a class="anchor" aria-label="anchor" href="#the-double-colon"></a>
</h3>
<div class="callout-content">
<p>The double-colon <code>::</code> in R let you call a specific
function from a package without loading the entire package into the
current environment.</p>
<p>For example, <code>dplyr::filter(data, condition)</code> uses
<code>filter()</code> from the <a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a> package.</p>
<p>This help us remember package functions and avoid namespace
conflicts.</p>
</div>
</div>
</div>
</section><section id="the-problem"><h2 class="section-heading">The problem<a class="anchor" aria-label="anchor" href="#the-problem"></a>
</h2>
<hr class="half-width">
<p>If we want to estimate the transmissibility of an infection, it’s
common to use a package such as <a href="https://github.com/mrc-ide/EpiEstim" class="external-link">EpiEstim</a> or
<a href="https://epiforecasts.io/EpiNow2/" class="external-link">EpiNow2</a>. However, both require some epidemiological
information as an input. For example, in <a href="https://epiforecasts.io/EpiNow2/" class="external-link">EpiNow2</a> we use
<code>EpiNow2::dist_spec()</code> to specify a <a href="reference.html#generationtime">generation time</a> as a
probability <code>distribution</code> adding its <code>mean</code>,
standard deviation (<code>sd</code>), and maximum value
(<code>max</code>). To specify a <code>generation_time</code> that
follows a <em>Gamma</em> distribution with mean <span class="math inline">\(\mu = 4\)</span>, standard deviation <span class="math inline">\(\sigma = 2\)</span>, and a maximum value of 20, we
write:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">generation_time</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">EpiNow2</span><span class="fu">::</span><span class="fu">dist_spec</span><span class="op">(</span></span>
<span>    mean <span class="op">=</span> <span class="fl">4</span>,</span>
<span>    sd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    max <span class="op">=</span> <span class="fl">20</span>,</span>
<span>    distribution <span class="op">=</span> <span class="st">"gamma"</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
<p>It is a common practice for analysts to manually search the available
literature and copy and paste the <strong>summary statistics</strong> or
the <strong>distribution parameters</strong> from scientific
publications. A challenge that is often faced is that the reporting of
different statistical distributions is not consistent across the
literature. <code>{epiparameter}</code>’s objective is to facilitate the
access to reliable estimates of distribution parameters for a range of
infectious diseases, so that they can easily be implemented in outbreak
analytic pipelines.</p>
<p>In this episode, we will <em>choose</em> the summary statistics from
the library of epidemiological parameters provided by
<code>{epiparameter}</code>.</p>
<!--
```r
epinow_estimates <- epinow(
  # cases
  reported_cases = example_confirmed[1:60],
  # delays
  generation_time = generation_time_opts(generation_time),
  # computation
  stan = stan_opts(
    cores = 4, samples = 1000, chains = 3,
    control = list(adapt_delta = 0.99)
  )
)
```
-->
</section><section id="generation-time-vs-serial-interval"><h2 class="section-heading">Generation time vs serial interval<a class="anchor" aria-label="anchor" href="#generation-time-vs-serial-interval"></a>
</h2>
<hr class="half-width">
<p>The generation time, jointly with the reproduction number (<span class="math inline">\(R\)</span>), provide valuable insights on the
strength of transmission and inform the implementation of control
measures. Given a <span class="math inline">\(R&gt;1\)</span>, the
shorter the generation time, the earlier the incidence of disease cases
will grow.</p>
<figure><img src="../fig/reproduction-generation-time.png" alt="Video from the MRC Centre for Global Infectious Disease Analysis, Ep 76. Science In Context - Epi Parameter Review Group with Dr Anne Cori (27-07-2023) at https://youtu.be/VvpYHhFDIjI?si=XiUyjmSV1gKNdrrL" class="figure mx-auto d-block"><div class="figcaption">Video from the MRC Centre for Global Infectious
Disease Analysis, Ep 76. Science In Context - Epi Parameter Review Group
with Dr Anne Cori (27-07-2023) at <a href="https://youtu.be/VvpYHhFDIjI?si=XiUyjmSV1gKNdrrL" class="external-link uri">https://youtu.be/VvpYHhFDIjI?si=XiUyjmSV1gKNdrrL</a>
</div>
</figure><p>In calculating the effective reproduction number (<span class="math inline">\(R_{t}\)</span>), the <em>generation time</em>
distribution is often approximated by the <a href="reference.html#serialinterval">serial interval</a> distribution.
This frequent approximation is because it is easier to observe and
measure the onset of symptoms than the onset of infectiousness.</p>
<figure><img src="../fig/serial-interval-observed.jpeg" alt="A schematic of the relationship of different time periods of transmission between an infector and an infectee in a transmission pair. Exposure window is defined as the time interval having viral exposure, and transmission window is defined as the time interval for onward transmission with respect to the infection time (Chung Lau et al., 2021)." class="figure mx-auto d-block"><div class="figcaption">A schematic of the relationship of different
time periods of transmission between an infector and an infectee in a
transmission pair. Exposure window is defined as the time interval
having viral exposure, and transmission window is defined as the time
interval for onward transmission with respect to the infection time (<a href="https://academic.oup.com/jid/article/224/10/1664/6356465" class="external-link">Chung
Lau et al., 2021</a>).</div>
</figure><p>However, using the <em>serial interval</em> as an approximation of
the <em>generation time</em> is primarily valid for diseases in which
infectiousness starts after symptom onset (<a href="https://academic.oup.com/jid/article/224/10/1664/6356465" class="external-link">Chung
Lau et al., 2021</a>). In cases where infectiousness starts before
symptom onset, the serial intervals can have negative values, which is
the case for diseases with pre-symptomatic transmission (<a href="https://www.ijidonline.com/article/S1201-9712(20)30119-3/fulltext#gr2" class="external-link">Nishiura
et al., 2020</a>).</p>
<!-- Additionally, even if the *generation time* and *serial interval* have the same mean, their variance usually differs, propagating bias to the $R_{t}$ estimation ([Gostic et al., 2020](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1008409)). -->
<div id="from-time-periods-to-probability-distributions." class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="from-time-periods-to-probability-distributions." class="callout-inner">
<h3 class="callout-title">From time periods to probability
distributions.<a class="anchor" aria-label="anchor" href="#from-time-periods-to-probability-distributions."></a>
</h3>
<div class="callout-content">
<p>When we calculate the <em>serial interval</em>, we see that not all
case pairs have the same time length. We will observe this variability
for any case pair and individual time period, including the <a href="reference.html#incubation">incubation period</a> and <a href="reference.html#infectiousness">infectious period</a>.</p>
<figure><img src="../fig/serial-interval-pairs.jpg" alt="Serial intervals of possible case pairs in (a) COVID-19 and (b) MERS-CoV. Pairs represent a presumed infector and their presumed infectee plotted by date of symptom onset (Althobaity et al., 2022)." class="figure mx-auto d-block"><div class="figcaption">Serial intervals of possible case pairs in (a)
COVID-19 and (b) MERS-CoV. Pairs represent a presumed infector and their
presumed infectee plotted by date of symptom onset (<a href="https://www.sciencedirect.com/science/article/pii/S2468042722000537#fig6" class="external-link">Althobaity
et al., 2022</a>).</div>
</figure><p>To summarise these data from individual and pair time periods, we can
find the <strong>statistical distributions</strong> that best fit the
data (<a href="https://www.eurosurveillance.org/content/10.2807/1560-7917.ES.2023.28.27.2200806" class="external-link">McFarland
et al., 2023</a>).</p>
<!-- add a reference about good practices to estimate distributions -->
<figure><img src="../fig/seria-interval-fitted-distributions.jpg" alt="Fitted serial interval distribution for (a) COVID-19 and (b) MERS-CoV based on reported transmission pairs in Saudi Arabia. We fitted three commonly used distributions, Lognormal, Gamma, and Weibull distributions, respectively (Althobaity et al., 2022)." class="figure mx-auto d-block"><div class="figcaption">Fitted serial interval distribution for (a)
COVID-19 and (b) MERS-CoV based on reported transmission pairs in Saudi
Arabia. We fitted three commonly used distributions, Lognormal, Gamma,
and Weibull distributions, respectively (<a href="https://www.sciencedirect.com/science/article/pii/S2468042722000537#fig5" class="external-link">Althobaity
et al., 2022</a>).</div>
</figure><p>Statistical distributions are summarised in terms of their
<strong>summary statistics</strong> like the <em>location</em> (mean and
percentiles) and <em>spread</em> (variance or standard deviation) of the
distribution, or with their <strong>distribution parameters</strong>
that inform about the <em>form</em> (shape and rate/scale) of the
distribution. These estimated values can be reported with their
<strong>uncertainty</strong> (95% confidence intervals).</p>
<table class="table">
<thead><tr class="header">
<th align="left">Gamma</th>
<th align="left">mean</th>
<th align="left">shape</th>
<th align="left">rate/scale</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">MERS-CoV</td>
<td align="left">14.13(13.9–14.7)</td>
<td align="left">6.31(4.88–8.52)</td>
<td align="left">0.43(0.33–0.60)</td>
</tr>
<tr class="even">
<td align="left">COVID-19</td>
<td align="left">5.1(5.0–5.5)</td>
<td align="left">2.77(2.09–3.88)</td>
<td align="left">0.53(0.38–0.76)</td>
</tr>
</tbody>
</table>
<table class="table">
<thead><tr class="header">
<th align="left">Weibull</th>
<th align="left">mean</th>
<th align="left">shape</th>
<th align="left">rate/scale</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">MERS-CoV</td>
<td align="left">14.2(13.3–15.2)</td>
<td align="left">3.07(2.64–3.63)</td>
<td align="left">16.1(15.0–17.1)</td>
</tr>
<tr class="even">
<td align="left">COVID-19</td>
<td align="left">5.2(4.6–5.9)</td>
<td align="left">1.74(1.46–2.11)</td>
<td align="left">5.83(5.08–6.67)</td>
</tr>
</tbody>
</table>
<table class="table">
<caption>Serial interval estimates using Gamma, Weibull, and Log Normal
distributions. 95% confidence intervals for the shape and scale (logmean
and sd for Log Normal) parameters are shown in brackets (<a href="https://www.sciencedirect.com/science/article/pii/S2468042722000537#tbl3" class="external-link">Althobaity
et al., 2022</a>).</caption>
<thead><tr class="header">
<th align="left">Log normal</th>
<th align="left">mean</th>
<th align="left">mean-log</th>
<th align="left">sd-log</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">MERS-CoV</td>
<td align="left">14.08(13.1–15.2)</td>
<td align="left">2.58(2.50–2.68)</td>
<td align="left">0.44(0.39–0.5)</td>
</tr>
<tr class="even">
<td align="left">COVID-19</td>
<td align="left">5.2(4.2–6.5)</td>
<td align="left">1.45(1.31–1.61)</td>
<td align="left">0.63(0.54–0.74)</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="serial-interval" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="serial-interval" class="callout-inner">
<h3 class="callout-title">Serial interval<a class="anchor" aria-label="anchor" href="#serial-interval"></a>
</h3>
<div class="callout-content">
<p>Assume that COVID-19 and SARS have similar reproduction number values
and that the serial interval approximates the generation time.</p>
<p>Given the serial interval of both infections in the figure below:</p>
<ul>
<li>Which one would be harder to control?</li>
<li>Why do you conclude that?</li>
</ul>
<figure><img src="../fig/serial-interval-covid-sars.jpg" alt="Serial interval of novel coronavirus (COVID-19) infections overlaid with a published distribution of SARS. (Nishiura et al., 2020)" class="figure mx-auto d-block"><div class="figcaption">Serial interval of novel coronavirus (COVID-19)
infections overlaid with a published distribution of SARS. (<a href="https://www.ijidonline.com/article/S1201-9712(20)30119-3/fulltext" class="external-link">Nishiura
et al., 2020</a>)</div>
</figure>
</div>
</div>
</div>
<div id="accordionHint1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button hint-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHint1" aria-expanded="false" aria-controls="collapseHint1">
  <h4 class="accordion-header" id="headingHint1">Give me a hint</h4>
</button>
<div id="collapseHint1" class="accordion-collapse collapse" data-bs-parent="#accordionHint1" aria-labelledby="headingHint1">
<div class="accordion-body">
<p>The peak of each curve can inform you about the location of the mean
of each distribution. The larger the mean, the larger the serial
interval.</p>
</div>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Show me the solution</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p><strong>Which one would be harder to control?</strong></p>
<p>COVID-19</p>
<p><strong>Why do you conclude that?</strong></p>
<p>COVID-19 has the lowest mean serial interval. The approximate mean
value for the serial interval of COVID-19 is around four days, and SARS
is about seven days. Thus, COVID-19 will likely have newer generations
in less time than SARS, assuming similar reproduction numbers.</p>
</div>
</div>
</div>
</div>
<div id="accordionInstructor1" class="accordion instructor-note accordion-flush">
<div class="accordion-item">
<button class="accordion-button instructor-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInstructor1" aria-expanded="false" aria-controls="collapseInstructor1">
  <h3 class="accordion-header" id="headingInstructor1">
<div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="edit-2"></i></div>Instructor Note</h3>
</button>
<div id="collapseInstructor1" class="accordion-collapse collapse" data-bs-parent="#accordionInstructor1" aria-labelledby="headingInstructor1">
<div class="accordion-body">
<p>The objective of the assessment above is to assess the interpretation
of a larger or shorter generation time.</p>
</div>
</div>
</div>
</div>
</section><section id="choosing-epidemiological-parameters"><h2 class="section-heading">Choosing epidemiological parameters<a class="anchor" aria-label="anchor" href="#choosing-epidemiological-parameters"></a>
</h2>
<hr class="half-width">
<p>In this section, we will use <code>{epiparameter}</code> to obtain
the generation time and the serial interval for COVID-19, so these
metrics can be used to estimate the transmissibility of this disease
using <a href="https://epiforecasts.io/EpiNow2/" class="external-link">EpiNow2</a> in subsequent sections of this episode.</p>
<p>Let’s start by looking at how many entries are available in the
epidemiological distributions database in <code>{epiparameter}</code>
(<code>epidist_db</code>) for the <code>disease</code> named
<code>covid</code>-19:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">epidist_db</span><span class="op">(</span></span>
<span>  disease <span class="op">=</span> <span class="st">"covid"</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Returning 27 results that match the criteria (22 are parameterised). 
Use subset to filter by entry variables or single_epidist to return a single entry. 
To retrieve the short citation for each use the 'get_citation' function</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>List of &lt;epidist&gt; objects
  Number of entries in library: 27
  Number of studies in library: 10
  Number of diseases: 1
  Number of delay distributions: 27
  Number of offspring distributions: 0</code></pre>
</div>
<div id="the-double-colon-1" class="callout checklist">
<div class="callout-square">
<i class="callout-icon" data-feather="check-square"></i>
</div>
<div id="the-double-colon-1" class="callout-inner">
<h3 class="callout-title">The double-colon<a class="anchor" aria-label="anchor" href="#the-double-colon-1"></a>
</h3>
<div class="callout-content">
<p>The double-colon <code>::</code> in R is used to access functions or
objects from a specific package without loading the entire package into
the current environment. This allows for a more targeted approach to
using package components and helps avoid namespace conflicts.</p>
<p><code>::</code> lets you call a specific function from a package by
explicitly mentioning the package name. For example,
<code>dplyr::filter(data, condition)</code> uses <code>filter()</code>
from the <a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a> package without loading the entire
package.</p>
</div>
</div>
</div>
<p>From the <code>{epiparameter}</code> package, we can use the
<code>epidist_db()</code> function to ask for any <code>disease</code>
and also for a specific epidemiological distribution
(<code>epi_dist</code>).</p>
<p>Let’s ask now how many parameters we have in the epidemiological
distributions database (<code>epidist_db</code>) with the generation
time using the string <code>generation</code>:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">epidist_db</span><span class="op">(</span></span>
<span>  epi_dist <span class="op">=</span> <span class="st">"generation"</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Returning 1 results that match the criteria (1 are parameterised). 
Use subset to filter by entry variables or single_epidist to return a single entry. 
To retrieve the short citation for each use the 'get_citation' function</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Disease: Influenza
Pathogen: Influenza-A-H1N1
Epi Distribution: generation time
Study: Lessler J, Reich N, Cummings D, New York City Department of Health and
Mental Hygiene Swine Influenza Investigation Team (2009). "Outbreak of
2009 Pandemic Influenza A (H1N1) at a New York City School." _The New
England Journal of Medicine_. doi:10.1056/NEJMoa0906089
&lt;https://doi.org/10.1056/NEJMoa0906089&gt;.
Distribution: weibull
Parameters:
  shape: 2.360
  scale: 3.180</code></pre>
</div>
<p>Currently, in the library of epidemiological parameters, we have one
<code>generation</code> time entry for Influenza. Considering the
above-mentioned considerations, we can look at the <code>serial</code>
intervals for <code>COVID</code>-19. Run this locally!</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">epidist_db</span><span class="op">(</span></span>
<span>  disease <span class="op">=</span> <span class="st">"COVID"</span>,</span>
<span>  epi_dist <span class="op">=</span> <span class="st">"serial"</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<p>With this query combination, we get more than one delay distribution.
This output is an <code>&lt;epidist&gt;</code> class object.</p>
<div id="case-insensitive" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="case-insensitive" class="callout-inner">
<h3 class="callout-title">CASE-INSENSITIVE<a class="anchor" aria-label="anchor" href="#case-insensitive"></a>
</h3>
<div class="callout-content">
<p><code>epidist_db</code> is <a href="https://dillionmegida.com/p/case-sensitivity-vs-case-insensitivity/#case-insensitivity" class="external-link">case-insensitive</a>.
This means that you can use strings with letters in upper or lower case
indistinctly. Strings like <code>"serial"</code>,
<code>"serial interval"</code> or <code>"serial_interval"</code> are
also valid.</p>
</div>
</div>
</div>
<p>To summarise an <code>&lt;epidist&gt;</code> object and get the
column names from the underlying parameter database, we can add the
<code>epiparameter::list_distributions()</code> function to the previous
code using the pipe <code>%&gt;%</code>:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">epidist_db</span><span class="op">(</span></span>
<span>  disease <span class="op">=</span> <span class="st">"covid"</span>,</span>
<span>  epi_dist <span class="op">=</span> <span class="st">"serial"</span></span>
<span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">list_distributions</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Returning 4 results that match the criteria (3 are parameterised). 
Use subset to filter by entry variables or single_epidist to return a single entry. 
To retrieve the short citation for each use the 'get_citation' function</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>   disease epi_distribution prob_distribution       author year
1 COVID-19  serial interval              &lt;NA&gt; Muluneh .... 2021
2 COVID-19  serial interval             lnorm Hiroshi .... 2020
3 COVID-19  serial interval           weibull Hiroshi .... 2020
4 COVID-19  serial interval              norm Lin Yang.... 2020</code></pre>
</div>
<p>In the <code>epiparameter::list_distributions()</code> output, we can
also find different types of probability distributions (e.g.,
Log-normal, Weibull, Normal).</p>
<p><code>{epiparameter}</code> uses the <code>base</code> R naming
convention for distributions. This is why <strong>Lognormal</strong> is
called <code>lnorm</code>.</p>
<div id="accordionSpoiler1" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler1" aria-expanded="false" aria-controls="collapseSpoiler1">
  <h3 class="accordion-header" id="headingSpoiler1">
<div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div>Why do we have an ‘NA’ entry?</h3>
</button>
<div id="collapseSpoiler1" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler1" aria-labelledby="headingSpoiler1">
<div class="accordion-body">
<p>Entries with a missing value (<code>&lt;NA&gt;</code>) in the
<code>prob_distribution</code> column are <em>non-parameterised</em>
entries. They have summary statistics but no probability distribution.
Compare these two outputs:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get an &lt;epidist&gt; object</span></span>
<span><span class="va">distribution</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">epidist_db</span><span class="op">(</span></span>
<span>    disease <span class="op">=</span> <span class="st">"covid"</span>,</span>
<span>    epi_dist <span class="op">=</span> <span class="st">"serial"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">distribution</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co"># pluck the first entry in the object class &lt;list&gt;</span></span>
<span>  <span class="fu">pluck</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co"># check if &lt;epidist&gt; object have distribution parameters</span></span>
<span>  <span class="fu">is_parameterised</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># check if the second &lt;epidist&gt; object</span></span>
<span><span class="co"># have distribution parameters</span></span>
<span><span class="va">distribution</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">pluck</span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">is_parameterised</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="parameterised-entries-have-an-inference-method">Parameterised entries have an Inference method<a class="anchor" aria-label="anchor" href="#parameterised-entries-have-an-inference-method"></a>
</h3>
<p>As detailed in <code>?is_parameterised</code>, a parameterised
distribution is the entry that has a probability distribution associated
with it provided by an <code>inference_method</code> as shown in
<code>metadata</code>:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">distribution</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">metadata</span><span class="op">$</span><span class="va">inference_method</span></span>
<span><span class="va">distribution</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">metadata</span><span class="op">$</span><span class="va">inference_method</span></span>
<span><span class="va">distribution</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">metadata</span><span class="op">$</span><span class="va">inference_method</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="find-your-delay-distributions" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="find-your-delay-distributions" class="callout-inner">
<h3 class="callout-title">Find your delay distributions!<a class="anchor" aria-label="anchor" href="#find-your-delay-distributions"></a>
</h3>
<div class="callout-content">
<p>Take 2 minutes to explore the <code>{epiparameter}</code>
library.</p>
<p><strong>Choose</strong> a disease of interest (e.g., Influenza,
Measles, etc.) and a delay distribution (e.g., the incubation period,
onset to death, etc.).</p>
<p>Find:</p>
<ul>
<li><p>How many delay distributions are for that disease?</p></li>
<li><p>How many types of probability distribution (e.g., gamma,
lognormal) are for a given delay in that disease?</p></li>
</ul>
<p>Ask:</p>
<ul>
<li><p>Do you recognise the papers?</p></li>
<li><p>Should <code>{epiparameter}</code> literature review consider any
other paper?</p></li>
</ul>
</div>
</div>
</div>
<div id="accordionHint2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button hint-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHint2" aria-expanded="false" aria-controls="collapseHint2">
  <h4 class="accordion-header" id="headingHint2">Give me a hint</h4>
</button>
<div id="collapseHint2" class="accordion-collapse collapse" data-bs-parent="#accordionHint2" aria-labelledby="headingHint2">
<div class="accordion-body">
<p>The <code>epidist_db()</code> function with <code>disease</code>
alone counts the number of entries like:</p>
<ul>
<li>studies, and</li>
<li>delay distributions.</li>
</ul>
<p>The <code>epidist_db()</code> function with <code>disease</code> and
<code>epi_dist</code> gets a list of all entries with:</p>
<ul>
<li>the complete citation,</li>
<li>the <strong>type</strong> of a probability distribution, and</li>
<li>distribution parameter values.</li>
</ul>
<p>The combo of <code>epidist_db()</code> plus
<code>list_distributions()</code> gets a data frame of all entries with
columns like:</p>
<ul>
<li>the <strong>type</strong> of the probability distribution per delay,
and</li>
<li>author and year of the study.</li>
</ul>
</div>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">Show me the solution</h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<p>We choose to explore Ebola’s delay distributions:</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># we expect 16 delays distributions for ebola</span></span>
<span><span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">epidist_db</span><span class="op">(</span></span>
<span>  disease <span class="op">=</span> <span class="st">"ebola"</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Returning 17 results that match the criteria (17 are parameterised). 
Use subset to filter by entry variables or single_epidist to return a single entry. 
To retrieve the short citation for each use the 'get_citation' function</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>List of &lt;epidist&gt; objects
  Number of entries in library: 17
  Number of studies in library: 4
  Number of diseases: 1
  Number of delay distributions: 16
  Number of offspring distributions: 1</code></pre>
</div>
<p>Now, from the output of <code>epiparameter::epidist_db()</code>, What
is an <a href="reference.html#offspringdist">offspring
distribution</a>?</p>
<p>We choose to find Ebola’s incubation periods. This output list all
the papers and parameters found. Run this locally if needed:</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">epidist_db</span><span class="op">(</span></span>
<span>  disease <span class="op">=</span> <span class="st">"ebola"</span>,</span>
<span>  epi_dist <span class="op">=</span> <span class="st">"incubation"</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<p>We use <code>list_distributions()</code> to get a summary display of
all:</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># we expect 2 different types of delay distributions</span></span>
<span><span class="co"># for ebola incubation period</span></span>
<span><span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">epidist_db</span><span class="op">(</span></span>
<span>  disease <span class="op">=</span> <span class="st">"ebola"</span>,</span>
<span>  epi_dist <span class="op">=</span> <span class="st">"incubation"</span></span>
<span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">list_distributions</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Returning 5 results that match the criteria (5 are parameterised). 
Use subset to filter by entry variables or single_epidist to return a single entry. 
To retrieve the short citation for each use the 'get_citation' function</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>              disease  epi_distribution prob_distribution       author year
1 Ebola Virus Disease incubation period             lnorm Martin E.... 2011
2 Ebola Virus Disease incubation period             gamma WHO Ebol.... 2015
3 Ebola Virus Disease incubation period             gamma WHO Ebol.... 2015
4 Ebola Virus Disease incubation period             gamma WHO Ebol.... 2015
5 Ebola Virus Disease incubation period             gamma WHO Ebol.... 2015</code></pre>
</div>
<p>We find two types of probability distributions for this query:
<em>lognormal</em> and <em>gamma</em>.</p>
<p>How does <code>{epiparameter}</code> do the collection and review of
peer-reviewed literature? We invite you to read the vignette on <a href="https://epiverse-trace.github.io/epiparameter/articles/data_protocol.html" class="external-link">“Data
Collation and Synthesis Protocol”</a>!</p>
</div>
</div>
</div>
</div>
</section><section id="select-a-single-distribution"><h2 class="section-heading">Select a single distribution<a class="anchor" aria-label="anchor" href="#select-a-single-distribution"></a>
</h2>
<hr class="half-width">
<p>The <code>epiparameter::epidist_db()</code> function works as a
filtering or subset function. Let’s use the <code>author</code> argument
to filter <code>Hiroshi Nishiura</code> parameters:</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">epidist_db</span><span class="op">(</span></span>
<span>  disease <span class="op">=</span> <span class="st">"covid"</span>,</span>
<span>  epi_dist <span class="op">=</span> <span class="st">"serial"</span>,</span>
<span>  author <span class="op">=</span> <span class="st">"Hiroshi"</span></span>
<span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">list_distributions</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Returning 2 results that match the criteria (2 are parameterised). 
Use subset to filter by entry variables or single_epidist to return a single entry. 
To retrieve the short citation for each use the 'get_citation' function</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>   disease epi_distribution prob_distribution       author year
1 COVID-19  serial interval             lnorm Hiroshi .... 2020
2 COVID-19  serial interval           weibull Hiroshi .... 2020</code></pre>
</div>
<p>We still get more than one epidemiological parameter. We can set the
<code>single_epidist</code> argument to <code>TRUE</code> to only
one:</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">epidist_db</span><span class="op">(</span></span>
<span>  disease <span class="op">=</span> <span class="st">"covid"</span>,</span>
<span>  epi_dist <span class="op">=</span> <span class="st">"serial"</span>,</span>
<span>  author <span class="op">=</span> <span class="st">"Hiroshi"</span>,</span>
<span>  single_epidist <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Using Nishiura H, Linton N, Akhmetzhanov A (2020). "Serial interval of novel
coronavirus (COVID-19) infections." _International Journal of
Infectious Diseases_. doi:10.1016/j.ijid.2020.02.060
&lt;https://doi.org/10.1016/j.ijid.2020.02.060&gt;.. 
To retrieve the short citation use the 'get_citation' function</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Disease: COVID-19
Pathogen: SARS-CoV-2
Epi Distribution: serial interval
Study: Nishiura H, Linton N, Akhmetzhanov A (2020). "Serial interval of novel
coronavirus (COVID-19) infections." _International Journal of
Infectious Diseases_. doi:10.1016/j.ijid.2020.02.060
&lt;https://doi.org/10.1016/j.ijid.2020.02.060&gt;.
Distribution: lnorm
Parameters:
  meanlog: 1.386
  sdlog: 0.568</code></pre>
</div>
<div id="how-does-single_epidist-works" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="how-does-single_epidist-works" class="callout-inner">
<h3 class="callout-title">How does ‘single_epidist’ works?<a class="anchor" aria-label="anchor" href="#how-does-single_epidist-works"></a>
</h3>
<div class="callout-content">
<p>Looking at the help documentation for
<code>?epiparameter::epidist_db()</code>:</p>
<ul>
<li>If multiple entries match the arguments supplied and
<code>single_epidist = TRUE</code>, then the parameterised
<code>&lt;epidist&gt;</code> with the <em>largest sample size</em> will
be returned.</li>
<li>If multiple entries are equal after this sorting, the <em>first
entry</em> will be returned.</li>
</ul>
<p>What is a <em>parametrised</em> <code>&lt;epidist&gt;</code>? Look at
<code>?is_parameterised</code>.</p>
</div>
</div>
</div>
<p>Let’s assign this <code>&lt;epidist&gt;</code> class object to the
<code>covid_serialint</code> object.</p>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">covid_serialint</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">epidist_db</span><span class="op">(</span></span>
<span>    disease <span class="op">=</span> <span class="st">"covid"</span>,</span>
<span>    epi_dist <span class="op">=</span> <span class="st">"serial"</span>,</span>
<span>    author <span class="op">=</span> <span class="st">"Nishiura"</span>,</span>
<span>    single_epidist <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
<!-- to activate for EpiNow2@dist-interfase

But still, we need to extract them as usable numbers. We use `epiparameter::get_parameters()` for this:


```r
covid_serialint_parameters <- epiparameter::get_parameters(covid_serialint)

covid_serialint_parameters
```

```{.output}
  meanlog     sdlog 
1.3862617 0.5679803 
```

This gets a vector of class `<numeric>` useful as input for any other package! 

:::::::::::::::::: callout

If we write the `[]` next to the last object create like in `covid_serialint_parameters[]`, within `[]` we can use the 
Tab key <kbd>↹</kbd> 
to use the [code completion feature](https://support.posit.co/hc/en-us/articles/205273297-Code-Completion-in-the-RStudio-IDE) and have a quick access to `covid_serialint_parameters["meanlog"]` and `covid_serialint_parameters["sdlog"]`. We invite you to try this out!

This only seems to work in code chunks and R console!

::::::::::::::::::

-->
<p>You can use <code>plot()</code> to <code>&lt;epidist&gt;</code>
objects to visualise:</p>
<ul>
<li>the <em>Probability Density Function (PDF)</em> and</li>
<li>the <em>Cumulative Distribution Function (CDF)</em>.</li>
</ul>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot &lt;epidist&gt; object</span></span>
<span><span class="fu">plot</span><span class="op">(</span><span class="va">covid_serialint</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/delays-reuse-rendered-unnamed-chunk-15-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>With the <code>day_range</code> argument, you can change the length
or number of days in the <code>x</code> axis. Explore what this looks
like:</p>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot &lt;epidist&gt; object</span></span>
<span><span class="fu">plot</span><span class="op">(</span><span class="va">covid_serialint</span>, day_range <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span></span></code></pre>
</div>
</section><section id="extract-the-summary-statistics"><h2 class="section-heading">Extract the summary statistics<a class="anchor" aria-label="anchor" href="#extract-the-summary-statistics"></a>
</h2>
<hr class="half-width">
<p>We can get the <code>mean</code> and standard deviation
(<code>sd</code>) from this <code>&lt;epidist&gt;</code> diving into the
<code>summary_stats</code> object:</p>
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get the mean</span></span>
<span><span class="va">covid_serialint</span><span class="op">$</span><span class="va">summary_stats</span><span class="op">$</span><span class="va">mean</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 4.7</code></pre>
</div>
<p>Now, we have an epidemiological parameter we can reuse! We can
replace the <strong>summary statistics</strong> numbers we plug into the
<code>EpiNow2::dist_spec()</code> function:</p>
<div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">generation_time</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">EpiNow2</span><span class="fu">::</span><span class="fu">dist_spec</span><span class="op">(</span></span>
<span>    mean <span class="op">=</span> <span class="va">covid_serialint</span><span class="op">$</span><span class="va">summary_stats</span><span class="op">$</span><span class="va">mean</span>, <span class="co"># replaced!</span></span>
<span>    sd <span class="op">=</span> <span class="va">covid_serialint</span><span class="op">$</span><span class="va">summary_stats</span><span class="op">$</span><span class="va">sd</span>, <span class="co"># replaced!</span></span>
<span>    max <span class="op">=</span> <span class="fl">20</span>,</span>
<span>    distribution <span class="op">=</span> <span class="st">"gamma"</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
<p>In the next episode we’ll learn how to use <a href="https://epiforecasts.io/EpiNow2/" class="external-link">EpiNow2</a> to
correctly specify distributions, estimate transmissibility. Then, how to
use <strong>distribution functions</strong> to get a maximum value
(<code>max</code>) for <code>EpiNow2::dist_spec()</code> and use
<code>{epiparameter}</code> in your analysis.</p>
<div id="log-normal-distributions" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="log-normal-distributions" class="callout-inner">
<h3 class="callout-title">Log normal distributions<a class="anchor" aria-label="anchor" href="#log-normal-distributions"></a>
</h3>
<div class="callout-content">
<p>If you need the log normal <strong>distribution parameters</strong>
instead of the summary statistics, we can use
<code>epiparameter::get_parameters()</code>:</p>
<div class="codewrapper sourceCode" id="cb34">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">covid_serialint_parameters</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">get_parameters</span><span class="op">(</span><span class="va">covid_serialint</span><span class="op">)</span></span>
<span></span>
<span><span class="va">covid_serialint_parameters</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  meanlog     sdlog 
1.3862617 0.5679803 </code></pre>
</div>
<p>This gets a vector of class <code>&lt;numeric&gt;</code> ready to use
as input for any other package!</p>
</div>
</div>
</div>
</section><section id="challenges"><h2 class="section-heading">Challenges<a class="anchor" aria-label="anchor" href="#challenges"></a>
</h2>
<hr class="half-width">
<div id="ebolas-serial-interval" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="ebolas-serial-interval" class="callout-inner">
<h3 class="callout-title">Ebola’s serial interval<a class="anchor" aria-label="anchor" href="#ebolas-serial-interval"></a>
</h3>
<div class="callout-content">
<p>Take 1 minute to:</p>
<p>Get access to the Ebola serial interval with the highest sample
size.</p>
<p>Answer:</p>
<ul>
<li><p>What is the <code>sd</code> of the epidemiological
distribution?</p></li>
<li><p>What is the <code>sample_size</code> used in that study?</p></li>
</ul>
</div>
</div>
</div>
<div id="accordionHint3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button hint-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHint3" aria-expanded="false" aria-controls="collapseHint3">
  <h4 class="accordion-header" id="headingHint3">Give me a hint</h4>
</button>
<div id="collapseHint3" class="accordion-collapse collapse" data-bs-parent="#accordionHint3" aria-labelledby="headingHint3">
<div class="accordion-body">
<p>Use the <code>$</code> operator plus the <kbd>tab</kbd> or
<kbd>↹</kbd> keyboard button to explore them as an expandable list:</p>
<div class="codewrapper sourceCode" id="cb36">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a>covid_serialint<span class="sc">$</span></span></code></pre>
</div>
<p>Use the <code>str()</code> to display the structure of the
<code>&lt;epidist&gt;</code> R object.</p>
</div>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3">Show me the solution</h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb37">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ebola serial interval</span></span>
<span><span class="va">ebola_serial</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">epidist_db</span><span class="op">(</span></span>
<span>    disease <span class="op">=</span> <span class="st">"ebola"</span>,</span>
<span>    epi_dist <span class="op">=</span> <span class="st">"serial"</span>,</span>
<span>    single_epidist <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Using WHO Ebola Response Team, Agua-Agum J, Ariyarajah A, Aylward B, Blake I,
Brennan R, Cori A, Donnelly C, Dorigatti I, Dye C, Eckmanns T, Ferguson
N, Formenty P, Fraser C, Garcia E, Garske T, Hinsley W, Holmes D,
Hugonnet S, Iyengar S, Jombart T, Krishnan R, Meijers S, Mills H,
Mohamed Y, Nedjati-Gilani G, Newton E, Nouvellet P, Pelletier L,
Perkins D, Riley S, Sagrado M, Schnitzler J, Schumacher D, Shah A, Van
Kerkhove M, Varsaneux O, Kannangarage N (2015). "West African Ebola
Epidemic after One Year — Slowing but Not Yet under Control." _The New
England Journal of Medicine_. doi:10.1056/NEJMc1414992
&lt;https://doi.org/10.1056/NEJMc1414992&gt;.. 
To retrieve the short citation use the 'get_citation' function</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb39">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ebola_serial</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Disease: Ebola Virus Disease
Pathogen: Ebola Virus
Epi Distribution: serial interval
Study: WHO Ebola Response Team, Agua-Agum J, Ariyarajah A, Aylward B, Blake I,
Brennan R, Cori A, Donnelly C, Dorigatti I, Dye C, Eckmanns T, Ferguson
N, Formenty P, Fraser C, Garcia E, Garske T, Hinsley W, Holmes D,
Hugonnet S, Iyengar S, Jombart T, Krishnan R, Meijers S, Mills H,
Mohamed Y, Nedjati-Gilani G, Newton E, Nouvellet P, Pelletier L,
Perkins D, Riley S, Sagrado M, Schnitzler J, Schumacher D, Shah A, Van
Kerkhove M, Varsaneux O, Kannangarage N (2015). "West African Ebola
Epidemic after One Year — Slowing but Not Yet under Control." _The New
England Journal of Medicine_. doi:10.1056/NEJMc1414992
&lt;https://doi.org/10.1056/NEJMc1414992&gt;.
Distribution: gamma
Parameters:
  shape: 2.188
  scale: 6.490</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb41">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get the sd</span></span>
<span><span class="va">ebola_serial</span><span class="op">$</span><span class="va">summary_stats</span><span class="op">$</span><span class="va">sd</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 9.6</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb43">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get the sample_size</span></span>
<span><span class="va">ebola_serial</span><span class="op">$</span><span class="va">metadata</span><span class="op">$</span><span class="va">sample_size</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 305</code></pre>
</div>
<p>Try to visualise this distribution using <code>plot()</code>.</p>
<p>Also, explore all the other nested elements within the
<code>&lt;epidist&gt;</code> object.</p>
<p>Share about:</p>
<ul>
<li>What elements do you find useful for your analysis?</li>
<li>What other elements would you like to see in this object? How?</li>
</ul>
</div>
</div>
</div>
</div>
<div id="accordionInstructor2" class="accordion instructor-note accordion-flush">
<div class="accordion-item">
<button class="accordion-button instructor-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInstructor2" aria-expanded="false" aria-controls="collapseInstructor2">
  <h3 class="accordion-header" id="headingInstructor2">
<div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="edit-2"></i></div>Instructor Note</h3>
</button>
<div id="collapseInstructor2" class="accordion-collapse collapse" data-bs-parent="#accordionInstructor2" aria-labelledby="headingInstructor2">
<div class="accordion-body">
<p>An interesting element is the <code>method_assess</code> nested
entry, which refers to the methods used by the study authors to assess
for bias while estimating the serial interval distribution.</p>
<div class="codewrapper sourceCode" id="cb45">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">covid_serialint</span><span class="op">$</span><span class="va">method_assess</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>$censored
[1] TRUE

$right_truncated
[1] TRUE

$phase_bias_adjusted
[1] FALSE</code></pre>
</div>
<p>We will explore these concepts following episodes!</p>
</div>
</div>
</div>
</div>
<div id="ebolas-severity-parameter" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="ebolas-severity-parameter" class="callout-inner">
<h3 class="callout-title">Ebola’s severity parameter<a class="anchor" aria-label="anchor" href="#ebolas-severity-parameter"></a>
</h3>
<div class="callout-content">
<p>A severity parameter like the duration of hospitalisation could add
to the information needed about the bed capacity in response to an
outbreak (<a href="https://royalsocietypublishing.org/doi/10.1098/rstb.2016.0371" class="external-link">Cori
et al., 2017</a>).</p>
<!-- Also, `{EpiNow2}` can also include the uncertainty around each summary statistic, like the standard deviation of the standard deviation. -->
<p>For Ebola:</p>
<ul>
<li>What is the reported <em>point estimate</em> of the mean duration of
health care and case isolation?</li>
</ul>
</div>
</div>
</div>
<div id="accordionHint4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button hint-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHint4" aria-expanded="false" aria-controls="collapseHint4">
  <h4 class="accordion-header" id="headingHint4">Give me a hint</h4>
</button>
<div id="collapseHint4" class="accordion-collapse collapse" data-bs-parent="#accordionHint4" aria-labelledby="headingHint4">
<div class="accordion-body">
<p>An informative delay should measure the time from symptom onset to
recovery or death.</p>
<p>Find a way to access the whole <code>{epiparameter}</code> database
and find how that delay may be stored. The
<code>list_distributions()</code> output is a dataframe.</p>
</div>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4">Show me the solution</h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" data-bs-parent="#accordionSolution4" aria-labelledby="headingSolution4">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb47">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># one way to get the list of all the available parameters</span></span>
<span><span class="fu">epidist_db</span><span class="op">(</span>disease <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">list_distributions</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">distinct</span><span class="op">(</span><span class="va">epi_distribution</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Returning 122 results that match the criteria (99 are parameterised). 
Use subset to filter by entry variables or single_epidist to return a single entry. 
To retrieve the short citation for each use the 'get_citation' function</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 12 × 1
   epi_distribution            
   &lt;chr&gt;                       
 1 incubation period           
 2 serial interval             
 3 generation time             
 4 onset to death              
 5 offspring distribution      
 6 hospitalisation to death    
 7 hospitalisation to discharge
 8 notification to death       
 9 notification to discharge   
10 onset to discharge          
11 onset to hospitalisation    
12 onset to ventilation        </code></pre>
</div>
<div class="codewrapper sourceCode" id="cb50">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ebola_severity</span> <span class="op">&lt;-</span> <span class="fu">epidist_db</span><span class="op">(</span></span>
<span>  disease <span class="op">=</span> <span class="st">"ebola"</span>,</span>
<span>  epi_dist <span class="op">=</span> <span class="st">"onset to discharge"</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Returning 1 results that match the criteria (1 are parameterised). 
Use subset to filter by entry variables or single_epidist to return a single entry. 
To retrieve the short citation for each use the 'get_citation' function</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb52">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># point estimate</span></span>
<span><span class="va">ebola_severity</span><span class="op">$</span><span class="va">summary_stats</span><span class="op">$</span><span class="va">mean</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 15.1</code></pre>
</div>
<p>Check that for some <code>{epiparameter}</code> entries you will also
have the <em>uncertainty</em> around the <em>point estimate</em> of each
summary statistic:</p>
<div class="codewrapper sourceCode" id="cb54">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 95% confidence intervals</span></span>
<span><span class="va">ebola_severity</span><span class="op">$</span><span class="va">summary_stats</span><span class="op">$</span><span class="va">mean_ci</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 95</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb56">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># limits of the confidence intervals</span></span>
<span><span class="va">ebola_severity</span><span class="op">$</span><span class="va">summary_stats</span><span class="op">$</span><span class="va">mean_ci_limits</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 14.6 15.6</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="the-distribution-zoo" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="the-distribution-zoo" class="callout-inner">
<h3 class="callout-title">The distribution zoo<a class="anchor" aria-label="anchor" href="#the-distribution-zoo"></a>
</h3>
<div class="callout-content">
<p>Explore this shinyapp called <strong>The Distribution
Zoo</strong>!</p>
<p>Follow these steps to reproduce the form of the COVID serial interval
distribution from <code>{epiparameter}</code>
(<code>covid_serialint</code> object):</p>
<ol style="list-style-type: decimal">
<li>Access the <a href="https://ben18785.shinyapps.io/distribution-zoo/" class="external-link uri">https://ben18785.shinyapps.io/distribution-zoo/</a> shiny
app website,</li>
<li>Go to the left panel,</li>
<li>Keep the <em>Category of distribution</em>:
<code>Continuous Univariate</code>,</li>
<li>Select a new <em>Type of distribution</em>:
<code>Log-Normal</code>,</li>
<li>Move the <strong>sliders</strong>, i.e. the graphical control
element that allows you to adjust a value by moving a handle along a
horizontal track or bar to the <code>covid_serialint</code>
parameters.</li>
</ol>
<p>Replicate these with the <code>distribution</code> object and all its
list elements: <code>[[2]]</code>, <code>[[3]]</code>, and
<code>[[4]]</code>. Explore how the shape of a distribution changes when
its parameters change.</p>
<p>Share about:</p>
<ul>
<li>What other features of the website do you find helpful?</li>
</ul>
</div>
</div>
</div>
<div id="accordionInstructor3" class="accordion instructor-note accordion-flush">
<div class="accordion-item">
<button class="accordion-button instructor-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInstructor3" aria-expanded="false" aria-controls="collapseInstructor3">
  <h3 class="accordion-header" id="headingInstructor3">
<div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="edit-2"></i></div>Instructor Note</h3>
</button>
<div id="collapseInstructor3" class="accordion-collapse collapse" data-bs-parent="#accordionInstructor3" aria-labelledby="headingInstructor3">
<div class="accordion-body">
<p>In the context of user interfaces and graphical user interfaces
(GUIs), like the <a href="https://ben18785.shinyapps.io/distribution-zoo/" class="external-link">Distribution
Zoo</a> shiny app, a <strong>slider</strong> is a graphical control
element that allows users to adjust a value by moving a handle along a
track or bar. Conceptually, it provides a way to select a numeric value
within a specified range by visually sliding or dragging a pointer (the
handle) along a continuous axis.</p>
</div>
</div>
</div>
</div>
<!--
## Concept map

update it from last epiparameter test 
-->
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Use <code>{epiparameter}</code> to access the literature catalogue
of epidemiological delay distributions.</li>
<li>Use <code>epidist_db()</code> to select single delay
distributions.</li>
<li>Use <code>list_distributions()</code> for an overview of multiple
delay distributions.</li>
<li>Reuse known estimates for unknown disease in the early stage of an
outbreak when no contact tracing data is available.</li>
</ul>
</div>
</div>
</div>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</section></section><section id="aio-quantify-transmissibility"><p>Content from <a href="quantify-transmissibility.html">Quantifying transmission</a></p>
<hr>
<p>Last updated on 2024-06-17 |
        
        <a href="https://github.com/epiverse-trace/tutorials-early/edit/main/episodes/quantify-transmissibility.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 30 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can I estimate the time-varying reproduction number (<span class="math inline">\(Rt\)</span>) and growth rate from a time series of
case data?</li>
<li>How can I quantify geographical heterogeneity from these
transmission metrics?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Learn how to estimate transmission metrics from a time series of
case data using the R package <code>EpiNow2</code>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div id="prerequisites" class="callout prereq">
<div class="callout-square">
<i class="callout-icon" data-feather="check"></i>
</div>
<div id="prerequisites" class="callout-inner">
<h3 class="callout-title">Prerequisites<a class="anchor" aria-label="anchor" href="#prerequisites"></a>
</h3>
<div class="callout-content">
<p>Learners should familiarise themselves with following concepts before
working through this tutorial:</p>
<p><strong>Statistics</strong>: probability distributions, principle of
Bayesian analysis.</p>
<p><strong>Epidemic theory</strong>: Effective reproduction number.</p>
</div>
</div>
</div>
<div id="reminder-the-effective-reproduction-number-r_t" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="reminder-the-effective-reproduction-number-r_t" class="callout-inner">
<h3 class="callout-title">Reminder: the Effective Reproduction Number,<span class="math inline">\(R_t\)</span><a class="anchor" aria-label="anchor" href="#reminder-the-effective-reproduction-number-r_t"></a>
</h3>
<div class="callout-content">
<p>The <a href="reference.html#basic">basic reproduction number</a>,
<span class="math inline">\(R_0\)</span>, is the average number of cases
caused by one infectious individual in a entirely susceptible
population.</p>
<p>But in an ongoing outbreak, the population does not remain entirely
susceptible as those that recover from infection are typically immune.
Moreover, there can be changes in behaviour or other factors that affect
transmission. When we are interested in monitoring changes in
transmission we are therefore more interested in the value of the
<strong>effective reproduction number</strong>, <span class="math inline">\(R_t\)</span>, the average number of cases caused
by one infectious individual in the population at time <span class="math inline">\(t\)</span>.</p>
</div>
</div>
</div>
<section id="introduction"><h2 class="section-heading">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>The transmission intensity of an outbreak is quantified using two key
metrics: the reproduction number, which informs on the strength of the
transmission by indicating how many new cases are expected from each
existing case; and the <a href="reference.html#growth">growth rate</a>,
which informs on the speed of the transmission by indicating how rapidly
the outbreak is spreading or declining (doubling/halving time) within a
population. For more details on the distinction between speed and
strength of transmission and implications for control, review <a href="https://royalsocietypublishing.org/doi/full/10.1098/rspb.2020.1556" class="external-link">Dushoff
&amp; Park, 2021</a>.</p>
<p>To estimate these key metrics using case data we must account for
delays between the date of infections and date of reported cases. In an
outbreak situation, data are usually available on reported dates only,
therefore we must use estimation methods to account for these delays
when trying to understand changes in transmission over time.</p>
<p>In the next tutorials we will focus on how to use the functions in
<a href="https://epiforecasts.io/EpiNow2/" class="external-link">EpiNow2</a> to estimate transmission metrics of case data. We
will not cover the theoretical background of the models or inference
framework, for details on these concepts see the <a href="https://epiforecasts.io/EpiNow2/dev/articles/estimate_infections.html" class="external-link">vignette</a>.</p>
<p>In this tutorial we are going to learn how to use the
<a href="https://epiforecasts.io/EpiNow2/" class="external-link">EpiNow2</a> package to estimate the time-varying reproduction
number. We’ll use the <a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a> package to arrange some of
its inputs, <a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a> to visualize case distribution, and
the pipe <code>%&gt;%</code> to connect some of their functions, so
let’s also call to the <a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a> package:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">EpiNow2</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span></code></pre>
</div>
<div id="the-double-colon" class="callout checklist">
<div class="callout-square">
<i class="callout-icon" data-feather="check-square"></i>
</div>
<div id="the-double-colon" class="callout-inner">
<h3 class="callout-title">The double-colon<a class="anchor" aria-label="anchor" href="#the-double-colon"></a>
</h3>
<div class="callout-content">
<p>The double-colon <code>::</code> in R let you call a specific
function from a package without loading the entire package into the
current environment.</p>
<p>For example, <code>dplyr::filter(data, condition)</code> uses
<code>filter()</code> from the <a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a> package.</p>
<p>This help us remember package functions and avoid namespace
conflicts.</p>
</div>
</div>
</div>
<div id="accordionInstructor1" class="accordion instructor-note accordion-flush">
<div class="accordion-item">
<button class="accordion-button instructor-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInstructor1" aria-expanded="false" aria-controls="collapseInstructor1">
  <h3 class="accordion-header" id="headingInstructor1">
<div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="edit-2"></i></div>Instructor Note</h3>
</button>
<div id="collapseInstructor1" class="accordion-collapse collapse" data-bs-parent="#accordionInstructor1" aria-labelledby="headingInstructor1">
<div class="accordion-body">
<p>This tutorial illustrates the usage of <code>epinow()</code> to
estimate the time-varying reproduction number and infection times.
Learners should understand the necessary inputs to the model and the
limitations of the model output.</p>
</div>
</div>
</div>
</div>
<div id="bayesian-inference" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="bayesian-inference" class="callout-inner">
<h3 class="callout-title">Bayesian inference<a class="anchor" aria-label="anchor" href="#bayesian-inference"></a>
</h3>
<div class="callout-content">
<p>The R package <code>EpiNow2</code> uses a <a href="reference.html#bayesian">Bayesian inference</a> framework to
estimate reproduction numbers and infection times based on reporting
dates.</p>
<p>In Bayesian inference, we use prior knowledge (prior distributions)
with data (in a likelihood function) to find the posterior
probability.</p>
<p class="text-center" style="background-color: white">
Posterior probability <span class="math inline">\(\propto\)</span>
likelihood <span class="math inline">\(\times\)</span> prior probability
</p>
</div>
</div>
</div>
<div id="accordionInstructor2" class="accordion instructor-note accordion-flush">
<div class="accordion-item">
<button class="accordion-button instructor-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInstructor2" aria-expanded="false" aria-controls="collapseInstructor2">
  <h3 class="accordion-header" id="headingInstructor2">
<div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="edit-2"></i></div>Instructor Note</h3>
</button>
<div id="collapseInstructor2" class="accordion-collapse collapse" data-bs-parent="#accordionInstructor2" aria-labelledby="headingInstructor2">
<div class="accordion-body">
<p>Refer to the prior probability distribution and the <a href="https://en.wikipedia.org/wiki/Posterior_probability" class="external-link">posterior
probability</a> distribution.</p>
<p>In the <a href="#expected-change-in-daily-cases">“<code>Expected change in daily cases</code>”
callout</a>, by “the posterior probability that <span class="math inline">\(R_t &lt; 1\)</span>”, we refer specifically to the
<a href="https://www.nature.com/articles/nmeth.3368/figures/1" class="external-link">area
under the posterior probability distribution curve</a>.</p>
</div>
</div>
</div>
</div>
</section><section id="delay-distributions-and-case-data"><h2 class="section-heading">Delay distributions and case data<a class="anchor" aria-label="anchor" href="#delay-distributions-and-case-data"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="case-data">Case data<a class="anchor" aria-label="anchor" href="#case-data"></a>
</h3>
<p>To illustrate the functions of <code>EpiNow2</code> we will use
outbreak data of the start of the COVID-19 pandemic from the United
Kingdom. The data are available in the R package
<a href="https://www.reconverse.org/incidence2/" class="external-link">incidence2</a>.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu">as_tibble</span><span class="op">(</span><span class="fu">incidence2</span><span class="fu">::</span><span class="va">covidregionaldataUK</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 6,370 × 13
   date       region   region_code cases_new cases_total deaths_new deaths_total
   &lt;date&gt;     &lt;chr&gt;    &lt;chr&gt;           &lt;dbl&gt;       &lt;dbl&gt;      &lt;dbl&gt;        &lt;dbl&gt;
 1 2020-01-30 East Mi… E12000004          NA          NA         NA           NA
 2 2020-01-30 East of… E12000006          NA          NA         NA           NA
 3 2020-01-30 England  E92000001           2           2         NA           NA
 4 2020-01-30 London   E12000007          NA          NA         NA           NA
 5 2020-01-30 North E… E12000001          NA          NA         NA           NA
 6 2020-01-30 North W… E12000002          NA          NA         NA           NA
 7 2020-01-30 Norther… N92000002          NA          NA         NA           NA
 8 2020-01-30 Scotland S92000003          NA          NA         NA           NA
 9 2020-01-30 South E… E12000008          NA          NA         NA           NA
10 2020-01-30 South W… E12000009          NA          NA         NA           NA
# ℹ 6,360 more rows
# ℹ 6 more variables: recovered_new &lt;dbl&gt;, recovered_total &lt;dbl&gt;,
#   hosp_new &lt;dbl&gt;, hosp_total &lt;dbl&gt;, tested_new &lt;dbl&gt;, tested_total &lt;dbl&gt;</code></pre>
</div>
<p>To use the data, we must format the data to have two columns:</p>
<ul>
<li>
<code>date</code>: the date (as a date object see
<code>?is.Date()</code>),</li>
<li>
<code>confirm</code>: number of confirmed cases on that date.</li>
</ul>
<p>Let’s use <a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a> for this:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">dplyr</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cases</span> <span class="op">&lt;-</span> <span class="fu">incidence2</span><span class="fu">::</span><span class="va">covidregionaldataUK</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">date</span>, <span class="va">cases_new</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">date</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>confirm <span class="op">=</span> <span class="fu">sum</span><span class="op">(</span><span class="va">cases_new</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div id="accordionSpoiler1" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler1" aria-expanded="false" aria-controls="collapseSpoiler1">
  <h3 class="accordion-header" id="headingSpoiler1">
<div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div>When to use incidence2?</h3>
</button>
<div id="collapseSpoiler1" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler1" aria-labelledby="headingSpoiler1">
<div class="accordion-body">
<p>We can also use the <a href="https://www.reconverse.org/incidence2/" class="external-link">incidence2</a> package to:</p>
<ul>
<li><p>Aggregate cases (similar to the code above) but in different time
<em>intervals</em> (i.e., days, weeks or months) or per <em>group</em>
categories. Explore later the <a href="https://www.reconverse.org/incidence2/reference/incidence.html" class="external-link"><code>incidence2::incidence()</code>
reference manual</a>.</p></li>
<li><p>Complete dates for all the range of dates per group category
using <code>incidence2::complete_dates()</code>. Read further in its <a href="https://www.reconverse.org/incidence2/reference/complete_dates.html" class="external-link">function
reference manual</a>.</p></li>
</ul>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">tidyr</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">dplyr</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">incidence2</span><span class="fu">::</span><span class="va">covidregionaldataUK</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co"># preprocess missing values</span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu">replace_na</span><span class="op">(</span><span class="fu">list</span><span class="op">(</span>cases_new <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co"># compute the daily incidence</span></span>
<span>  <span class="fu">incidence2</span><span class="fu">::</span><span class="fu">incidence</span><span class="op">(</span></span>
<span>    date_index <span class="op">=</span> <span class="st">"date"</span>,</span>
<span>    counts <span class="op">=</span> <span class="st">"cases_new"</span>,</span>
<span>    count_values_to <span class="op">=</span> <span class="st">"confirm"</span>,</span>
<span>    date_names_to <span class="op">=</span> <span class="st">"date"</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co"># complete range of dates</span></span>
<span>  <span class="fu">incidence2</span><span class="fu">::</span><span class="fu">complete_dates</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<p>There are case data available for 490 days, but in an outbreak
situation it is likely we would only have access to the beginning of
this data set. Therefore we assume we only have the first 90 days of
this data.</p>
<figure><img src="../fig/quantify-transmissibility-rendered-unnamed-chunk-5-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
<div class="section level3">
<h3 id="delay-distributions">Delay distributions<a class="anchor" aria-label="anchor" href="#delay-distributions"></a>
</h3>
<p>We assume there are delays from the time of infection until the time
a case is reported. We specify these delays as distributions to account
for the uncertainty in individual level differences. The delay can
consist of multiple types of delays/processes. A typical delay from time
of infection to case reporting may consist of:</p>
<p class="text-center" style="background-color: aliceblue">
<strong>time from infection to symptom onset</strong> (the <a href="reference.html#incubation">incubation period</a>) + <strong>time
from symptom onset to case notification</strong> (the reporting time) .
</p>
<p>The delay distribution for each of these processes can either
estimated from data or obtained from the literature. We can express
uncertainty about what the correct parameters of the distributions by
assuming the distributions have <strong>fixed</strong> parameters or
whether they have <strong>variable</strong> parameters. To understand
the difference between <strong>fixed</strong> and
<strong>variable</strong> distributions, let’s consider the incubation
period.</p>
<div id="delays-and-data" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="delays-and-data" class="callout-inner">
<h3 class="callout-title">Delays and data<a class="anchor" aria-label="anchor" href="#delays-and-data"></a>
</h3>
<div class="callout-content">
<p>The number of delays and type of delay are a flexible input that
depend on the data. The examples below highlight how the delays can be
specified for different data sources:</p>
<center>
<table class="table">
<colgroup>
<col width="50%">
<col width="50%">
</colgroup>
<thead><tr class="header">
<th>Data source</th>
<th>Delay(s)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Time of symptom onset</td>
<td>Incubation period</td>
</tr>
<tr class="even">
<td>Time of case report</td>
<td>Incubation period + time from symptom onset to case
notification</td>
</tr>
<tr class="odd">
<td>Time of hospitalisation</td>
<td>Incubation period + time from symptom onset to hospitalisation</td>
</tr>
</tbody>
</table>
</center>
</div>
</div>
</div>
<div class="section level4">
<h4 id="incubation-period-distribution">Incubation period distribution<a class="anchor" aria-label="anchor" href="#incubation-period-distribution"></a>
</h4>
<p>The distribution of incubation period for many diseases can usually
be obtained from the literature. The package <code>{epiparameter}</code>
contains a library of epidemiological parameters for different diseases
obtained from the literature.</p>
<p>We specify a (fixed) gamma distribution with mean <span class="math inline">\(\mu = 4\)</span> and standard deviation <span class="math inline">\(\sigma= 2\)</span> (shape = <span class="math inline">\(4\)</span>, scale = <span class="math inline">\(1\)</span>) using the function
<code>dist_spec()</code> as follows:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">incubation_period_fixed</span> <span class="op">&lt;-</span> <span class="fu">dist_spec</span><span class="op">(</span></span>
<span>  mean <span class="op">=</span> <span class="fl">4</span>, sd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  max <span class="op">=</span> <span class="fl">20</span>, distribution <span class="op">=</span> <span class="st">"gamma"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">incubation_period_fixed</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
  Fixed distribution with PMF [0.019 0.12 0.21 0.21 0.17 0.11 0.069 0.039 0.021 0.011 0.0054 0.0026 0.0012 0.00058 0.00026 0.00012 5.3e-05 2.3e-05 1e-05 4.3e-06]</code></pre>
</div>
<p>The argument <code>max</code> is the maximum value the distribution
can take, in this example 20 days.</p>
<div id="why-a-gamma-distrubution" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="why-a-gamma-distrubution" class="callout-inner">
<h3 class="callout-title">Why a gamma distrubution?<a class="anchor" aria-label="anchor" href="#why-a-gamma-distrubution"></a>
</h3>
<div class="callout-content">
<p>The incubation period has to be positive in value. Therefore we must
specific a distribution in <code>dist_spec</code> which is for positive
values only.</p>
<p><code>dist_spec()</code> supports log normal and gamma distributions,
which are distributions for positive values only.</p>
<p>For all types of delay, we will need to use distributions for
positive values only - we don’t want to include delays of negative days
in our analysis!</p>
</div>
</div>
</div>
</div>
<div class="section level4">
<h4 id="including-distribution-uncertainty">Including distribution uncertainty<a class="anchor" aria-label="anchor" href="#including-distribution-uncertainty"></a>
</h4>
<p>To specify a <strong>variable</strong> distribution, we include
uncertainty around the mean <span class="math inline">\(\mu\)</span> and
standard deviation <span class="math inline">\(\sigma\)</span> of our
gamma distribution. If our incubation period distribution has a mean
<span class="math inline">\(\mu\)</span> and standard deviation <span class="math inline">\(\sigma\)</span>, then we assume the mean (<span class="math inline">\(\mu\)</span>) follows a Normal distribution with
standard deviation <span class="math inline">\(\sigma_{\mu}\)</span>:</p>
<p><span class="math display">\[\mbox{Normal}(\mu,\sigma_{\mu}^2)\]</span></p>
<p>and a standard deviation (<span class="math inline">\(\sigma\)</span>) follows a Normal distribution
with standard deviation <span class="math inline">\(\sigma_{\sigma}\)</span>:</p>
<p><span class="math display">\[\mbox{Normal}(\sigma,\sigma_{\sigma}^2).\]</span></p>
<p>We specify this using <code>dist_spec</code> with the additional
arguments <code>mean_sd</code> (<span class="math inline">\(\sigma_{\mu}\)</span>) and <code>sd_sd</code>
(<span class="math inline">\(\sigma_{\sigma}\)</span>).</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">incubation_period_variable</span> <span class="op">&lt;-</span> <span class="fu">dist_spec</span><span class="op">(</span></span>
<span>  mean <span class="op">=</span> <span class="fl">4</span>, sd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  mean_sd <span class="op">=</span> <span class="fl">0.5</span>, sd_sd <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  max <span class="op">=</span> <span class="fl">20</span>, distribution <span class="op">=</span> <span class="st">"gamma"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">incubation_period_variable</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
  Uncertain gamma distribution with (untruncated) mean 4 (SD 0.5) and SD 2 (SD 0.5)</code></pre>
</div>
</div>
<div class="section level4">
<h4 id="reporting-delays">Reporting delays<a class="anchor" aria-label="anchor" href="#reporting-delays"></a>
</h4>
<p>After the incubation period, there will be an additional delay of
time from symptom onset to case notification: the reporting delay. We
can specify this as a fixed or variable distribution, or estimate a
distribution from data.</p>
<p>When specifying a distribution, it is useful to visualise the
probability density to see the peak and spread of the distribution, in
this case we will use a log normal distribution. We can use the
functions <code>convert_to_logmean()</code> and
<code>convert_to_logsd()</code> to convert the mean and standard
deviation of a normal distribution to that of a log normal
distribution.</p>
<p>If we want to assume that the mean reporting delay is 2 days (with a
standard deviation of 1 day), the log normal distribution will look
like:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">log_mean</span> <span class="op">&lt;-</span> <span class="fu">convert_to_logmean</span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">log_sd</span> <span class="op">&lt;-</span> <span class="fu">convert_to_logsd</span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">seq</span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">10</span>, length <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, density <span class="op">=</span> <span class="fu">dlnorm</span><span class="op">(</span><span class="va">x</span>, meanlog <span class="op">=</span> <span class="va">log_mean</span>, sdlog <span class="op">=</span> <span class="va">log_sd</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span></span>
<span>    <span class="fu">aes</span><span class="op">(</span><span class="va">x</span>, <span class="va">density</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_grey</span><span class="op">(</span></span>
<span>    base_size <span class="op">=</span> <span class="fl">15</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/quantify-transmissibility-rendered-unnamed-chunk-8-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Using the mean and standard deviation for the log normal
distribution, we can specify a fixed or variable distribution using
<code>dist_spec()</code> as before:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">reporting_delay_variable</span> <span class="op">&lt;-</span> <span class="fu">dist_spec</span><span class="op">(</span></span>
<span>  mean <span class="op">=</span> <span class="va">log_mean</span>, sd <span class="op">=</span> <span class="va">log_sd</span>,</span>
<span>  mean_sd <span class="op">=</span> <span class="fl">0.5</span>, sd_sd <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  max <span class="op">=</span> <span class="fl">10</span>, distribution <span class="op">=</span> <span class="st">"lognormal"</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<p>If data is available on the time between symptom onset and reporting,
we can use the function <code>estimate_delay()</code> to estimate a log
normal distribution from a vector of delays. The code below illustrates
how to use <code>estimate_delay()</code> with synthetic delay data.</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">delay_data</span> <span class="op">&lt;-</span> <span class="fu">rlnorm</span><span class="op">(</span><span class="fl">500</span>, <span class="fu">log</span><span class="op">(</span><span class="fl">5</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span> <span class="co"># synthetic delay data</span></span>
<span><span class="va">reporting_delay</span> <span class="op">&lt;-</span> <span class="fu">estimate_delay</span><span class="op">(</span></span>
<span>  <span class="va">delay_data</span>,</span>
<span>  samples <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  bootstraps <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="section level4">
<h4 id="generation-time">Generation time<a class="anchor" aria-label="anchor" href="#generation-time"></a>
</h4>
<p>We also must specify a distribution for the generation time. Here we
will use a log normal distribution with mean 3.6 and standard deviation
3.1 (<a href="https://doi.org/10.2807/1560-7917.ES.2020.25.17.2000257" class="external-link">Ganyani
et al. 2020</a>).</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">generation_time_variable</span> <span class="op">&lt;-</span> <span class="fu">dist_spec</span><span class="op">(</span></span>
<span>  mean <span class="op">=</span> <span class="fl">3.6</span>, sd <span class="op">=</span> <span class="fl">3.1</span>,</span>
<span>  mean_sd <span class="op">=</span> <span class="fl">0.5</span>, sd_sd <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  max <span class="op">=</span> <span class="fl">20</span>, distribution <span class="op">=</span> <span class="st">"lognormal"</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</section><section id="finding-estimates"><h2 class="section-heading">Finding estimates<a class="anchor" aria-label="anchor" href="#finding-estimates"></a>
</h2>
<hr class="half-width">
<p>The function <code>epinow()</code> is a wrapper for the function
<code>estimate_infections()</code> used to estimate cases by date of
infection. The generation time distribution and delay distributions must
be passed using the functions <code>generation_time_opts()</code> and
<code>delay_opts()</code> respectively.</p>
<p>There are numerous other inputs that can be passed to
<code>epinow()</code>, see <code>EpiNow2::?epinow()</code> for more
detail. One optional input is to specify a log normal prior for the
effective reproduction number <span class="math inline">\(R_t\)</span>
at the start of the outbreak. We specify a mean and standard deviation
as arguments of <code>prior</code> within <code>rt_opts()</code>:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rt_log_mean</span> <span class="op">&lt;-</span> <span class="fu">convert_to_logmean</span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">rt_log_sd</span> <span class="op">&lt;-</span> <span class="fu">convert_to_logsd</span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">rt</span> <span class="op">&lt;-</span> <span class="fu">rt_opts</span><span class="op">(</span>prior <span class="op">=</span> <span class="fu">list</span><span class="op">(</span>mean <span class="op">=</span> <span class="va">rt_log_mean</span>, sd <span class="op">=</span> <span class="va">rt_log_sd</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div id="bayesian-inference-using-stan" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="bayesian-inference-using-stan" class="callout-inner">
<h3 class="callout-title">Bayesian inference using Stan<a class="anchor" aria-label="anchor" href="#bayesian-inference-using-stan"></a>
</h3>
<div class="callout-content">
<p>The Bayesian inference is performed using MCMC methods with the
program <a href="https://mc-stan.org/" class="external-link">Stan</a>. There are a number of
default inputs to the Stan functions including the number of chains and
number of samples per chain (see
<code>?EpiNow2::stan_opts()</code>).</p>
<p>To reduce computation time, we can run chains in parallel. To do
this, we must set the number of cores to be used. By default, 4 MCMC
chains are run (see <code>stan_opts()$chains</code>), so we can set an
equal number of cores to be used in parallel as follows:</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">withr</span><span class="fu">::</span><span class="fu">local_options</span><span class="op">(</span><span class="fu">list</span><span class="op">(</span>mc.cores <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>To find the maximum number of available cores on your machine, use
<code>parallel::detectCores()</code>.</p>
</div>
</div>
</div>
<div id="checklist2" class="callout checklist">
<div class="callout-square">
<i class="callout-icon" data-feather="check-square"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Checklist<a class="anchor" aria-label="anchor" href="#checklist2"></a>
</h3>
<div class="callout-content">
<p><strong>Note:</strong> In the code below <code>_fixed</code>
distributions are used instead of <code>_variable</code> (delay
distributions with uncertainty). This is to speed up computation time.
It is generally recommended to use variable distributions that account
for additional uncertainty.</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># fixed alternatives</span></span>
<span><span class="va">generation_time_fixed</span> <span class="op">&lt;-</span> <span class="fu">dist_spec</span><span class="op">(</span></span>
<span>  mean <span class="op">=</span> <span class="fl">3.6</span>, sd <span class="op">=</span> <span class="fl">3.1</span>,</span>
<span>  max <span class="op">=</span> <span class="fl">20</span>, distribution <span class="op">=</span> <span class="st">"lognormal"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">reporting_delay_fixed</span> <span class="op">&lt;-</span> <span class="fu">dist_spec</span><span class="op">(</span></span>
<span>  mean <span class="op">=</span> <span class="va">log_mean</span>, sd <span class="op">=</span> <span class="va">log_sd</span>,</span>
<span>  max <span class="op">=</span> <span class="fl">10</span>, distribution <span class="op">=</span> <span class="st">"lognormal"</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
<p>Now you are ready to run <code>EpiNow2::epinow()</code> to estimate
the time-varying reproduction number:</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">reported_cases</span> <span class="op">&lt;-</span> <span class="va">cases</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">90</span>, <span class="op">]</span></span>
<span></span>
<span><span class="va">estimates</span> <span class="op">&lt;-</span> <span class="fu">epinow</span><span class="op">(</span></span>
<span>  <span class="co"># cases</span></span>
<span>  reported_cases <span class="op">=</span> <span class="va">reported_cases</span>,</span>
<span>  <span class="co"># delays</span></span>
<span>  generation_time <span class="op">=</span> <span class="fu">generation_time_opts</span><span class="op">(</span><span class="va">generation_time_fixed</span><span class="op">)</span>,</span>
<span>  delays <span class="op">=</span> <span class="fu">delay_opts</span><span class="op">(</span><span class="va">incubation_period_fixed</span> <span class="op">+</span> <span class="va">reporting_delay_fixed</span><span class="op">)</span>,</span>
<span>  <span class="co"># prior</span></span>
<span>  rt <span class="op">=</span> <span class="fu">rt_opts</span><span class="op">(</span>prior <span class="op">=</span> <span class="fu">list</span><span class="op">(</span>mean <span class="op">=</span> <span class="va">rt_log_mean</span>, sd <span class="op">=</span> <span class="va">rt_log_sd</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="co"># computation (optional)</span></span>
<span>  stan <span class="op">=</span> <span class="fu">stan_opts</span><span class="op">(</span>samples <span class="op">=</span> <span class="fl">1000</span>, chains <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>WARN [2024-06-17 20:58:18] epinow: There were 9 divergent transitions after warmup. See
https://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup
to find out why this is a problem and how to eliminate them. - 
WARN [2024-06-17 20:58:18] epinow: Examine the pairs() plot to diagnose sampling problems
 - 
WARN [2024-06-17 20:58:19] epinow: Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable.
Running the chains for more iterations may help. See
https://mc-stan.org/misc/warnings.html#bulk-ess - </code></pre>
</div>
<div id="do-not-wait-for-this-to-continue" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="do-not-wait-for-this-to-continue" class="callout-inner">
<h3 class="callout-title">Do not wait for this to continue<a class="anchor" aria-label="anchor" href="#do-not-wait-for-this-to-continue"></a>
</h3>
<div class="callout-content">
<p>Using <code>stan = stan_opts()</code> is optional. For the purpose of
this tutorial on reducing computation time, we specified a fixed number
of <code>samples = 1000</code> and <code>chains = 3</code> to the
<code>stan</code> argument using the <code>stan_opts()</code> function.
We expect this to take approximately 3 minutes.</p>
<p><strong>Remember:</strong> Using an appropriate number of
<em>samples</em> and <em>chains</em> is crucial for ensuring convergence
and obtaining reliable estimates in Bayesian computations using Stan.
Inadequate sampling or insufficient chains may lead to issues such as
divergent transitions, impacting the accuracy and stability of the
inference process.</p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="results">Results<a class="anchor" aria-label="anchor" href="#results"></a>
</h3>
<p>We can extract and visualise estimates of the effective reproduction
number through time:</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">estimates</span><span class="op">$</span><span class="va">plots</span><span class="op">$</span><span class="va">R</span></span></code></pre>
</div>
<figure><img src="../fig/quantify-transmissibility-rendered-unnamed-chunk-16-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>The uncertainty in the estimates increases through time. This is
because estimates are informed by data in the past - within the delay
periods. This difference in uncertainty is categorised into
<strong>Estimate</strong> (green) utilises all data and <strong>Estimate
based on partial data</strong> (orange) estimates that are based on less
data (because infections that happened at the time are more likely to
not have been observed yet) and therefore have increasingly wider
intervals towards the date of the last data point. Finally, the
<strong>Forecast</strong> (purple) is a projection ahead of time.</p>
<p>We can also visualise the growth rate estimate through time:</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">estimates</span><span class="op">$</span><span class="va">plots</span><span class="op">$</span><span class="va">growth_rate</span></span></code></pre>
</div>
<figure><img src="../fig/quantify-transmissibility-rendered-unnamed-chunk-17-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>To extract a summary of the key transmission metrics at the
<em>latest date</em> in the data:</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">summary</span><span class="op">(</span><span class="va">estimates</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>                                 measure                 estimate
                                  &lt;char&gt;                   &lt;char&gt;
1: New confirmed cases by infection date     7301 (4102 -- 12577)
2:        Expected change in daily cases        Likely decreasing
3:            Effective reproduction no.        0.9 (0.57 -- 1.3)
4:                        Rate of growth -0.013 (-0.064 -- 0.035)
5:          Doubling/halving time (days)          -52 (20 -- -11)</code></pre>
</div>
<p>As these estimates are based on partial data, they have a wide
uncertainty interval.</p>
<ul>
<li><p>From the summary of our analysis we see that the expected change
in daily cases is Likely decreasing with the estimated new confirmed
cases 7301 (4102 – 12577).</p></li>
<li><p>The effective reproduction number <span class="math inline">\(R_t\)</span> estimate (on the last date of the
data) is 0.9 (0.57 – 1.3).</p></li>
<li><p>The exponential growth rate of case numbers is -0.013 (-0.064 –
0.035).</p></li>
<li><p>The doubling time (the time taken for case numbers to double) is
-52 (20 – -11).</p></li>
</ul>
<div id="expected-change-in-daily-cases" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="expected-change-in-daily-cases" class="callout-inner">
<h3 class="callout-title">
<code>Expected change in daily cases</code><a class="anchor" aria-label="anchor" href="#expected-change-in-daily-cases"></a>
</h3>
<div class="callout-content">
<p>A factor describing expected change in daily cases based on the
posterior probability that <span class="math inline">\(R_t &lt;
1\)</span>.</p>
<center>
<table class="table">
<thead><tr class="header">
<th>Probability (<span class="math inline">\(p\)</span>)</th>
<th>Expected change</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(p &lt; 0.05\)</span></td>
<td>Increasing</td>
</tr>
<tr class="even">
<td><span class="math inline">\(0.05 \leq p&lt; 0.4\)</span></td>
<td>Likely increasing</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(0.4 \leq p&lt; 0.6\)</span></td>
<td>Stable</td>
</tr>
<tr class="even">
<td><span class="math inline">\(0.6 \leq p &lt; 0.95\)</span></td>
<td>Likely decreasing</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(0.95 \leq p \leq 1\)</span></td>
<td>Decreasing</td>
</tr>
</tbody>
</table>
</center>
</div>
</div>
</div>
</div>
</section><section id="quantify-geographical-heterogeneity"><h2 class="section-heading">Quantify geographical heterogeneity<a class="anchor" aria-label="anchor" href="#quantify-geographical-heterogeneity"></a>
</h2>
<hr class="half-width">
<p>The outbreak data of the start of the COVID-19 pandemic from the
United Kingdom from the R package <a href="https://www.reconverse.org/incidence2/" class="external-link">incidence2</a> includes the
region in which the cases were recorded. To find regional estimates of
the effective reproduction number and cases, we must format the data to
have three columns:</p>
<ul>
<li>
<code>date</code>: the date,</li>
<li>
<code>region</code>: the region,</li>
<li>
<code>confirm</code>: number of confirmed cases for a region on a
given date.</li>
</ul>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">regional_cases</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">incidence2</span><span class="fu">::</span><span class="va">covidregionaldataUK</span><span class="op">[</span>, <span class="fu">c</span><span class="op">(</span><span class="st">"date"</span>, <span class="st">"cases_new"</span>, <span class="st">"region"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu">colnames</span><span class="op">(</span><span class="va">regional_cases</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"date"</span>, <span class="st">"confirm"</span>, <span class="st">"region"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># extract the first 90 dates for all regions</span></span>
<span><span class="va">dates</span> <span class="op">&lt;-</span> <span class="fu">sort</span><span class="op">(</span><span class="fu">unique</span><span class="op">(</span><span class="va">regional_cases</span><span class="op">$</span><span class="va">date</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">90</span><span class="op">]</span></span>
<span><span class="va">regional_cases</span> <span class="op">&lt;-</span> <span class="va">regional_cases</span><span class="op">[</span><span class="fu">which</span><span class="op">(</span><span class="va">regional_cases</span><span class="op">$</span><span class="va">date</span> <span class="op">%in%</span> <span class="va">dates</span><span class="op">)</span>, <span class="op">]</span></span>
<span></span>
<span><span class="fu">head</span><span class="op">(</span><span class="va">regional_cases</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>        date confirm          region
1 2020-01-30      NA   East Midlands
2 2020-01-30      NA East of England
3 2020-01-30       2         England
4 2020-01-30      NA          London
5 2020-01-30      NA      North East
6 2020-01-30      NA      North West</code></pre>
</div>
<p>To find regional estimates, we use the same inputs as
<code>epinow()</code> to the function
<code>regional_epinow()</code>:</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">estimates_regional</span> <span class="op">&lt;-</span> <span class="fu">regional_epinow</span><span class="op">(</span></span>
<span>  <span class="co"># cases</span></span>
<span>  reported_cases <span class="op">=</span> <span class="va">regional_cases</span>,</span>
<span>  <span class="co"># delays</span></span>
<span>  generation_time <span class="op">=</span> <span class="fu">generation_time_opts</span><span class="op">(</span><span class="va">generation_time_fixed</span><span class="op">)</span>,</span>
<span>  delays <span class="op">=</span> <span class="fu">delay_opts</span><span class="op">(</span><span class="va">incubation_period_fixed</span> <span class="op">+</span> <span class="va">reporting_delay_fixed</span><span class="op">)</span>,</span>
<span>  <span class="co"># prior</span></span>
<span>  rt <span class="op">=</span> <span class="fu">rt_opts</span><span class="op">(</span>prior <span class="op">=</span> <span class="fu">list</span><span class="op">(</span>mean <span class="op">=</span> <span class="va">rt_log_mean</span>, sd <span class="op">=</span> <span class="va">rt_log_sd</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>INFO [2024-06-17 20:58:21] Producing following optional outputs: regions, summary, samples, plots, latest
INFO [2024-06-17 20:58:22] Reporting estimates using data up to: 2020-04-28
INFO [2024-06-17 20:58:22] No target directory specified so returning output
INFO [2024-06-17 20:58:22] Producing estimates for: East Midlands, East of England, England, London, North East, North West, Northern Ireland, Scotland, South East, South West, Wales, West Midlands, Yorkshire and The Humber
INFO [2024-06-17 20:58:22] Regions excluded: none
INFO [2024-06-17 21:43:06] Completed regional estimates
INFO [2024-06-17 21:43:06] Regions with estimates: 13
INFO [2024-06-17 21:43:06] Regions with runtime errors: 0
INFO [2024-06-17 21:43:06] Producing summary
INFO [2024-06-17 21:43:06] No summary directory specified so returning summary output
INFO [2024-06-17 21:43:07] No target directory specified so returning timings</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">estimates_regional</span><span class="op">$</span><span class="va">summary</span><span class="op">$</span><span class="va">summarised_results</span><span class="op">$</span><span class="va">table</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>                      Region New confirmed cases by infection date
                      &lt;char&gt;                                &lt;char&gt;
 1:            East Midlands                      344 (212 -- 553)
 2:          East of England                      542 (327 -- 833)
 3:                  England                   3548 (2229 -- 5440)
 4:                   London                      294 (189 -- 457)
 5:               North East                      253 (144 -- 427)
 6:               North West                      555 (331 -- 861)
 7:         Northern Ireland                         43 (22 -- 82)
 8:                 Scotland                      290 (167 -- 526)
 9:               South East                      593 (348 -- 987)
10:               South West                      418 (302 -- 611)
11:                    Wales                        95 (63 -- 141)
12:            West Midlands                      269 (150 -- 490)
13: Yorkshire and The Humber                      477 (290 -- 778)
    Expected change in daily cases Effective reproduction no.
                            &lt;fctr&gt;                     &lt;char&gt;
 1:              Likely increasing          1.2 (0.85 -- 1.6)
 2:              Likely increasing          1.2 (0.83 -- 1.6)
 3:              Likely decreasing         0.91 (0.64 -- 1.2)
 4:              Likely decreasing         0.79 (0.56 -- 1.1)
 5:              Likely decreasing         0.91 (0.59 -- 1.3)
 6:              Likely decreasing         0.86 (0.58 -- 1.2)
 7:              Likely decreasing           0.64 (0.38 -- 1)
 8:              Likely decreasing         0.92 (0.62 -- 1.4)
 9:                         Stable         0.99 (0.67 -- 1.4)
10:                     Increasing           1.4 (1.1 -- 1.8)
11:                     Decreasing        0.57 (0.41 -- 0.78)
12:              Likely decreasing          0.7 (0.44 -- 1.1)
13:                         Stable            1 (0.71 -- 1.4)
                Rate of growth Doubling/halving time (days)
                        &lt;char&gt;                       &lt;char&gt;
 1:    0.024 (-0.021 -- 0.069)               29 (10 -- -33)
 2:    0.022 (-0.023 -- 0.066)               31 (10 -- -30)
 3:   -0.012 (-0.052 -- 0.029)              -59 (24 -- -13)
 4:   -0.029 (-0.066 -- 0.011)              -24 (62 -- -10)
 5:    -0.012 (-0.06 -- 0.036)              -58 (19 -- -12)
 6:   -0.018 (-0.063 -- 0.021)              -38 (32 -- -11)
 7:    -0.053 (-0.1 -- 0.0044)            -13 (160 -- -6.8)
 8:   -0.011 (-0.056 -- 0.043)              -64 (16 -- -12)
 9: -0.00099 (-0.048 -- 0.048)             -700 (14 -- -14)
10:     0.047 (0.015 -- 0.085)               15 (8.1 -- 46)
11:  -0.065 (-0.094 -- -0.031)            -11 (-22 -- -7.4)
12:   -0.042 (-0.088 -- 0.011)             -16 (61 -- -7.8)
13:   0.0026 (-0.041 -- 0.051)              260 (14 -- -17)</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">estimates_regional</span><span class="op">$</span><span class="va">summary</span><span class="op">$</span><span class="va">plots</span><span class="op">$</span><span class="va">R</span></span></code></pre>
</div>
<figure><img src="../fig/quantify-transmissibility-rendered-unnamed-chunk-20-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="the-i2extras-package" class="callout testimonial">
<div class="callout-square">
<i class="callout-icon" data-feather="heart"></i>
</div>
<div id="the-i2extras-package" class="callout-inner">
<h3 class="callout-title">the i2extras package<a class="anchor" aria-label="anchor" href="#the-i2extras-package"></a>
</h3>
<div class="callout-content">
<p><a href="https://www.reconverse.org/i2extras/" class="external-link">i2extras</a> package also estimate transmission metrics
like growth rate and doubling/halving time at different time intervals
(i.e., days, weeks, or months). <a href="https://www.reconverse.org/i2extras/" class="external-link">i2extras</a> require
<a href="https://www.reconverse.org/incidence2/" class="external-link">incidence2</a> objects as inputs. Read further in its <a href="https://www.reconverse.org/i2extras/articles/fitting_epicurves.html" class="external-link">Fitting
curves</a> vignette.</p>
</div>
</div>
</div>
</section><section id="summary"><h2 class="section-heading">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<hr class="half-width">
<p><code>EpiNow2</code> can be used to estimate transmission metrics
from case data at any time in the course of an outbreak. The reliability
of these estimates depends on the quality of the data and appropriate
choice of delay distributions. In the next tutorial we will learn how to
make forecasts and investigate some of the additional inference options
available in <code>EpiNow2</code>.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Transmission metrics can be estimated from case data after
accounting for delays</li>
<li>Uncertainty can be accounted for in delay distributions</li>
</ul>
</div>
</div>
</div>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</section></section><section id="aio-delays-functions"><p>Content from <a href="delays-functions.html">Use delay distributions in analysis</a></p>
<hr>
<p>Last updated on 2024-06-17 |
        
        <a href="https://github.com/epiverse-trace/tutorials-early/edit/main/episodes/delays-functions.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 30 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How to reuse delays stored in the <code>{epiparameter}</code>
library with my existing analysis pipeline?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Use distribution functions to continuous and discrete distributions
stored as <code>&lt;epidist&gt;</code> objects.</li>
<li>Convert a continuous to a discrete distribution with
<code>{epiparameter}</code>.</li>
<li>Connect <code>{epiparameter}</code> outputs with
<a href="https://epiforecasts.io/EpiNow2/" class="external-link">EpiNow2</a> inputs.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div id="prerequisites" class="callout prereq">
<div class="callout-square">
<i class="callout-icon" data-feather="check"></i>
</div>
<div id="prerequisites" class="callout-inner">
<h3 class="callout-title">Prerequisites<a class="anchor" aria-label="anchor" href="#prerequisites"></a>
</h3>
<div class="callout-content">
<ul>
<li>Complete tutorial <a href="https://epiverse-trace.github.io/tutorials-middle/quantify-transmissibility.html" class="external-link">Quantifying
transmission</a>
</li>
</ul>
<p>This episode requires you to be familiar with:</p>
<p><strong>Data science</strong> : Basic programming with R.</p>
<p><strong>Statistics</strong> : Probability distributions.</p>
<p><strong>Epidemic theory</strong> : Epidemiological parameters, time
periods, Effective reproductive number.</p>
</div>
</div>
</div>
<section id="introduction"><h2 class="section-heading">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<!-- to activate for EpiNow2@dist-interfase

:::::::::::::::::: callout

If we write the `[]` next to the last object create like in `covid_serialint_parameters[]`, within `[]` we can use the 
Tab key <kbd>↹</kbd> 
to use the [code completion feature](https://support.posit.co/hc/en-us/articles/205273297-Code-Completion-in-the-RStudio-IDE) and have a quick access to `covid_serialint_parameters["meanlog"]` and `covid_serialint_parameters["sdlog"]`. We invite you to try this out in code chunks and the R console!

::::::::::::::::::

--><p><code>{epiparameter}</code> help us to <em>choose</em> one specific
set of epidemiological parameters from the literature, instead of
copy/pasting them <em>by hand</em>:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">covid_serialint</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">epidist_db</span><span class="op">(</span></span>
<span>    disease <span class="op">=</span> <span class="st">"covid"</span>,</span>
<span>    epi_dist <span class="op">=</span> <span class="st">"serial"</span>,</span>
<span>    author <span class="op">=</span> <span class="st">"Nishiura"</span>,</span>
<span>    single_epidist <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
<p>Now, we have an epidemiological parameter we can use in our analysis!
In the chunk below we replaced one of the <strong>summary
statistics</strong> inputs into <code>EpiNow2::dist_spec()</code></p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">generation_time</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">EpiNow2</span><span class="fu">::</span><span class="fu">dist_spec</span><span class="op">(</span></span>
<span>    mean <span class="op">=</span> <span class="va">covid_serialint</span><span class="op">$</span><span class="va">summary_stats</span><span class="op">$</span><span class="va">mean</span>, <span class="co"># replaced!</span></span>
<span>    sd <span class="op">=</span> <span class="va">covid_serialint</span><span class="op">$</span><span class="va">summary_stats</span><span class="op">$</span><span class="va">sd</span>, <span class="co"># replaced!</span></span>
<span>    max <span class="op">=</span> <span class="fl">20</span>,</span>
<span>    distribution <span class="op">=</span> <span class="st">"gamma"</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
<p>In this episode, we will use the <strong>distribution
functions</strong> that <code>{epiparameter}</code> provides to get a
maximum value (<code>max</code>) for this and any other package
downstream in your analysis pipeline!</p>
<p>Let’s load the <code>{epiparameter}</code> and <a href="https://epiforecasts.io/EpiNow2/" class="external-link">EpiNow2</a>
package. For <a href="https://epiforecasts.io/EpiNow2/" class="external-link">EpiNow2</a>, we’ll set 4 cores to be used in
parallel computations. We’ll use the pipe <code>%&gt;%</code>, some
<a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a> verbs and <a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a>, so let’s also
call to the <a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a> package:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">epiparameter</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">EpiNow2</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">withr</span><span class="fu">::</span><span class="fu">local_options</span><span class="op">(</span><span class="fu">list</span><span class="op">(</span>mc.cores <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div id="the-double-colon" class="callout checklist">
<div class="callout-square">
<i class="callout-icon" data-feather="check-square"></i>
</div>
<div id="the-double-colon" class="callout-inner">
<h3 class="callout-title">The double-colon<a class="anchor" aria-label="anchor" href="#the-double-colon"></a>
</h3>
<div class="callout-content">
<p>The double-colon <code>::</code> in R let you call a specific
function from a package without loading the entire package into the
current environment.</p>
<p>For example, <code>dplyr::filter(data, condition)</code> uses
<code>filter()</code> from the <a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a> package.</p>
<p>This help us remember package functions and avoid namespace
conflicts.</p>
</div>
</div>
</div>
</section><section id="distribution-functions"><h2 class="section-heading">Distribution functions<a class="anchor" aria-label="anchor" href="#distribution-functions"></a>
</h2>
<hr class="half-width">
<p>In R, all the statistical distributions have functions to access the
following:</p>
<ul>
<li>
<code>density()</code>: Probability <strong>Density</strong>
function (PDF),</li>
<li>
<code>cdf()</code>: Cumulative Distribution function
(<strong>CDF</strong>),</li>
<li>
<code>quantile()</code>: <strong>Quantile</strong> function,
and</li>
<li>
<code>generate()</code>: <strong>Random</strong> values from the
given distribution.</li>
</ul>
<div id="functions-for-the-normal-distribution" class="callout checklist">
<div class="callout-square">
<i class="callout-icon" data-feather="check-square"></i>
</div>
<div id="functions-for-the-normal-distribution" class="callout-inner">
<h3 class="callout-title">Functions for the Normal distribution<a class="anchor" aria-label="anchor" href="#functions-for-the-normal-distribution"></a>
</h3>
<div class="callout-content">
<p>If you need it, read in detail about the <a href="https://sakai.unc.edu/access/content/group/3d1eb92e-7848-4f55-90c3-7c72a54e7e43/public/docs/lectures/lecture13.htm#probfunc" class="external-link">R
probability functions for the normal distribution</a>, each of its
definitions and identify in which part of a distribution they are
located!</p>
<figure><img src="../fig/fig5a-normaldistribution.png" alt="The four probability functions for the normal distribution (Jack Weiss, 2012)" class="figure mx-auto d-block"><div class="figcaption">The four probability functions for the normal
distribution (<a href="https://sakai.unc.edu/access/content/group/3d1eb92e-7848-4f55-90c3-7c72a54e7e43/public/docs/lectures/lecture13.htm#probfunc" class="external-link">Jack
Weiss, 2012</a>)</div>
</figure>
</div>
</div>
</div>
<p>If you look at <code>?stats::Distributions</code>, each type of
distribution has a unique set of functions. However,
<code>{epiparameter}</code> gives you the same four functions to access
each of the values above for any <code>&lt;epidist&gt;</code> object you
want!</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot this to have a visual reference</span></span>
<span><span class="fu">plot</span><span class="op">(</span><span class="va">covid_serialint</span>, day_range <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># the density value at quantile value of 10 (days)</span></span>
<span><span class="fu">density</span><span class="op">(</span><span class="va">covid_serialint</span>, at <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.01911607</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># the cumulative probability at quantile value of 10 (days)</span></span>
<span><span class="fu">cdf</span><span class="op">(</span><span class="va">covid_serialint</span>, q <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.9466605</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># the quantile value (day) at a cumulative probability of 60%</span></span>
<span><span class="fu">quantile</span><span class="op">(</span><span class="va">covid_serialint</span>, p <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 4.618906</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># generate 10 random values (days) given</span></span>
<span><span class="co"># the distribution family and its parameters</span></span>
<span><span class="fu">generate</span><span class="op">(</span><span class="va">covid_serialint</span>, times <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> [1]  5.534646  9.250007  4.254961  3.436661 13.323202  3.695330  5.519206
 [8]  4.682234  2.675111  2.804316</code></pre>
</div>
<div id="accordionInstructor1" class="accordion instructor-note accordion-flush">
<div class="accordion-item">
<button class="accordion-button instructor-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInstructor1" aria-expanded="false" aria-controls="collapseInstructor1">
  <h3 class="accordion-header" id="headingInstructor1">
<div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="edit-2"></i></div>Instructor Note</h3>
</button>
<div id="collapseInstructor1" class="accordion-collapse collapse" data-bs-parent="#accordionInstructor1" aria-labelledby="headingInstructor1">
<div class="accordion-body">
<p>Access to the reference documentation (Help files) for these
functions is accessible with the three double-colon notation:
<code>epiparameter:::</code></p>
<ul>
<li><code>?epiparameter:::density.epidist()</code></li>
<li><code>?epiparameter:::cdf.epidist()</code></li>
<li><code>?epiparameter:::quantile.epidist()</code></li>
<li><code>?epiparameter:::generate.epidist()</code></li>
</ul>
</div>
</div>
</div>
</div>
<div id="window-for-contact-tracing-and-the-serial-interval" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="window-for-contact-tracing-and-the-serial-interval" class="callout-inner">
<h3 class="callout-title">Window for contact tracing and the serial
interval<a class="anchor" aria-label="anchor" href="#window-for-contact-tracing-and-the-serial-interval"></a>
</h3>
<div class="callout-content">
<p>The <strong>serial interval</strong> is important in the optimisation
of contact tracing since it provides a time window for the containment
of a disease spread (<a href="https://academic.oup.com/aje/article/158/11/1039/162725" class="external-link">Fine,
2003</a>). Depending on the serial interval, we can evaluate the need to
expand the number of days pre-onset to consider in the contact tracing
to include more backwards contacts (<a href="https://assets.publishing.service.gov.uk/media/61e9ab3f8fa8f50597fb3078/S0523_Oxford_-_Backwards_contact_tracing.pdf" class="external-link">Davis
et al., 2020</a>).</p>
<p>With the COVID-19 serial interval (<code>covid_serialint</code>)
calculate:</p>
<ul>
<li>How much more of the backward cases could be captured if the contact
tracing method considered contacts up to 6 days pre-onset compared to 2
days pre-onset?</li>
</ul>
</div>
</div>
</div>
<div id="accordionHint1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button hint-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHint1" aria-expanded="false" aria-controls="collapseHint1">
  <h4 class="accordion-header" id="headingHint1">Give me a hint</h4>
</button>
<div id="collapseHint1" class="accordion-collapse collapse" data-bs-parent="#accordionHint1" aria-labelledby="headingHint1">
<div class="accordion-body">
<p>In Figure 5 from the <a href="https://sakai.unc.edu/access/content/group/3d1eb92e-7848-4f55-90c3-7c72a54e7e43/public/docs/lectures/lecture13.htm#probfunc" class="external-link">R
probability functions for the normal distribution</a>, the shadowed
section represents a cumulative probability of <code>0.997</code> for
the quantile value at <code>x = 2</code>.</p>
</div>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Show me the solution</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plot</span><span class="op">(</span><span class="va">covid_serialint</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">cdf</span><span class="op">(</span><span class="va">covid_serialint</span>, q <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.1111729</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">cdf</span><span class="op">(</span><span class="va">covid_serialint</span>, q <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.7623645</code></pre>
</div>
<p>Given the COVID-19 serial interval:</p>
<ul>
<li><p>A contact tracing method considering contacts up to 2 days
pre-onset will capture around 11.1% of backward cases.</p></li>
<li><p>If this period is extended to 6 days pre-onset, this could
include 76.2% of backward contacts.</p></li>
</ul>
</div>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">What if</h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<p>If we exchange the question between days and cumulative probability
to:</p>
<ul>
<li>When considering secondary cases, how many days following the
symptom onset of primary cases can we expect 55% of symptom onset to
occur?</li>
</ul>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">quantile</span><span class="op">(</span><span class="va">covid_serialint</span>, p <span class="op">=</span> <span class="fl">0.55</span><span class="op">)</span></span></code></pre>
</div>
<p>An interpretation could be:</p>
<ul>
<li>The 55% percent of the symptom onset of secondary cases will happen
after 4.2 days after the symptom onset of primary cases.</li>
</ul>
</div>
</div>
</div>
</div>
</section><section id="discretise-a-continuous-distribution"><h2 class="section-heading">Discretise a continuous distribution<a class="anchor" aria-label="anchor" href="#discretise-a-continuous-distribution"></a>
</h2>
<hr class="half-width">
<p>We are getting closer to the end! <code>EpiNow2::dist_spec()</code>
still needs a maximum value (<code>max</code>).</p>
<p>One way to do this is to get the quantile value for the
distribution’s 99.9th percentile or <code>0.999</code> cumulative
probability. For this, we need access to the set of distribution
functions for our <code>&lt;epidist&gt;</code> object.</p>
<p>We can use the set of distribution functions for a
<em>continuous</em> distribution (as above). However, these values will
be <em>continuous</em> numbers. We can <strong>discretise</strong> the
continuous distribution stored in our <code>&lt;epidist&gt;</code>
object to get discrete values from a continuous distribution.</p>
<p>When we <code>epiparameter::discretise()</code> the continuous
distribution we get a <strong>discrete</strong>(-ized) distribution:</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">covid_serialint_discrete</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">discretise</span><span class="op">(</span><span class="va">covid_serialint</span><span class="op">)</span></span>
<span></span>
<span><span class="va">covid_serialint_discrete</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Disease: COVID-19
Pathogen: SARS-CoV-2
Epi Distribution: serial interval
Study: Nishiura H, Linton N, Akhmetzhanov A (2020). "Serial interval of novel
coronavirus (COVID-19) infections." _International Journal of
Infectious Diseases_. doi:10.1016/j.ijid.2020.02.060
&lt;https://doi.org/10.1016/j.ijid.2020.02.060&gt;.
Distribution: discrete lnorm
Parameters:
  meanlog: 1.386
  sdlog: 0.568</code></pre>
</div>
<p>We identify this change in the <code>Distribution:</code> output line
of the <code>&lt;epidist&gt;</code> object. Double check this line:</p>
<pre><code>Distribution: discrete lnorm</code></pre>
<p>While for a <strong>continuous</strong> distribution, we plot the
<em>Probability Density Function (PDF)</em>, for a
<strong>discrete</strong> distribution, we plot the <em>Probability Mass
Function (PMF)</em>:</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># continuous</span></span>
<span><span class="fu">plot</span><span class="op">(</span><span class="va">covid_serialint</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># discrete</span></span>
<span><span class="fu">plot</span><span class="op">(</span><span class="va">covid_serialint_discrete</span><span class="op">)</span></span></code></pre>
</div>
<p>To finally get a <code>max</code> value, let’s access the quantile
value of the 99.9th percentile or <code>0.999</code> probability of the
distribution with the <code>prob_dist$q</code> notation, similarly to
how we access the <code>summary_stats</code> values.</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">covid_serialint_discrete_max</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">quantile</span><span class="op">(</span><span class="va">covid_serialint_discrete</span>, p <span class="op">=</span> <span class="fl">0.999</span><span class="op">)</span></span></code></pre>
</div>
<div id="length-of-quarantine-and-incubation-period" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="length-of-quarantine-and-incubation-period" class="callout-inner">
<h3 class="callout-title">Length of quarantine and incubation
period<a class="anchor" aria-label="anchor" href="#length-of-quarantine-and-incubation-period"></a>
</h3>
<div class="callout-content">
<p>The <strong>incubation period</strong> distribution is a useful delay
to assess the length of active monitoring or quarantine (<a href="https://www.acpjournals.org/doi/10.7326/M20-0504" class="external-link">Lauer et al.,
2020</a>). Similarly, delays from symptom onset to recovery (or death)
will determine the required duration of health care and case isolation
(<a href="https://royalsocietypublishing.org/doi/10.1098/rstb.2016.0371" class="external-link">Cori
et al., 2017</a>).</p>
<p>Calculate:</p>
<ul>
<li>Within what exact time frame do 99% of individuals exhibiting
COVID-19 symptoms exhibit them after infection?</li>
</ul>
</div>
</div>
</div>
<div id="accordionHint2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button hint-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHint2" aria-expanded="false" aria-controls="collapseHint2">
  <h4 class="accordion-header" id="headingHint2">Give me a hint</h4>
</button>
<div id="collapseHint2" class="accordion-collapse collapse" data-bs-parent="#accordionHint2" aria-labelledby="headingHint2">
<div class="accordion-body">
<p>What delay distribution measures the time between infection and the
onset of symptoms?</p>
<p>The probability functions for <code>&lt;epidist&gt;</code>
<strong>discrete</strong> distributions are the same that we used for
the <em>continuous</em> ones!</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot to have a visual reference</span></span>
<span><span class="fu">plot</span><span class="op">(</span><span class="va">covid_serialint_discrete</span>, day_range <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># density value at quantile value 10 (day)</span></span>
<span><span class="fu">density</span><span class="op">(</span><span class="va">covid_serialint_discrete</span>, at <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># cumulative probability at quantile value 10 (day)</span></span>
<span><span class="fu">cdf</span><span class="op">(</span><span class="va">covid_serialint_discrete</span>, q <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># In what quantile value (days) do we have the 60% cumulative probability?</span></span>
<span><span class="fu">quantile</span><span class="op">(</span><span class="va">covid_serialint_discrete</span>, p <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># generate random values</span></span>
<span><span class="fu">generate</span><span class="op">(</span><span class="va">covid_serialint_discrete</span>, times <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3">Show me the solution</h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">covid_incubation</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">epidist_db</span><span class="op">(</span></span>
<span>    disease <span class="op">=</span> <span class="st">"covid"</span>,</span>
<span>    epi_dist <span class="op">=</span> <span class="st">"incubation"</span>,</span>
<span>    single_epidist <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Using McAloon C, Collins Á, Hunt K, Barber A, Byrne A, Butler F, Casey M,
Griffin J, Lane E, McEvoy D, Wall P, Green M, O'Grady L, More S (2020).
"Incubation period of COVID-19: a rapid systematic review and
meta-analysis of observational research." _BMJ Open_.
doi:10.1136/bmjopen-2020-039652
&lt;https://doi.org/10.1136/bmjopen-2020-039652&gt;.. 
To retrieve the short citation use the 'get_citation' function</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">covid_incubation_discrete</span> <span class="op">&lt;-</span> <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">discretise</span><span class="op">(</span><span class="va">covid_incubation</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">quantile</span><span class="op">(</span><span class="va">covid_incubation_discrete</span>, p <span class="op">=</span> <span class="fl">0.99</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 16</code></pre>
</div>
<p>99% of those who develop COVID-19 symptoms will do so within 16 days
of infection.</p>
<p>Now, <em>Is this result expected in epidemiological terms?</em></p>
</div>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4">How to create a distribution plot?</h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" data-bs-parent="#accordionSolution4" aria-labelledby="headingSolution4">
<div class="accordion-body">
<p>From a maximum value with <code>quantile()</code>, we can create a
sequence of quantile values as a numeric vector and calculate
<code>density()</code> values for each:</p>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create a discrete distribution visualisation</span></span>
<span><span class="co"># from a maximum value from the distribution</span></span>
<span><span class="fu">quantile</span><span class="op">(</span><span class="va">covid_serialint_discrete</span>, p <span class="op">=</span> <span class="fl">0.999</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co"># generate quantile values</span></span>
<span>  <span class="co"># as a sequence for each natural number</span></span>
<span>  <span class="fu">seq</span><span class="op">(</span><span class="fl">1L</span>, to <span class="op">=</span> <span class="va">.</span>, by <span class="op">=</span> <span class="fl">1L</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co"># coerce numeric vector to data frame</span></span>
<span>  <span class="fu">as_tibble_col</span><span class="op">(</span>column_name <span class="op">=</span> <span class="st">"quantile_values"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    <span class="co"># calculate density values</span></span>
<span>    <span class="co"># for each quantile in the density function</span></span>
<span>    density_values <span class="op">=</span></span>
<span>      <span class="fu">density</span><span class="op">(</span></span>
<span>        x <span class="op">=</span> <span class="va">covid_serialint_discrete</span>,</span>
<span>        at <span class="op">=</span> <span class="va">quantile_values</span></span>
<span>      <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co"># create plot</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span></span>
<span>    <span class="fu">aes</span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">quantile_values</span>,</span>
<span>      y <span class="op">=</span> <span class="va">density_values</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_col</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/delays-functions-rendered-unnamed-chunk-13-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p><strong>Remember:</strong> In infections with pre-symptomatic
transmission, serial intervals can have negative values (<a href="https://www.ijidonline.com/article/S1201-9712(20)30119-3/fulltext" class="external-link">Nishiura
et al., 2020</a>). When we use the <em>serial interval</em> to
approximate the <em>generation time</em> we need to make this
distribution with positive values only!</p>
</div>
</div>
</div>
</div>
</section><section id="plug-in-epiparameter-to-epinow2"><h2 class="section-heading">Plug-in <code>{epiparameter}</code> to <code>{EpiNow2}</code><a class="anchor" aria-label="anchor" href="#plug-in-epiparameter-to-epinow2"></a>
</h2>
<hr class="half-width">
<p>Now we can plug everything into the <code>EpiNow2::dist_spec()</code>
function!</p>
<ul>
<li>the <strong>summary statistics</strong> <code>mean</code> and
<code>sd</code> of the distribution,</li>
<li>a maximum value <code>max</code>,</li>
<li>the <code>distribution</code> name.</li>
</ul>
<p>However, when using <code>EpiNow2::dist_spec()</code>, to define a
<strong>Lognormal</strong> distribution, like the one in the
<code>covid_serialint</code> object, we need to convert its summary
statistics to distribution parameters named logmean and logsd. With
<code>{epiparameter}</code> we can directly get the <em>distribution
parameters</em> using <code>epiparameter::get_parameters()</code>:</p>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">covid_serialint_parameters</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">get_parameters</span><span class="op">(</span><span class="va">covid_serialint</span><span class="op">)</span></span></code></pre>
</div>
<p>Then, we have:</p>
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">serial_interval_covid</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">dist_spec</span><span class="op">(</span></span>
<span>    mean <span class="op">=</span> <span class="va">covid_serialint_parameters</span><span class="op">[</span><span class="st">"meanlog"</span><span class="op">]</span>,</span>
<span>    sd <span class="op">=</span> <span class="va">covid_serialint_parameters</span><span class="op">[</span><span class="st">"sdlog"</span><span class="op">]</span>,</span>
<span>    max <span class="op">=</span> <span class="va">covid_serialint_discrete_max</span>,</span>
<span>    distribution <span class="op">=</span> <span class="st">"lognormal"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">serial_interval_covid</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
  Fixed distribution with PMF [0.0073 0.1 0.2 0.19 0.15 0.11 0.075 0.051 0.035 0.023 0.016 0.011 0.0076 0.0053 0.0037 0.0027 0.0019 0.0014 0.001 0.00074 0.00055 0.00041 0.00031]</code></pre>
</div>
<p>Assuming a COVID-19 scenario, let’s use the first 60 days of the
<code>example_confirmed</code> data set from the <a href="https://epiforecasts.io/EpiNow2/" class="external-link">EpiNow2</a>
package as <code>reported_cases</code> and the recently created
<code>serial_interval_covid</code> object as inputs to estimate the
time-varying reproduction number using
<code>EpiNow2::epinow()</code>.</p>
<div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">epinow_estimates_cg</span> <span class="op">&lt;-</span> <span class="fu">epinow</span><span class="op">(</span></span>
<span>  <span class="co"># cases</span></span>
<span>  reported_cases <span class="op">=</span> <span class="va">example_confirmed</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">60</span><span class="op">]</span>,</span>
<span>  <span class="co"># delays</span></span>
<span>  generation_time <span class="op">=</span> <span class="fu">generation_time_opts</span><span class="op">(</span><span class="va">serial_interval_covid</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>WARN [2024-06-17 21:44:52] epinow: There were 5 divergent transitions after warmup. See
https://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup
to find out why this is a problem and how to eliminate them. - 
WARN [2024-06-17 21:44:52] epinow: Examine the pairs() plot to diagnose sampling problems
 - </code></pre>
</div>
<div class="codewrapper sourceCode" id="cb35">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">base</span><span class="fu">::</span><span class="fu">plot</span><span class="op">(</span><span class="va">epinow_estimates_cg</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/delays-functions-rendered-unnamed-chunk-16-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>The <code>plot()</code> output includes the estimated cases by date
of infection, which are reconstructed from the reported cases and
delays.</p>
<div id="warning" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="warning" class="callout-inner">
<h3 class="callout-title">Warning<a class="anchor" aria-label="anchor" href="#warning"></a>
</h3>
<div class="callout-content">
<p>Using the serial interval instead of the generation time is an
alternative that can propagate bias in your estimates, even more so in
diseases with reported pre-symptomatic transmission. (<a href="https://academic.oup.com/jid/article/224/10/1664/6356465" class="external-link">Chung
Lau et al., 2021</a>)</p>
</div>
</div>
</div>
</section><section id="adjusting-for-reporting-delays"><h2 class="section-heading">Adjusting for reporting delays<a class="anchor" aria-label="anchor" href="#adjusting-for-reporting-delays"></a>
</h2>
<hr class="half-width">
<p>Estimating <span class="math inline">\(R_t\)</span> requires data on
the daily number of new infections. Due to lags in the development of
detectable viral loads, symptom onset, seeking care, and reporting,
these numbers are not readily available. All observations reflect
transmission events from some time in the past. In other words, if <span class="math inline">\(d\)</span> is the delay from infection to
observation, then observations at time <span class="math inline">\(t\)</span> inform <span class="math inline">\(R_{t−d}\)</span>, not <span class="math inline">\(R_t\)</span>. <a href="https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1008409#sec007" class="external-link">(Gostic
et al., 2020)</a></p>
<figure><img src="../fig/disease-reporting.jpg" alt="Timeline for chain of disease reporting, the Netherlands. Lab, laboratory; PHA, public health authority. From Marinović et al., 2015" class="figure mx-auto d-block"><div class="figcaption">
<strong>Timeline for chain of disease reporting,
the Netherlands.</strong> Lab, laboratory; PHA, public health authority.
From <a href="https://wwwnc.cdc.gov/eid/article/21/2/13-0504_article" class="external-link">Marinović
et al., 2015</a>
</div>
</figure><p>The <strong>delay distribution</strong> could be inferred jointly
with the underlying times of infection or estimated as the sum of the <a href="reference.html#incubation">incubation period</a> distribution and
the distribution of delays from symptom onset to observation from line
list data (<a href="reference.html#reportingdelay">reporting delay</a>).
For <a href="https://epiforecasts.io/EpiNow2/" class="external-link">EpiNow2</a>, we can specify these two complementary delay
distributions in the <code>delays</code> argument.</p>
<figure><img src="../fig/rt-adjusting-delays.png" alt="R_{t} is a measure of transmission at time t. Observations after time t must be adjusted. ICU, intensive care unit. From Gostic et al., 2020" class="figure mx-auto d-block"><div class="figcaption">
<strong><span class="math inline">\(R_{t}\)</span> is a measure of transmission at
time <span class="math inline">\(t\)</span>.</strong> Observations after
time <span class="math inline">\(t\)</span> must be adjusted. ICU,
intensive care unit. From <a href="https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1008409#sec007" class="external-link">Gostic
et al., 2020</a>
</div>
</figure><div id="use-an-incubation-period-for-covid-19-to-estimate-rt" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="use-an-incubation-period-for-covid-19-to-estimate-rt" class="callout-inner">
<h3 class="callout-title">Use an incubation period for COVID-19 to
estimate Rt<a class="anchor" aria-label="anchor" href="#use-an-incubation-period-for-covid-19-to-estimate-rt"></a>
</h3>
<div class="callout-content">
<p>Estimate the time-varying reproduction number for the first 60 days
of the <code>example_confirmed</code> data set from
<a href="https://epiforecasts.io/EpiNow2/" class="external-link">EpiNow2</a>. Access to an incubation period for COVID-19 from
<code>{epiparameter}</code> to use it as a reporting delay.</p>
</div>
</div>
</div>
<div id="accordionHint3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button hint-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHint3" aria-expanded="false" aria-controls="collapseHint3">
  <h4 class="accordion-header" id="headingHint3">Give me a hint</h4>
</button>
<div id="collapseHint3" class="accordion-collapse collapse" data-bs-parent="#accordionHint3" aria-labelledby="headingHint3">
<div class="accordion-body">
<p>Use the last <code>epinow()</code> calculation using the
<code>delays</code> argument and the <code>delay_opts()</code> helper
function.</p>
<p>The <code>delays</code> argument and the <code>delay_opts()</code>
helper function are analogous to the <code>generation_time</code>
argument and the <code>generation_time_opts()</code> helper
function.</p>
<div class="codewrapper sourceCode" id="cb36">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">epinow_estimates</span> <span class="op">&lt;-</span> <span class="fu">epinow</span><span class="op">(</span></span>
<span>  <span class="co"># cases</span></span>
<span>  reported_cases <span class="op">=</span> <span class="va">example_confirmed</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">60</span><span class="op">]</span>,</span>
<span>  <span class="co"># delays</span></span>
<span>  generation_time <span class="op">=</span> <span class="fu">generation_time_opts</span><span class="op">(</span><span class="va">covid_serial_interval</span><span class="op">)</span>,</span>
<span>  delays <span class="op">=</span> <span class="fu">delay_opts</span><span class="op">(</span><span class="va">covid_incubation_time</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5">Show me the solution</h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" data-bs-parent="#accordionSolution5" aria-labelledby="headingSolution5">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb37">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># generation time ---------------------------------------------------------</span></span>
<span></span>
<span><span class="co"># get covid serial interval</span></span>
<span><span class="va">covid_serialint</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">epidist_db</span><span class="op">(</span></span>
<span>    disease <span class="op">=</span> <span class="st">"covid"</span>,</span>
<span>    epi_dist <span class="op">=</span> <span class="st">"serial"</span>,</span>
<span>    author <span class="op">=</span> <span class="st">"Nishiura"</span>,</span>
<span>    single_epidist <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># adapt epidist to epinow2</span></span>
<span><span class="va">covid_serialint_discrete_max</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">covid_serialint</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">discretise</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">quantile</span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.999</span><span class="op">)</span></span>
<span></span>
<span><span class="va">covid_serialint_parameters</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">get_parameters</span><span class="op">(</span><span class="va">covid_serialint</span><span class="op">)</span></span>
<span></span>
<span><span class="va">covid_serial_interval</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">dist_spec</span><span class="op">(</span></span>
<span>    mean <span class="op">=</span> <span class="va">covid_serialint_parameters</span><span class="op">[</span><span class="st">"meanlog"</span><span class="op">]</span>,</span>
<span>    sd <span class="op">=</span> <span class="va">covid_serialint_parameters</span><span class="op">[</span><span class="st">"sdlog"</span><span class="op">]</span>,</span>
<span>    max <span class="op">=</span> <span class="va">covid_serialint_discrete_max</span>,</span>
<span>    distribution <span class="op">=</span> <span class="st">"lognormal"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># incubation time ---------------------------------------------------------</span></span>
<span></span>
<span><span class="co"># get covid incubation period</span></span>
<span><span class="va">covid_incubation</span> <span class="op">&lt;-</span> <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">epidist_db</span><span class="op">(</span></span>
<span>  disease <span class="op">=</span> <span class="st">"covid"</span>,</span>
<span>  epi_dist <span class="op">=</span> <span class="st">"incubation"</span>,</span>
<span>  author <span class="op">=</span> <span class="st">"Natalie"</span>,</span>
<span>  single_epidist <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># adapt epiparameter to epinow2</span></span>
<span><span class="va">covid_incubation_discrete_max</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">covid_incubation</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">discretise</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">quantile</span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.999</span><span class="op">)</span></span>
<span></span>
<span><span class="va">covid_incubation_parameters</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">get_parameters</span><span class="op">(</span><span class="va">covid_incubation</span><span class="op">)</span></span>
<span></span>
<span><span class="va">covid_incubation_time</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">dist_spec</span><span class="op">(</span></span>
<span>    mean <span class="op">=</span> <span class="va">covid_incubation_parameters</span><span class="op">[</span><span class="st">"meanlog"</span><span class="op">]</span>,</span>
<span>    sd <span class="op">=</span> <span class="va">covid_incubation_parameters</span><span class="op">[</span><span class="st">"sdlog"</span><span class="op">]</span>,</span>
<span>    max <span class="op">=</span> <span class="va">covid_incubation_discrete_max</span>,</span>
<span>    distribution <span class="op">=</span> <span class="st">"lognormal"</span> <span class="co"># do not forget this!</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># epinow ------------------------------------------------------------------</span></span>
<span></span>
<span><span class="co"># run epinow</span></span>
<span><span class="va">epinow_estimates_cgi</span> <span class="op">&lt;-</span> <span class="fu">epinow</span><span class="op">(</span></span>
<span>  <span class="co"># cases</span></span>
<span>  reported_cases <span class="op">=</span> <span class="va">example_confirmed</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">60</span><span class="op">]</span>,</span>
<span>  <span class="co"># delays</span></span>
<span>  generation_time <span class="op">=</span> <span class="fu">generation_time_opts</span><span class="op">(</span><span class="va">covid_serial_interval</span><span class="op">)</span>,</span>
<span>  delays <span class="op">=</span> <span class="fu">delay_opts</span><span class="op">(</span><span class="va">covid_incubation_time</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>WARN [2024-06-17 21:46:37] epinow: There were 10 divergent transitions after warmup. See
https://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup
to find out why this is a problem and how to eliminate them. - 
WARN [2024-06-17 21:46:37] epinow: Examine the pairs() plot to diagnose sampling problems
 - </code></pre>
</div>
<div class="codewrapper sourceCode" id="cb39">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">base</span><span class="fu">::</span><span class="fu">plot</span><span class="op">(</span><span class="va">epinow_estimates_cgi</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/delays-functions-rendered-unnamed-chunk-17-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Try to complement the <code>delays</code> argument with a reporting
delay like the <code>reporting_delay_fixed</code> object of the previous
episode.</p>
</div>
</div>
</div>
</div>
<div id="how-much-has-it-changed" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="how-much-has-it-changed" class="callout-inner">
<h3 class="callout-title">How much has it changed?<a class="anchor" aria-label="anchor" href="#how-much-has-it-changed"></a>
</h3>
<div class="callout-content">
<p>After adding the incubation period, discuss:</p>
<ul>
<li>Does the trend of the model fit in the “Estimate” section
change?</li>
<li>Has the uncertainty changed?</li>
<li>How would you explain or interpret any of these changes?</li>
</ul>
<p>Compare all the <a href="https://epiforecasts.io/EpiNow2/" class="external-link">EpiNow2</a> figures generated
previously.</p>
</div>
</div>
</div>
</section><section id="challenges"><h2 class="section-heading">Challenges<a class="anchor" aria-label="anchor" href="#challenges"></a>
</h2>
<hr class="half-width">
<div id="a-code-completion-tip" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="a-code-completion-tip" class="callout-inner">
<h3 class="callout-title">A code completion tip<a class="anchor" aria-label="anchor" href="#a-code-completion-tip"></a>
</h3>
<div class="callout-content">
<p>If we write the <code>[]</code> next to the object
<code>covid_serialint_parameters[]</code>, within <code>[]</code> we can
use the Tab key <kbd>↹</kbd> for <a href="https://support.posit.co/hc/en-us/articles/205273297-Code-Completion-in-the-RStudio-IDE" class="external-link">code
completion feature</a></p>
<p>This gives quick access to
<code>covid_serialint_parameters["meanlog"]</code> and
<code>covid_serialint_parameters["sdlog"]</code>.</p>
<p>We invite you to try this out in code chunks and the R console!</p>
</div>
</div>
</div>
<div id="ebolas-effective-reproduction-number-adjusted-by-reporting-delays" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="ebolas-effective-reproduction-number-adjusted-by-reporting-delays" class="callout-inner">
<h3 class="callout-title">Ebola’s effective reproduction number adjusted
by reporting delays<a class="anchor" aria-label="anchor" href="#ebolas-effective-reproduction-number-adjusted-by-reporting-delays"></a>
</h3>
<div class="callout-content">
<p>Download and read the <a href="../data/ebola_cases.csv">Ebola
dataset</a>:</p>
<ul>
<li>Estimate the effective reproduction number using
<a href="https://epiforecasts.io/EpiNow2/" class="external-link">EpiNow2</a>
</li>
<li>Adjust the estimate by the available reporting delays in
<code>{epiparameter}</code>
</li>
<li>Why did you choose that parameter?</li>
</ul>
</div>
</div>
</div>
<div id="accordionHint4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button hint-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHint4" aria-expanded="false" aria-controls="collapseHint4">
  <h4 class="accordion-header" id="headingHint4">Give me a hint</h4>
</button>
<div id="collapseHint4" class="accordion-collapse collapse" data-bs-parent="#accordionHint4" aria-labelledby="headingHint4">
<div class="accordion-body">
<p>To calculate the <span class="math inline">\(R_t\)</span> using
<a href="https://epiforecasts.io/EpiNow2/" class="external-link">EpiNow2</a>, we need:</p>
<ul>
<li>Aggregated incidence <code>data</code>, with confirmed cases per
day, and</li>
<li>The <code>generation</code> time distribution.</li>
<li>Optionally, reporting <code>delays</code> distributions when
available (e.g., incubation period).</li>
</ul>
<p>To get delay distribution using <code>{epiparameter}</code> we can
use functions like:</p>
<ul>
<li><code>epidist_db()</code></li>
<li><code>list_distributions()</code></li>
<li><code>discretise()</code></li>
<li><code>quantile()</code></li>
</ul>
</div>
</div>
</div>
</div>
<div id="accordionSolution6" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution6" aria-expanded="false" aria-controls="collapseSolution6">
  <h4 class="accordion-header" id="headingSolution6">Show me the solution</h4>
</button>
<div id="collapseSolution6" class="accordion-collapse collapse" data-bs-parent="#accordionSolution6" aria-labelledby="headingSolution6">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb40">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># read data</span></span>
<span><span class="co"># e.g.: if path to file is data/raw-data/ebola_cases.csv then:</span></span>
<span><span class="va">ebola_confirmed</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">read_csv</span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu">here</span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"raw-data"</span>, <span class="st">"ebola_cases.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># list distributions</span></span>
<span><span class="fu">epidist_db</span><span class="op">(</span>disease <span class="op">=</span> <span class="st">"ebola"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">list_distributions</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb41">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># generation time ---------------------------------------------------------</span></span>
<span></span>
<span><span class="co"># subset one distribution for the generation time</span></span>
<span><span class="va">ebola_serial</span> <span class="op">&lt;-</span> <span class="fu">epidist_db</span><span class="op">(</span></span>
<span>  disease <span class="op">=</span> <span class="st">"ebola"</span>,</span>
<span>  epi_dist <span class="op">=</span> <span class="st">"serial"</span>,</span>
<span>  single_epidist <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># adapt epiparameter to epinow2</span></span>
<span><span class="va">ebola_serial_discrete</span> <span class="op">&lt;-</span> <span class="fu">discretise</span><span class="op">(</span><span class="va">ebola_serial</span><span class="op">)</span></span>
<span></span>
<span><span class="va">serial_interval_ebola</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">dist_spec</span><span class="op">(</span></span>
<span>    mean <span class="op">=</span> <span class="va">ebola_serial</span><span class="op">$</span><span class="va">summary_stats</span><span class="op">$</span><span class="va">mean</span>,</span>
<span>    sd <span class="op">=</span> <span class="va">ebola_serial</span><span class="op">$</span><span class="va">summary_stats</span><span class="op">$</span><span class="va">sd</span>,</span>
<span>    max <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">ebola_serial_discrete</span>, p <span class="op">=</span> <span class="fl">0.999</span><span class="op">)</span>,</span>
<span>    distribution <span class="op">=</span> <span class="st">"gamma"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># incubation time ---------------------------------------------------------</span></span>
<span></span>
<span><span class="co"># subset one distribution for delay of the incubation period</span></span>
<span><span class="va">ebola_incubation</span> <span class="op">&lt;-</span> <span class="fu">epidist_db</span><span class="op">(</span></span>
<span>  disease <span class="op">=</span> <span class="st">"ebola"</span>,</span>
<span>  epi_dist <span class="op">=</span> <span class="st">"incubation"</span>,</span>
<span>  single_epidist <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># adapt epiparameter to epinow2</span></span>
<span><span class="va">ebola_incubation_discrete</span> <span class="op">&lt;-</span> <span class="fu">discretise</span><span class="op">(</span><span class="va">ebola_incubation</span><span class="op">)</span></span>
<span></span>
<span><span class="va">incubation_period_ebola</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">dist_spec</span><span class="op">(</span></span>
<span>    mean <span class="op">=</span> <span class="va">ebola_incubation</span><span class="op">$</span><span class="va">summary_stats</span><span class="op">$</span><span class="va">mean</span>,</span>
<span>    sd <span class="op">=</span> <span class="va">ebola_incubation</span><span class="op">$</span><span class="va">summary_stats</span><span class="op">$</span><span class="va">sd</span>,</span>
<span>    max <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">ebola_serial_discrete</span>, p <span class="op">=</span> <span class="fl">0.999</span><span class="op">)</span>,</span>
<span>    distribution <span class="op">=</span> <span class="st">"gamma"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># epinow ------------------------------------------------------------------</span></span>
<span></span>
<span><span class="co"># run epinow</span></span>
<span><span class="va">epinow_estimates_egi</span> <span class="op">&lt;-</span> <span class="fu">epinow</span><span class="op">(</span></span>
<span>  <span class="co"># cases</span></span>
<span>  reported_cases <span class="op">=</span> <span class="va">ebola_confirmed</span>,</span>
<span>  <span class="co"># delays</span></span>
<span>  generation_time <span class="op">=</span> <span class="fu">generation_time_opts</span><span class="op">(</span><span class="va">serial_interval_ebola</span><span class="op">)</span>,</span>
<span>  delays <span class="op">=</span> <span class="fu">delay_opts</span><span class="op">(</span><span class="va">incubation_period_ebola</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>WARN [2024-06-17 21:50:29] epinow: There were 2 divergent transitions after warmup. See
https://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup
to find out why this is a problem and how to eliminate them. - 
WARN [2024-06-17 21:50:29] epinow: Examine the pairs() plot to diagnose sampling problems
 - </code></pre>
</div>
<div class="codewrapper sourceCode" id="cb43">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plot</span><span class="op">(</span><span class="va">epinow_estimates_egi</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/delays-functions-rendered-unnamed-chunk-20-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
<div id="what-to-do-with-weibull-distributions" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="what-to-do-with-weibull-distributions" class="callout-inner">
<h3 class="callout-title">What to do with Weibull distributions?<a class="anchor" aria-label="anchor" href="#what-to-do-with-weibull-distributions"></a>
</h3>
<div class="callout-content">
<p>Use the <code>influenza_england_1978_school</code> dataset from the
<a href="https://github.com/reconhub/outbreaks" class="external-link">outbreaks</a> package to calculate the effective reproduction
number using <a href="https://epiforecasts.io/EpiNow2/" class="external-link">EpiNow2</a> adjusting by the available reporting
delays in <code>{epiparameter}</code>.</p>
</div>
</div>
</div>
<div id="accordionHint5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button hint-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHint5" aria-expanded="false" aria-controls="collapseHint5">
  <h4 class="accordion-header" id="headingHint5">Give me a hint</h4>
</button>
<div id="collapseHint5" class="accordion-collapse collapse" data-bs-parent="#accordionHint5" aria-labelledby="headingHint5">
<div class="accordion-body">
<p><code>EpiNow2::dist_spec()</code> also accepts Probability Mass
Functions (PMF) from any distribution family. Read the reference guide
on <a href="https://epiforecasts.io/EpiNow2/reference/dist_spec.html" class="external-link">Specify
a distribution</a>.</p>
</div>
</div>
</div>
</div>
<div id="accordionSolution7" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution7" aria-expanded="false" aria-controls="collapseSolution7">
  <h4 class="accordion-header" id="headingSolution7">Show me the solution</h4>
</button>
<div id="collapseSolution7" class="accordion-collapse collapse" data-bs-parent="#accordionSolution7" aria-labelledby="headingSolution7">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb44">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># What parameters are available for Influenza?</span></span>
<span><span class="fu">epidist_db</span><span class="op">(</span>disease <span class="op">=</span> <span class="st">"influenza"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">list_distributions</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="va">epi_distribution</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 3 × 2
  epi_distribution      n
  &lt;chr&gt;             &lt;int&gt;
1 generation time       1
2 incubation period    15
3 serial interval       1</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb46">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># generation time ---------------------------------------------------------</span></span>
<span></span>
<span><span class="co"># Read the generation time</span></span>
<span><span class="va">influenza_generation</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">epidist_db</span><span class="op">(</span></span>
<span>    disease <span class="op">=</span> <span class="st">"influenza"</span>,</span>
<span>    epi_dist <span class="op">=</span> <span class="st">"generation"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">influenza_generation</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Disease: Influenza
Pathogen: Influenza-A-H1N1
Epi Distribution: generation time
Study: Lessler J, Reich N, Cummings D, New York City Department of Health and
Mental Hygiene Swine Influenza Investigation Team (2009). "Outbreak of
2009 Pandemic Influenza A (H1N1) at a New York City School." _The New
England Journal of Medicine_. doi:10.1056/NEJMoa0906089
&lt;https://doi.org/10.1056/NEJMoa0906089&gt;.
Distribution: weibull
Parameters:
  shape: 2.360
  scale: 3.180</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb48">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># EpiNow2 currently accepts Gamma or LogNormal</span></span>
<span><span class="co"># other can pass the PMF function</span></span>
<span></span>
<span><span class="va">influenza_generation_discrete</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">discretise</span><span class="op">(</span><span class="va">influenza_generation</span><span class="op">)</span></span>
<span></span>
<span><span class="va">influenza_generation_max</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">quantile</span><span class="op">(</span><span class="va">influenza_generation_discrete</span>, p <span class="op">=</span> <span class="fl">0.999</span><span class="op">)</span></span>
<span></span>
<span><span class="va">influenza_generation_pmf</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">density</span><span class="op">(</span></span>
<span>    <span class="va">influenza_generation_discrete</span>,</span>
<span>    at <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">influenza_generation_max</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">influenza_generation_pmf</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.063123364 0.221349877 0.297212205 0.238968280 0.124851641 0.043094538
[7] 0.009799363</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb50">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># EpiNow2::dist_spec() can also accept the PMF values</span></span>
<span><span class="va">generation_time_influenza</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">dist_spec</span><span class="op">(</span></span>
<span>    pmf <span class="op">=</span> <span class="va">influenza_generation_pmf</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># incubation period -------------------------------------------------------</span></span>
<span></span>
<span><span class="co"># Read the incubation period</span></span>
<span><span class="va">influenza_incubation</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">epidist_db</span><span class="op">(</span></span>
<span>    disease <span class="op">=</span> <span class="st">"influenza"</span>,</span>
<span>    epi_dist <span class="op">=</span> <span class="st">"incubation"</span>,</span>
<span>    single_epidist <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Discretize incubation period</span></span>
<span><span class="va">influenza_incubation_discrete</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">discretise</span><span class="op">(</span><span class="va">influenza_incubation</span><span class="op">)</span></span>
<span></span>
<span><span class="va">influenza_incubation_max</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">quantile</span><span class="op">(</span><span class="va">influenza_incubation_discrete</span>, p <span class="op">=</span> <span class="fl">0.999</span><span class="op">)</span></span>
<span></span>
<span><span class="va">influenza_incubation_pmf</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">density</span><span class="op">(</span></span>
<span>    <span class="va">influenza_incubation_discrete</span>,</span>
<span>    at <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">influenza_incubation_max</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">influenza_incubation_pmf</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.057491512 0.166877052 0.224430917 0.215076318 0.161045462 0.097466092
[7] 0.048419279 0.019900259 0.006795222</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb52">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># EpiNow2::dist_spec() can also accept the PMF values</span></span>
<span><span class="va">incubation_time_influenza</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">dist_spec</span><span class="op">(</span></span>
<span>    pmf <span class="op">=</span> <span class="va">influenza_incubation_pmf</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># epinow ------------------------------------------------------------------</span></span>
<span></span>
<span><span class="co"># Read data</span></span>
<span><span class="va">influenza_cleaned</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">outbreaks</span><span class="fu">::</span><span class="va">influenza_england_1978_school</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">date</span>, confirm <span class="op">=</span> <span class="va">in_bed</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run epinow()</span></span>
<span><span class="va">epinow_estimates_igi</span> <span class="op">&lt;-</span> <span class="fu">epinow</span><span class="op">(</span></span>
<span>  <span class="co"># cases</span></span>
<span>  reported_cases <span class="op">=</span> <span class="va">influenza_cleaned</span>,</span>
<span>  <span class="co"># delays</span></span>
<span>  generation_time <span class="op">=</span> <span class="fu">generation_time_opts</span><span class="op">(</span><span class="va">generation_time_influenza</span><span class="op">)</span>,</span>
<span>  delays <span class="op">=</span> <span class="fu">delay_opts</span><span class="op">(</span><span class="va">incubation_time_influenza</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">plot</span><span class="op">(</span><span class="va">epinow_estimates_igi</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/delays-functions-rendered-unnamed-chunk-21-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
</section><section id="next-steps"><h2 class="section-heading">Next steps<a class="anchor" aria-label="anchor" href="#next-steps"></a>
</h2>
<hr class="half-width">
<div id="how-to-get-distribution-parameters-from-statistical-distributions" class="callout testimonial">
<div class="callout-square">
<i class="callout-icon" data-feather="heart"></i>
</div>
<div id="how-to-get-distribution-parameters-from-statistical-distributions" class="callout-inner">
<h3 class="callout-title">How to get distribution parameters from
statistical distributions?<a class="anchor" aria-label="anchor" href="#how-to-get-distribution-parameters-from-statistical-distributions"></a>
</h3>
<div class="callout-content">
<p>How to get the mean and standard deviation from a generation time
with <em>only</em> distribution parameters but no summary statistics
like <code>mean</code> or <code>sd</code> for
<code>EpiNow2::dist_spec()</code>?</p>
<p>Look at the <code>{epiparameter}</code> vignette on <a href="https://epiverse-trace.github.io/epiparameter/articles/extract_convert.html" class="external-link">parameter
extraction and conversion</a> and its <a href="https://epiverse-trace.github.io/epiparameter/articles/extract_convert.html#use-cases" class="external-link">use
cases</a>!</p>
</div>
</div>
</div>
<div id="how-to-estimate-delay-distributions-for-disease-x" class="callout testimonial">
<div class="callout-square">
<i class="callout-icon" data-feather="heart"></i>
</div>
<div id="how-to-estimate-delay-distributions-for-disease-x" class="callout-inner">
<h3 class="callout-title">How to estimate delay distributions for
Disease X?<a class="anchor" aria-label="anchor" href="#how-to-estimate-delay-distributions-for-disease-x"></a>
</h3>
<div class="callout-content">
<p>Refer to this excellent tutorial on estimating the serial interval
and incubation period of Disease X accounting for <em>censoring</em>
using Bayesian inference with packages like <a href="https://mc-stan.org/rstan/" class="external-link">rstan</a> and
<a href="https://cran.r-project.org/package=coarseDataTools" class="external-link">coarseDataTools</a>.</p>
<ul>
<li>Tutorial in English: <a href="https://rpubs.com/tracelac/diseaseX" class="external-link uri">https://rpubs.com/tracelac/diseaseX</a>
<!-- to request -->
</li>
<li>Tutorial en Español: <a href="https://epiverse-trace.github.io/epimodelac/EnfermedadX.html" class="external-link uri">https://epiverse-trace.github.io/epimodelac/EnfermedadX.html</a>
</li>
</ul>
<p><strong>Then,</strong> after you get your estimated values, you can
manually create your own<code>&lt;epidist&gt;</code> class objects with
<code>epiparameter::epidist()</code>! Take a look at its <a href="https://epiverse-trace.github.io/epiparameter/reference/epidist.html#ref-examples" class="external-link">reference
guide on “Create an <code>&lt;epidist&gt;</code> object”</a>!</p>
</div>
</div>
</div>
<!--
## Concept map

update it from last epiparameter test 
-->
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Use distribution functions with <code>&lt;epidist&gt;</code> objects
to get summary statistics and informative parameters for public health
interventions like the Window for contact tracing and Length of
quarantine.</li>
<li>Use <code>discretise()</code> to convert continuous to discrete
delay distributions.</li>
<li>Use <code>{epiparameter}</code> to get reporting delays required in
transmissibility estimates.</li>
</ul>
</div>
</div>
</div>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</section></section>
</div>
    </main>
</div>
<!-- END  : inst/pkgdown/templates/content-extra.html -->

      </div>
<!--/div.row-->
      		<footer class="row footer mx-md-3"><hr>
<div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>
        
        <a href="https://github.com/epiverse-trace/tutorials-early/edit/main/README.md" class="external-link">Edit on GitHub</a>
        
	
        | <a href="https://github.com/epiverse-trace/tutorials-early/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/epiverse-trace/tutorials-early/" class="external-link">Source</a></p>
				<p><a href="https://github.com/epiverse-trace/tutorials-early/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:andree.valle-campos@lshtm.ac.uk">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">
        
        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>
        
        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/epiverse-trace/sandpaper/tree/patch-renv-github-bug" class="external-link">sandpaper (0.16.4)</a>, <a href="https://github.com/carpentries/pegboard/tree/a32a7836d4455f407c3cafe8ab95edc636e5e919" class="external-link">pegboard (0.7.5)</a>, and <a href="https://github.com/epiverse-trace/varnish/tree/epiversetheme" class="external-link">varnish (1.0.2)</a></p>
			</div>
		</footer>
</div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://epiverse-trace.github.io/tutorials-early/instructor/aio.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software,data,lesson,The Carpentries",
  "name": "All in One View",
  "creativeWorkStatus": "active",
  "url": "https://epiverse-trace.github.io/tutorials-early/instructor/aio.html",
  "identifier": "https://epiverse-trace.github.io/tutorials-early/instructor/aio.html",
  "dateCreated": "2024-06-17",
  "dateModified": "2024-06-18",
  "datePublished": "2024-06-18"
}

  </script><script>
		feather.replace();
	</script><!-- Matomo
    2022-11-07: we have gotten a notification that we have an overage for our
    tracking and I'm pretty sure this has to do with Workbench usage.
    Considering that I am not _currently_ using this tracking because I do not
    yet know how to access the data, I am turning this off for now.
  <script>
    var _paq = window._paq = window._paq || [];
    /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
    _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
    _paq.push(["setDomains", ["*.preview.carpentries.org","*.datacarpentry.github.io","*.datacarpentry.org","*.librarycarpentry.github.io","*.librarycarpentry.org","*.swcarpentry.github.io", "*.carpentries.github.io"]]);
    _paq.push(["setDoNotTrack", true]);
    _paq.push(["disableCookies"]);
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
          var u="https://carpentries.matomo.cloud/";
          _paq.push(['setTrackerUrl', u+'matomo.php']);
          _paq.push(['setSiteId', '1']);
          var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
          g.async=true; g.src='https://cdn.matomo.cloud/carpentries.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
        })();
  </script>
  End Matomo Code -->
</body>
</html><!-- END:   inst/pkgdown/templates/layout.html-->

