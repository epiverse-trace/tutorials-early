---
title: 'Describe cases'
teaching: 1
exercises: 2
---

:::::::::::::::::::::::::::::::::::::: questions 
- How to convert case data to incidence? 
- How to visualize incidence cases?
- What is the person, place, time distribution of cases?
- What is the growth rate of the epidemic?
<!-- - what are the epidemiological characteristics of the infection? -->

::::::::::::::::::::::::::::::::::::::::::::::::

::::::::::::::::::::::::::::::::::::: objectives
- Convert case data to incidence 
- Create incidence curves
- Estimate the growth rate from incidence curves
- Create quick descriptive and comparison tables

::::::::::::::::::::::::::::::::::::::::::::::::

## Introduction

A comprehensive description of data is pivotal for conducting insightful explanatory and exploratory analyses. In this episode, focuses describing and visualizing epidemic data, with a particular focus on a **Covid-19 case data from England**, which comes with the [outbreaks](http://www.reconverse.org/outbreaks/) package. The initial step involves reading this dataset, and we recommend utilizing the [readr](../links.md#readr) package for this purpose (or employing alternative methods as outlined in the [Read case data](../episodes/read-cases.Rmd)).

```{r, warning=FALSE, message=FALSE}
library("outbreaks")
covid19_eng_case_data <- outbreaks::covid19_england_nhscalls_2020
utils::head(covid19_eng_case_data,5)
```
## Incidence cases

Downstream analysis involves working with aggregated data rather than individual cases. The  [incidence2]((https://www.reconverse.org/incidence2/articles/incidence2.html){.external target="_blank"}) package offers essential functions for grouping case data, usually centered around dated occurrences and/or other factors.  The code chunk provided below demonstrates the creation of an `incidence2` object from the `covid19_eng_case_data` based on the  date of sample.

```{r, message=FALSE, warning=FALSE}
library("incidence2")
library("ggplot2")
covid19_eng_incidence_data <- incidence2::incidence(covid19_eng_case_data, 
                                              date_index = "date")
utils::head(covid19_eng_incidence_data)
```

The `incidence2` object can be visualized using the plot function of base R package. 
```{r, message=FALSE, warning=FALSE}
base::plot(covid19_eng_incidence_data) + labs(x = "Date", y = " Cases")+theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
```

Moreover, `Incidence2` can also aggregate case data based on a dated event and other factors such as  what is the person and place. For example the code chunk groups weekly counts of Covid-19 cases in England based on  `sex` type.

```{r, message=FALSE, warning=FALSE}
weekly_covid19_eng_incidence <- incidence2::incidence(covid19_eng_case_data, date_index = "date", interval = "week", groups = "sex")
base::plot(weekly_covid19_eng_incidence, )+labs(x= "Date", y ="Cases")+ theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
```


::::::::::::::::::::::::::::::::::::: challenge 

- Using the above `covid91_eng_case_data`  dataset, produce monthly epi-curves for Covid-19 cases in England based on  regional places in England?

::::::::::::::::::::::::::::::::::::::::::::::::

<!-- https://gitlab.renkulab.io/the-graph-courses/further-data-analysis-with-r-staging/-/tree/master/ch06_basic_geospatial_viz/lessons -->
#### Analyzing the trend in case data

Aggregated case data over a specific time unit, or incidence data, typically represent the number of cases occurring within that time frame. These data can often be assumed to follow either a Poisson distribution or a negative binomial distribution, depending on the specific characteristics of the data and the underlying processes generating them.

When analyzing such data, one common approach is to examine the trend over time by computing the rate of change, which can indicate whether there is exponential growth or decay in the number of cases. Exponential growth implies that the number of cases is increasing at an accelerating rate over time, while exponential decay suggests that the number of cases is decreasing at a decelerating rate.

Understanding the trend in case data is crucial for various purposes, such as forecasting future case counts, implementing public health interventions, and assessing the effectiveness of control measures. By analyzing the trend, policymakers and public health experts can make informed decisions to mitigate the spread of diseases and protect public health.

The `i2extras` package provides methods for modelling the trend in case. The code chunk below computes the Covid-19 trend in UK within first 3 months using negative binomial distribution. 

```{r, warning=FALSE, message=FALSE}
library("i2extras")
# This line loads the i2extras package, which  provides methods for modeling trends in case data.
df <- base::subset(covid19_eng_case_data, 
                   covid19_eng_case_data$date <= min(covid19_eng_case_data$date)+90)
# This code subset the covid19_eng_case_data to include only the first 3 months of data.
df_incid <- incidence2::incidence(df, date_index = "date", groups = "sex")
#This line uses the incidence function from the incidence2 package to compute the
#incidence data. It groups the data by sex.
out <- i2extras::fit_curve(df_incid, model  = "negbin", alpha = 0.05)
# Here, the fit_curve function from i2extras is used to fit a curve to the incidence data.
# The model chosen is the negative binomial distribution with a significance level (alpha) of 0.05.
base::plot(out, angle = 45)+ ggplot2::labs(x = "Date", y ="Cases")
#This code plots the results using the plot function.
```

## Exponential growth

Within the renewal equation, the generation interval mechanistically links the reproductive number R to observables such as the epidemic growth rate r or the number of new infections per day [(Wallinga et al. 2006)](https://royalsocietypublishing.org/doi/10.1098/rspb.2006.3754)

::::::::::::::::::::::::::::::::::::: keypoints 

- Use `{incidence2}` to aggregate case data based on a date event.  
- Use `{i2extras}` to calculate exponential growth or decline of cases.
- Use `{compareGroups}`

::::::::::::::::::::::::::::::::::::::::::::::::

